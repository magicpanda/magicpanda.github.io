import{$ as e,A as t,At as n,B as r,D as i,E as a,Et as o,F as s,H as c,J as l,K as u,Ot as d,Q as f,R as p,S as m,St as h,U as g,V as ee,W as te,Z as ne,_ as re,_t as ie,b as ae,bt as oe,c as se,dt as _,et as ce,ft as v,g as le,gt as ue,h as de,ht as fe,it as pe,kt as me,l as he,mt as ge,n as _e,nt as ve,o as ye,p as be,pt as xe,rt as Se,t as Ce,vt as we,y as Te,yt as Ee,z as De}from"./index-Cx_W_gHZ.js";function Oe(e){let t=xe();t&&c(t.proxy,e)}var[ke,Ae]=le(`loading`),je=Array(12).fill(null).map((e,t)=>_(`i`,{class:Ae(`line`,String(t+1))},null)),Me=_(`svg`,{class:Ae(`circular`),viewBox:`25 25 50 50`},[_(`circle`,{cx:`50`,cy:`50`,r:`20`,fill:`none`},null)]),Ne=se(v({name:ke,props:{size:De,type:p(`circular`),color:String,vertical:Boolean,textSize:De,textColor:String},setup(e,{slots:t}){let n=pe(()=>c({color:e.color},Te(e.size))),r=()=>{let r=e.type===`spinner`?je:Me;return _(`span`,{class:Ae(`spinner`,e.type),style:n.value},[t.icon?t.icon():r])},i=()=>{if(t.default)return _(`span`,{class:Ae(`text`),style:{fontSize:re(e.textSize),color:e.textColor??e.color}},[t.default()])};return()=>{let{type:t,vertical:n}=e;return _(`div`,{class:Ae([t,{vertical:n}]),"aria-live":`polite`,"aria-busy":!0},[r(),i()])}}})),Pe={show:Boolean,zIndex:De,overlay:r,duration:De,teleport:[String,Object],lockScroll:r,lazyRender:r,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:null,transitionAppear:Boolean,closeOnClickOverlay:r},Fe=Object.keys(Pe);function Ie(e,t){return e>t?`horizontal`:t>e?`vertical`:``}function y(){let e=n(0),t=n(0),r=n(0),i=n(0),a=n(0),o=n(0),s=n(``),c=n(!0),l=()=>s.value===`vertical`,u=()=>s.value===`horizontal`,d=()=>{r.value=0,i.value=0,a.value=0,o.value=0,s.value=``,c.value=!0};return{move:(n=>{let l=n.touches[0];r.value=(l.clientX<0?0:l.clientX)-e.value,i.value=l.clientY-t.value,a.value=Math.abs(r.value),o.value=Math.abs(i.value),(!s.value||a.value<10&&o.value<10)&&(s.value=Ie(a.value,o.value)),c.value&&(a.value>5||o.value>5)&&(c.value=!1)}),start:(n=>{d(),e.value=n.touches[0].clientX,t.value=n.touches[0].clientY}),reset:d,startX:e,startY:t,deltaX:r,deltaY:i,offsetX:a,offsetY:o,direction:s,isVertical:l,isHorizontal:u,isTap:c}}var b=0,Le=`van-overflow-hidden`;function Re(e,t){let n=y(),r=t=>{n.move(t);let r=n.deltaY.value>0?`10`:`01`,{scrollHeight:i,offsetHeight:o,scrollTop:s}=a(t.target,e.value),c=`11`;s===0?c=o>=i?`00`:`01`:s+o>=i&&(c=`10`),c!==`11`&&n.isVertical()&&!(parseInt(c,2)&parseInt(r,2))&&m(t,!0)},s=()=>{document.addEventListener(`touchstart`,n.start),document.addEventListener(`touchmove`,r,{passive:!1}),b||document.body.classList.add(Le),b++},c=()=>{b&&(document.removeEventListener(`touchstart`,n.start),document.removeEventListener(`touchmove`,r),b--,b||document.body.classList.remove(Le))},l=()=>t()&&s(),u=()=>t()&&c();i(l),we(u),ie(u),o(t,e=>{e?s():c()})}function ze(e){let t=n(!1);return o(e,e=>{e&&(t.value=e)},{immediate:!0}),e=>()=>t.value?e():null}var Be=()=>{let{scopeId:e}=xe()?.vnode||{};return e?{[e]:``}:null},[Ve,He]=le(`overlay`),Ue=se(v({name:Ve,inheritAttrs:!1,props:{show:Boolean,zIndex:De,duration:De,className:null,lockScroll:r,lazyRender:r,customStyle:Object,teleport:[String,Object]},setup(e,{attrs:r,slots:i}){let a=n(),o=ze(()=>e.show||!e.lazyRender),s=t=>{e.lockScroll&&m(t,!0)},l=o(()=>{let t=c(ae(e.zIndex),e.customStyle);return te(e.duration)&&(t.animationDuration=`${e.duration}s`),d(_(`div`,ge({ref:a,style:t,class:[He(),e.className]},r),[i.default?.call(i)]),[[ce,e.show]])});return t(`touchmove`,s,{target:a}),()=>{let t=_(f,{name:`van-fade`,appear:!0},{default:l});return e.teleport?_(Se,{to:e.teleport},{default:()=>[t]}):t}}})),We=c({},Pe,{round:Boolean,position:p(`center`),closeIcon:p(`cross`),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:p(`top-right`),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Ge,Ke]=le(`popup`),qe=se(v({name:Ge,inheritAttrs:!1,props:We,emits:[`open`,`close`,`opened`,`closed`,`keydown`,`update:show`,`clickOverlay`,`clickCloseIcon`],setup(e,{emit:r,attrs:i,slots:a}){let s,l,u=n(),p=n(),m=ze(()=>e.show||!e.lazyRender),g=pe(()=>{let t={zIndex:u.value};if(te(e.duration)){let n=e.position===`center`?`animationDuration`:`transitionDuration`;t[n]=`${e.duration}s`}return t}),ee=()=>{s||(s=!0,u.value=e.zIndex===void 0?_e():+e.zIndex,r(`open`))},ne=()=>{s&&he(e.beforeClose,{done(){s=!1,r(`close`),r(`update:show`,!1)}})},re=t=>{r(`clickOverlay`,t),e.closeOnClickOverlay&&ne()},ie=()=>{if(e.overlay)return _(Ue,ge(c({show:e.show,class:e.overlayClass,zIndex:u.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?`button`:void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps),Be(),{onClick:re}),{default:a[`overlay-content`]})},ae=e=>{r(`clickCloseIcon`,e),ne()},oe=()=>{if(e.closeable)return _(Ce,{role:`button`,tabindex:0,name:e.closeIcon,class:[Ke(`close-icon`,e.closeIconPosition),be],classPrefix:e.iconPrefix,onClick:ae},null)},se,v=()=>{se&&clearTimeout(se),se=setTimeout(()=>{r(`opened`)})},le=()=>r(`closed`),de=e=>r(`keydown`,e),me=m(()=>{let{destroyOnClose:t,round:n,position:r,safeAreaInsetTop:o,safeAreaInsetBottom:s,show:c}=e;if(!(!c&&t))return d(_(`div`,ge({ref:p,style:g.value,role:`dialog`,tabindex:0,class:[Ke({round:n,[r]:r}),{"van-safe-area-top":o,"van-safe-area-bottom":s}],onKeydown:de},i,Be()),[a.default?.call(a),oe()]),[[ce,c]])}),xe=()=>{let{position:t,transition:n,transitionAppear:r}=e,i=t===`center`?`van-fade`:`van-popup-slide-${t}`;return _(f,{name:n||i,appear:r,onAfterEnter:v,onAfterLeave:le},{default:me})};return o(()=>e.show,e=>{e&&!s&&(ee(),i.tabindex===0&&fe(()=>{var e;(e=p.value)==null||e.focus()})),!e&&s&&(s=!1,r(`close`))}),Oe({popupRef:p}),Re(p,()=>e.show&&e.lockScroll),t(`popstate`,()=>{e.closeOnPopstate&&(ne(),l=!1)}),Ee(()=>{e.show&&ee()}),ue(()=>{l&&=(r(`update:show`,!0),!1)}),we(()=>{e.show&&e.teleport&&(ne(),l=!0)}),h(ye,()=>e.show),()=>e.teleport?_(Se,{to:e.teleport},{default:()=>[ie(),xe()]}):_(ve,null,[ie(),xe()])}})),Je=0;function Ye(e){e?(Je||document.body.classList.add(`van-toast--unclickable`),Je++):Je&&(Je--,Je||document.body.classList.remove(`van-toast--unclickable`))}var[Xe,Ze]=le(`toast`),Qe=[`show`,`overlay`,`teleport`,`transition`,`overlayClass`,`overlayStyle`,`closeOnClickOverlay`,`zIndex`],$e=v({name:Xe,props:{icon:String,show:Boolean,type:p(`text`),overlay:Boolean,message:De,iconSize:De,duration:s(2e3),position:p(`middle`),teleport:[String,Object],wordBreak:String,className:null,iconPrefix:String,transition:p(`van-fade`),loadingType:String,forbidClick:Boolean,overlayClass:null,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:De},emits:[`update:show`],setup(e,{emit:t,slots:n}){let r,i=!1,a=()=>{let t=e.show&&e.forbidClick;i!==t&&(i=t,Ye(i))},s=e=>t(`update:show`,e),c=()=>{e.closeOnClick&&s(!1)},u=()=>clearTimeout(r),d=()=>{let{icon:t,type:n,iconSize:r,iconPrefix:i,loadingType:a}=e;if(t||n===`success`||n===`fail`)return _(Ce,{name:t||n,size:r,class:Ze(`icon`),classPrefix:i},null);if(n===`loading`)return _(Ne,{class:Ze(`loading`),size:r,type:a},null)},f=()=>{let{type:t,message:r}=e;if(n.message)return _(`div`,{class:Ze(`text`)},[n.message()]);if(te(r)&&r!==``)return t===`html`?_(`div`,{key:0,class:Ze(`text`),innerHTML:String(r)},null):_(`div`,{class:Ze(`text`)},[r])};return o(()=>[e.show,e.forbidClick],a),o(()=>[e.show,e.type,e.message,e.duration],()=>{u(),e.show&&e.duration>0&&(r=setTimeout(()=>{s(!1)},e.duration))}),Ee(a),oe(a),()=>_(qe,ge({class:[Ze([e.position,e.wordBreak===`normal`?`break-normal`:e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:c,onClosed:u,"onUpdate:show":s},l(e,Qe)),{default:()=>[d(),f()]})}});function et(){let e=me({show:!1}),t=t=>{e.show=t},n=n=>{c(e,n,{transitionAppear:!0}),t(!0)},r=()=>t(!1);return Oe({open:n,close:r,toggle:t}),{open:n,close:r,state:e,toggle:t}}function tt(t){let n=e(t),r=document.createElement(`div`);return document.body.appendChild(r),{instance:n.mount(r),unmount(){n.unmount(),document.body.removeChild(r)}}}var nt={icon:``,type:`text`,message:``,className:``,overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:`body`,iconSize:void 0,iconPrefix:void 0,position:`middle`,transition:`van-fade`,forbidClick:!1,loadingType:void 0,overlayClass:``,overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1},rt=[],x=!1,it=c({},nt),at=new Map;function ot(e){return u(e)?e:{message:e}}function st(){let{instance:e,unmount:t}=tt({setup(){let r=n(``),{open:i,state:a,close:s,toggle:c}=et(),l=()=>{x&&(rt=rt.filter(t=>t!==e),t())},u=()=>_($e,ge(a,{onClosed:l,"onUpdate:show":c}),null);return o(r,e=>{a.message=e}),xe().render=u,{open:i,close:s,message:r}}});return e}function ct(){if(!rt.length||x){let e=st();rt.push(e)}return rt[rt.length-1]}function lt(e={}){if(!g)return{};let t=ct(),n=ot(e);return t.open(c({},it,at.get(n.type||it.type),n)),t}var ut=e=>t=>lt(c({type:e},ot(t))),dt=ut(`success`),ft=ut(`fail`),pt=()=>void 0,mt=function(e){let t=[],n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)==55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)==56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},ht=function(e){let t=[],n=0,r=0;for(;n<e.length;){let i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){let a=e[n++];t[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){let a=e[n++],o=e[n++],s=e[n++],c=((i&7)<<18|(a&63)<<12|(o&63)<<6|s&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{let a=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return t.join(``)},gt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789`,get ENCODED_VALS(){return this.ENCODED_VALS_BASE+`+/=`},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+`-_.`},HAS_NATIVE_SUPPORT:typeof atob==`function`,encodeByteArray(e,t){if(!Array.isArray(e))throw Error(`encodeByteArray takes an array as a parameter`);this.init_();let n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){let i=e[t],a=t+1<e.length,o=a?e[t+1]:0,s=t+2<e.length,c=s?e[t+2]:0,l=i>>2,u=(i&3)<<4|o>>4,d=(o&15)<<2|c>>6,f=c&63;s||(f=64,a||(d=64)),r.push(n[l],n[u],n[d],n[f])}return r.join(``)},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(mt(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):ht(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){let i=n[e.charAt(t++)],a=t<e.length?n[e.charAt(t)]:0;++t;let o=t<e.length?n[e.charAt(t)]:64;++t;let s=t<e.length?n[e.charAt(t)]:64;if(++t,i==null||a==null||o==null||s==null)throw new _t;let c=i<<2|a>>4;if(r.push(c),o!==64){let e=a<<4&240|o>>2;if(r.push(e),s!==64){let e=o<<6&192|s;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},_t=class extends Error{constructor(){super(...arguments),this.name=`DecodeBase64StringError`}},vt=function(e){let t=mt(e);return gt.encodeByteArray(t,!0)},yt=function(e){return vt(e).replace(/\./g,``)},bt=function(e){try{return gt.decodeString(e,!0)}catch(e){console.error(`base64Decode failed: `,e)}return null};function xt(){if(typeof self<`u`)return self;if(typeof window<`u`)return window;if(typeof global<`u`)return global;throw Error(`Unable to locate global object.`)}var St=()=>xt().__FIREBASE_DEFAULTS__,Ct=()=>{if(typeof process>`u`)return;let e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},wt=()=>{if(typeof document>`u`)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let t=e&&bt(e[1]);return t&&JSON.parse(t)},Tt=()=>{try{return pt()||St()||Ct()||wt()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Et=e=>Tt()?.emulatorHosts?.[e],Dt=e=>{let t=Et(e);if(!t)return;let n=t.lastIndexOf(`:`);if(n<=0||n+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let r=parseInt(t.substring(n+1),10);return t[0]===`[`?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Ot=()=>Tt()?.config,kt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e==`function`&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}};function At(e){try{return(e.startsWith(`http://`)||e.startsWith(`https://`)?new URL(e).hostname:e).endsWith(`.cloudworkstations.dev`)}catch{return!1}}async function jt(e){return(await fetch(e,{credentials:`include`})).ok}function Mt(e,t){if(e.uid)throw Error(`The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.`);let n={alg:`none`,type:`JWT`},r=t||`demo-project`,i=e.iat||0,a=e.sub||e.user_id;if(!a)throw Error(`mockUserToken must contain 'sub' or 'user_id' field!`);let o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:`custom`,identities:{}},...e};return[yt(JSON.stringify(n)),yt(JSON.stringify(o)),``].join(`.`)}var Nt={};function Pt(){let e={prod:[],emulator:[]};for(let t of Object.keys(Nt))Nt[t]?e.emulator.push(t):e.prod.push(t);return e}function Ft(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement(`div`),t.setAttribute(`id`,e),n=!0),{created:n,element:t}}var It=!1;function Lt(e,t){if(typeof window>`u`||typeof document>`u`||!At(window.location.host)||Nt[e]===t||Nt[e]||It)return;Nt[e]=t;function n(e){return`__firebase__banner__${e}`}let r=`__firebase__banner`,i=Pt().prod.length>0;function a(){let e=document.getElementById(r);e&&e.remove()}function o(e){e.style.display=`flex`,e.style.background=`#7faaf0`,e.style.position=`fixed`,e.style.bottom=`5px`,e.style.left=`5px`,e.style.padding=`.5em`,e.style.borderRadius=`5px`,e.style.alignItems=`center`}function s(e,t){e.setAttribute(`width`,`24`),e.setAttribute(`id`,t),e.setAttribute(`height`,`24`),e.setAttribute(`viewBox`,`0 0 24 24`),e.setAttribute(`fill`,`none`),e.style.marginLeft=`-6px`}function c(){let e=document.createElement(`span`);return e.style.cursor=`pointer`,e.style.marginLeft=`16px`,e.style.fontSize=`24px`,e.innerHTML=` &times;`,e.onclick=()=>{It=!0,a()},e}function l(e,t){e.setAttribute(`id`,t),e.innerText=`Learn more`,e.href=`https://firebase.google.com/docs/studio/preview-apps#preview-backend`,e.setAttribute(`target`,`__blank`),e.style.paddingLeft=`5px`,e.style.textDecoration=`underline`}function u(){let e=Ft(r),t=n(`text`),a=document.getElementById(t)||document.createElement(`span`),u=n(`learnmore`),d=document.getElementById(u)||document.createElement(`a`),f=n(`preprendIcon`),p=document.getElementById(f)||document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);if(e.created){let t=e.element;o(t),l(d,u);let n=c();s(p,f),t.append(p,a,d,n),document.body.appendChild(t)}i?(a.innerText=`Preview backend disconnected.`,p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,a.innerText=`Preview backend running in this workspace.`),a.setAttribute(`id`,t)}document.readyState===`loading`?window.addEventListener(`DOMContentLoaded`,u):u()}function Rt(){return typeof navigator<`u`&&typeof navigator.userAgent==`string`?navigator.userAgent:``}function zt(){let e=Tt()?.forceEnvironment;if(e===`node`)return!0;if(e===`browser`)return!1;try{return Object.prototype.toString.call(global.process)===`[object process]`}catch{return!1}}function Bt(){return!zt()&&!!navigator.userAgent&&navigator.userAgent.includes(`Safari`)&&!navigator.userAgent.includes(`Chrome`)}function Vt(){try{return typeof indexedDB==`object`}catch{return!1}}function Ht(){return new Promise((e,t)=>{try{let n=!0,r=`validate-browser-context-for-indexeddb-analytics-module`,i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{t(i.error?.message||``)}}catch(e){t(e)}})}var Ut=`FirebaseError`,S=class e extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=Ut,Object.setPrototypeOf(this,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wt.prototype.create)}},Wt=class{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){let n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],a=i?Gt(i,n):`Error`;return new S(r,`${this.serviceName}: ${a} (${r}).`,n)}};function Gt(e,t){return e.replace(Kt,(e,n)=>{let r=t[n];return r==null?`<${n}?>`:String(r)})}var Kt=/\{\$([^}]+)}/g;function C(e,t){if(e===t)return!0;let n=Object.keys(e),r=Object.keys(t);for(let i of n){if(!r.includes(i))return!1;let n=e[i],a=t[i];if(qt(n)&&qt(a)){if(!C(n,a))return!1}else if(n!==a)return!1}for(let e of r)if(!n.includes(e))return!1;return!0}function qt(e){return typeof e==`object`&&!!e}function w(e){return e&&e._delegate?e._delegate:e}var Jt=class{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode=`LAZY`,this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}},Yt=`[DEFAULT]`,Xt=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new kt;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(n)return null;throw e}else if(n)return null;else throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(Qt(e))try{this.getOrInitializeService({instanceIdentifier:Yt})}catch{}for(let[e,t]of this.instancesDeferred.entries()){let n=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch{}}}}clearInstance(e=Yt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>`INTERNAL`in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>`_delete`in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yt){return this.instances.has(e)}getOptions(e=Yt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(let[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){let n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);let i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let n=this.onInitCallbacks.get(t);if(n)for(let r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Zt(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Yt){return this.component?this.component.multipleInstances?e:Yt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!==`EXPLICIT`}};function Zt(e){return e===Yt?void 0:e}function Qt(e){return e.instantiationMode===`EAGER`}var $t=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Xt(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}},en=[],T;(function(e){e[e.DEBUG=0]=`DEBUG`,e[e.VERBOSE=1]=`VERBOSE`,e[e.INFO=2]=`INFO`,e[e.WARN=3]=`WARN`,e[e.ERROR=4]=`ERROR`,e[e.SILENT=5]=`SILENT`})(T||={});var tn={debug:T.DEBUG,verbose:T.VERBOSE,info:T.INFO,warn:T.WARN,error:T.ERROR,silent:T.SILENT},nn=T.INFO,rn={[T.DEBUG]:`log`,[T.VERBOSE]:`log`,[T.INFO]:`info`,[T.WARN]:`warn`,[T.ERROR]:`error`},an=(e,t,...n)=>{if(t<e.logLevel)return;let r=new Date().toISOString(),i=rn[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)},on=class{constructor(e){this.name=e,this._logLevel=nn,this._logHandler=an,this._userLogHandler=null,en.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in T))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e==`string`?tn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!=`function`)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,T.DEBUG,...e),this._logHandler(this,T.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,T.VERBOSE,...e),this._logHandler(this,T.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,T.INFO,...e),this._logHandler(this,T.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,T.WARN,...e),this._logHandler(this,T.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,T.ERROR,...e),this._logHandler(this,T.ERROR,...e)}},sn=(e,t)=>t.some(t=>e instanceof t),cn,ln;function un(){return cn||=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]}function dn(){return ln||=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]}var fn=new WeakMap,pn=new WeakMap,mn=new WeakMap,hn=new WeakMap,gn=new WeakMap;function _n(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener(`success`,i),e.removeEventListener(`error`,a)},i=()=>{t(Sn(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener(`success`,i),e.addEventListener(`error`,a)});return t.then(t=>{t instanceof IDBCursor&&fn.set(t,e)}).catch(()=>{}),gn.set(t,e),t}function vn(e){if(pn.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener(`complete`,i),e.removeEventListener(`error`,a),e.removeEventListener(`abort`,a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException(`AbortError`,`AbortError`)),r()};e.addEventListener(`complete`,i),e.addEventListener(`error`,a),e.addEventListener(`abort`,a)});pn.set(e,t)}var yn={get(e,t,n){if(e instanceof IDBTransaction){if(t===`done`)return pn.get(e);if(t===`objectStoreNames`)return e.objectStoreNames||mn.get(e);if(t===`store`)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Sn(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t===`done`||t===`store`)?!0:t in e}};function bn(e){yn=e(yn)}function E(e){return e===IDBDatabase.prototype.transaction&&!(`objectStoreNames`in IDBTransaction.prototype)?function(t,...n){let r=e.call(Cn(this),t,...n);return mn.set(r,t.sort?t.sort():[t]),Sn(r)}:dn().includes(e)?function(...t){return e.apply(Cn(this),t),Sn(fn.get(this))}:function(...t){return Sn(e.apply(Cn(this),t))}}function xn(e){return typeof e==`function`?E(e):(e instanceof IDBTransaction&&vn(e),sn(e,un())?new Proxy(e,yn):e)}function Sn(e){if(e instanceof IDBRequest)return _n(e);if(hn.has(e))return hn.get(e);let t=xn(e);return t!==e&&(hn.set(e,t),gn.set(t,e)),t}var Cn=e=>gn.get(e);function wn(e,t,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){let o=indexedDB.open(e,t),s=Sn(o);return r&&o.addEventListener(`upgradeneeded`,e=>{r(Sn(o.result),e.oldVersion,e.newVersion,Sn(o.transaction),e)}),n&&o.addEventListener(`blocked`,e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{a&&e.addEventListener(`close`,()=>a()),i&&e.addEventListener(`versionchange`,e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}var Tn=[`get`,`getKey`,`getAll`,`getAllKeys`,`count`],En=[`put`,`add`,`delete`,`clear`],Dn=new Map;function On(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t==`string`))return;if(Dn.get(t))return Dn.get(t);let n=t.replace(/FromIndex$/,``),r=t!==n,i=En.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Tn.includes(n)))return;let a=async function(e,...t){let a=this.transaction(e,i?`readwrite`:`readonly`),o=a.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&a.done]))[0]};return Dn.set(t,a),a}bn(e=>({...e,get:(t,n,r)=>On(t,n)||e.get(t,n,r),has:(t,n)=>!!On(t,n)||e.has(t,n)}));var kn=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(An(e)){let t=e.getImmediate();return`${t.library}/${t.version}`}else return null}).filter(e=>e).join(` `)}};function An(e){return e.getComponent()?.type===`VERSION`}var jn=`@firebase/app`,Mn=`0.14.6`,D=new on(`@firebase/app`),Nn=`@firebase/app-compat`,Pn=`@firebase/analytics-compat`,Fn=`@firebase/analytics`,In=`@firebase/app-check-compat`,Ln=`@firebase/app-check`,Rn=`@firebase/auth`,zn=`@firebase/auth-compat`,Bn=`@firebase/database`,Vn=`@firebase/data-connect`,Hn=`@firebase/database-compat`,Un=`@firebase/functions`,Wn=`@firebase/functions-compat`,Gn=`@firebase/installations`,Kn=`@firebase/installations-compat`,qn=`@firebase/messaging`,Jn=`@firebase/messaging-compat`,Yn=`@firebase/performance`,Xn=`@firebase/performance-compat`,Zn=`@firebase/remote-config`,O=`@firebase/remote-config-compat`,Qn=`@firebase/storage`,$n=`@firebase/storage-compat`,er=`@firebase/firestore`,tr=`@firebase/ai`,nr=`@firebase/firestore-compat`,rr=`firebase`,ir=`12.6.0`,ar=`[DEFAULT]`,or={[jn]:`fire-core`,[Nn]:`fire-core-compat`,[Fn]:`fire-analytics`,[Pn]:`fire-analytics-compat`,[Ln]:`fire-app-check`,[In]:`fire-app-check-compat`,[Rn]:`fire-auth`,[zn]:`fire-auth-compat`,[Bn]:`fire-rtdb`,[Vn]:`fire-data-connect`,[Hn]:`fire-rtdb-compat`,[Un]:`fire-fn`,[Wn]:`fire-fn-compat`,[Gn]:`fire-iid`,[Kn]:`fire-iid-compat`,[qn]:`fire-fcm`,[Jn]:`fire-fcm-compat`,[Yn]:`fire-perf`,[Xn]:`fire-perf-compat`,[Zn]:`fire-rc`,[O]:`fire-rc-compat`,[Qn]:`fire-gcs`,[$n]:`fire-gcs-compat`,[er]:`fire-fst`,[nr]:`fire-fst-compat`,[tr]:`fire-vertex`,"fire-js":`fire-js`,[rr]:`fire-js-all`},sr=new Map,cr=new Map,lr=new Map;function ur(e,t){try{e.container.addComponent(t)}catch(n){D.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function dr(e){let t=e.name;if(lr.has(t))return D.debug(`There were multiple attempts to register component ${t}.`),!1;lr.set(t,e);for(let t of sr.values())ur(t,e);for(let t of cr.values())ur(t,e);return!0}function fr(e,t){let n=e.container.getProvider(`heartbeat`).getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function pr(e){return e==null?!1:e.settings!==void 0}var mr=new Wt(`app`,`Firebase`,{"no-app":`No Firebase App '{$appName}' has been created - call initializeApp() first`,"bad-app-name":`Illegal App name: '{$appName}'`,"duplicate-app":`Firebase App named '{$appName}' already exists with different options or config`,"app-deleted":`Firebase App named '{$appName}' already deleted`,"server-app-deleted":`Firebase Server App has been deleted`,"no-options":`Need to provide options, when not being deployed to hosting via source.`,"invalid-app-argument":`firebase.{$appName}() takes either no argument or a Firebase App instance.`,"invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":`Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.`,"idb-get":`Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.`,"idb-set":`Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.`,"idb-delete":`Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.`,"finalization-registry-not-supported":`FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.`,"invalid-server-app-environment":`FirebaseServerApp is not for use in browser environments.`}),hr=class{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Jt(`app`,()=>this,`PUBLIC`))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw mr.create(`app-deleted`,{appName:this._name})}},gr=ir;function _r(e,t={}){let n=e;typeof t!=`object`&&(t={name:t});let r={name:ar,automaticDataCollectionEnabled:!0,...t},i=r.name;if(typeof i!=`string`||!i)throw mr.create(`bad-app-name`,{appName:String(i)});if(n||=Ot(),!n)throw mr.create(`no-options`);let a=sr.get(i);if(a){if(C(n,a.options)&&C(r,a.config))return a;throw mr.create(`duplicate-app`,{appName:i})}let o=new $t(i);for(let e of lr.values())o.addComponent(e);let s=new hr(n,r,o);return sr.set(i,s),s}function vr(e=ar){let t=sr.get(e);if(!t&&e===`[DEFAULT]`&&Ot())return _r();if(!t)throw mr.create(`no-app`,{appName:e});return t}function yr(e,t,n){let r=or[e]??e;n&&(r+=`-${n}`);let i=r.match(/\s|\//),a=t.match(/\s|\//);if(i||a){let e=[`Unable to register library "${r}" with version "${t}":`];i&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&e.push(`and`),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),D.warn(e.join(` `));return}dr(new Jt(`${r}-version`,()=>({library:r,version:t}),`VERSION`))}var br=`firebase-heartbeat-database`,xr=1,Sr=`firebase-heartbeat-store`,Cr=null;function wr(){return Cr||=wn(br,xr,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Sr)}catch(e){console.warn(e)}}}}).catch(e=>{throw mr.create(`idb-open`,{originalErrorMessage:e.message})}),Cr}async function Tr(e){try{let t=(await wr()).transaction(Sr),n=await t.objectStore(Sr).get(Dr(e));return await t.done,n}catch(e){if(e instanceof S)D.warn(e.message);else{let t=mr.create(`idb-get`,{originalErrorMessage:e?.message});D.warn(t.message)}}}async function Er(e,t){try{let n=(await wr()).transaction(Sr,`readwrite`);await n.objectStore(Sr).put(t,Dr(e)),await n.done}catch(e){if(e instanceof S)D.warn(e.message);else{let t=mr.create(`idb-set`,{originalErrorMessage:e?.message});D.warn(t.message)}}}function Dr(e){return`${e.name}!${e.options.appId}`}var Or=1024,kr=30,Ar=class{constructor(e){this.container=e,this._heartbeatsCache=null,this._storage=new Nr(this.container.getProvider(`app`).getImmediate()),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider(`platform-logger`).getImmediate().getPlatformInfoString(),t=jr();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>kr){let e=Fr(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){D.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return``;let e=jr(),{heartbeatsToSend:t,unsentEntries:n}=Mr(this._heartbeatsCache.heartbeats),r=yt(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return D.warn(e),``}}};function jr(){return new Date().toISOString().substring(0,10)}function Mr(e,t=Or){let n=[],r=e.slice();for(let i of e){let e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Pr(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Pr(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var Nr=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Vt()?Ht().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let e=await Tr(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return Er(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return Er(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}else return}};function Pr(e){return yt(JSON.stringify({version:2,heartbeats:e})).length}function Fr(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}function Ir(e){dr(new Jt(`platform-logger`,e=>new kn(e),`PRIVATE`)),dr(new Jt(`heartbeat`,e=>new Ar(e),`PRIVATE`)),yr(jn,Mn,e),yr(jn,Mn,`esm2020`),yr(`fire-js`,``)}Ir(``);var Lr=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},Rr={},zr,Br;(function(){var e;function t(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(e,t,n){n||=0;let r=Array(16);if(typeof t==`string`)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let a=e.g[3],o;o=t+(a^n&(i^a))+r[0]+3614090360&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[1]+3905402710&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[2]+606105819&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[4]+4118548399&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[5]+1200080426&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[6]+2821735955&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[8]+1770035416&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[9]+2336552879&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[10]+4294925233&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[12]+1804603682&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[13]+4254626195&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[14]+2792965006&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(i^a&(n^i))+r[1]+4129170786&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[6]+3225465664&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[11]+643717713&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[5]+3593408605&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[10]+38016083&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[15]+3634488961&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[9]+568446438&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[14]+3275163606&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[3]+4107603335&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[13]+2850285829&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[2]+4243563512&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[7]+1735328473&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(n^i^a)+r[5]+4294588738&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[8]+2272392833&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[11]+1839030562&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[1]+2763975236&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[4]+1272893353&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[7]+4139469664&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[13]+681279174&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[0]+3936430074&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[3]+3572445317&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[9]+3654602809&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[12]+3873151461&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[15]+530742520&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(i^(n|~a))+r[0]+4096336452&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[7]+1126891415&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[14]+2878612391&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[12]+1700485571&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[3]+2399980690&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[10]+4293915773&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[8]+1873313359&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[15]+4264355552&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[6]+2734768916&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[4]+4149444226&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[11]+3174756917&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[2]+718787259&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}r.prototype.v=function(e,t){t===void 0&&(t=e.length);let n=t-this.blockSize,r=this.C,a=this.h,o=0;for(;o<t;){if(a==0)for(;o<=n;)i(this,e,o),o+=this.blockSize;if(typeof e==`string`){for(;o<t;)if(r[a++]=e.charCodeAt(o++),a==this.blockSize){i(this,r),a=0;break}}else for(;o<t;)if(r[a++]=e[o++],a==this.blockSize){i(this,r),a=0;break}}this.h=a,this.o+=t},r.prototype.A=function(){var e=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=this.o*8;for(var n=e.length-8;n<e.length;++n)e[n]=t&255,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};function a(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}function o(e,t){this.h=t;let n=[],r=!0;for(let i=e.length-1;i>=0;i--){let a=e[i]|0;r&&a==t||(n[i]=a,r=!1)}this.g=n}var s={};function c(e){return-128<=e&&e<128?a(e,function(e){return new o([e|0],e<0?-1:0)}):new o([e|0],e<0?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return d;if(e<0)return g(l(-e));let t=[],n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new o(t,0)}function u(e,t){if(e.length==0)throw Error(`number format error: empty string`);if(t||=10,t<2||36<t)throw Error(`radix out of range: `+t);if(e.charAt(0)==`-`)return g(u(e.substring(1),t));if(e.indexOf(`-`)>=0)throw Error(`number format error: interior "-" character`);let n=l(t**8),r=d;for(let a=0;a<e.length;a+=8){var i=Math.min(8,e.length-a);let o=parseInt(e.substring(a,a+i),t);i<8?(i=l(t**+i),r=r.j(i).add(l(o))):(r=r.j(n),r=r.add(l(o)))}return r}var d=c(0),f=c(1),p=c(16777216);e=o.prototype,e.m=function(){if(h(this))return-g(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){let r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(e||=10,e<2||36<e)throw Error(`radix out of range: `+e);if(m(this))return`0`;if(h(this))return`-`+g(this).toString(e);let t=l(e**6);var n=this;let r=``;for(;;){let i=re(n,t).g;n=ee(n,i.j(t));let a=((n.g.length>0?n.g[0]:n.h)>>>0).toString(e);if(n=i,m(n))return a+r;for(;a.length<6;)a=`0`+a;r=a+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h};function m(e){if(e.h!=0)return!1;for(let t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function h(e){return e.h==-1}e.l=function(e){return e=ee(this,e),h(e)?-1:m(e)?0:1};function g(e){let t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new o(n,~e.h).add(f)}e.abs=function(){return h(this)?g(this):this},e.add=function(e){let t=Math.max(this.g.length,e.g.length),n=[],r=0;for(let i=0;i<=t;i++){let t=r+(this.i(i)&65535)+(e.i(i)&65535),a=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=a>>>16,t&=65535,a&=65535,n[i]=a<<16|t}return new o(n,n[n.length-1]&-2147483648?-1:0)};function ee(e,t){return e.add(g(t))}e.j=function(e){if(m(this)||m(e))return d;if(h(this))return h(e)?g(this).j(g(e)):g(g(this).j(e));if(h(e))return g(this.j(g(e)));if(this.l(p)<0&&e.l(p)<0)return l(this.m()*e.m());let t=this.g.length+e.g.length,n=[];for(var r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(let t=0;t<e.g.length;t++){let i=this.i(r)>>>16,a=this.i(r)&65535,o=e.i(t)>>>16,s=e.i(t)&65535;n[2*r+2*t]+=a*s,te(n,2*r+2*t),n[2*r+2*t+1]+=i*s,te(n,2*r+2*t+1),n[2*r+2*t+1]+=a*o,te(n,2*r+2*t+1),n[2*r+2*t+2]+=i*o,te(n,2*r+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new o(n,0)};function te(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function ne(e,t){this.g=e,this.h=t}function re(e,t){if(m(t))throw Error(`division by zero`);if(m(e))return new ne(d,d);if(h(e))return t=re(g(e),t),new ne(g(t.g),g(t.h));if(h(t))return t=re(e,g(t)),new ne(g(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error(`slowDivide_ only works with positive integers.`);for(var n=f,r=t;r.l(e)<=0;)n=ie(n),r=ie(r);var i=ae(n,1),a=ae(r,1);for(r=ae(r,2),n=ae(n,2);!m(r);){var o=a.add(r);o.l(e)<=0&&(i=i.add(n),a=o),r=ae(r,1),n=ae(n,1)}return t=ee(e,i.j(t)),new ne(i,t)}for(i=d;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=Math.ceil(Math.log(n)/Math.LN2),r=r<=48?1:2**(r-48),a=l(n),o=a.j(t);h(o)||o.l(e)>0;)n-=r,a=l(n),o=a.j(t);m(a)&&(a=f),i=i.add(a),e=ee(e,o)}return new ne(i,e)}e.B=function(e){return re(this,e).h},e.and=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new o(n,this.h&e.h)},e.or=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new o(n,this.h|e.h)},e.xor=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new o(n,this.h^e.h)};function ie(e){let t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new o(n,e.h)}function ae(e,t){let n=t>>5;t%=32;let r=e.g.length-n,i=[];for(let a=0;a<r;a++)i[a]=t>0?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new o(i,e.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Br=Rr.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=u,zr=Rr.Integer=o}).apply(Lr===void 0?typeof self<`u`?self:typeof window<`u`?window:{}:Lr);var Vr=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},Hr={},Ur,Wr,Gr,Kr,qr,Jr,Yr,Xr;(function(){var e,t=Object.defineProperty;function n(e){e=[typeof globalThis==`object`&&globalThis,e,typeof window==`object`&&window,typeof self==`object`&&self,typeof Vr==`object`&&Vr];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error(`Cannot find global object`)}var r=n(this);function i(e,n){if(n)a:{var i=r;e=e.split(`.`);for(var a=0;a<e.length-1;a++){var o=e[a];if(!(o in i))break a;i=i[o]}e=e[e.length-1],a=i[e],n=n(a),n!=a&&n!=null&&t(i,e,{configurable:!0,writable:!0,value:n})}}i(`Symbol.dispose`,function(e){return e||Symbol(`Symbol.dispose`)}),i(`Array.prototype.values`,function(e){return e||function(){return this[Symbol.iterator]()}}),i(`Object.entries`,function(e){return e||function(e){var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push([n,e[n]]);return t}});var a=a||{},o=this||self;function s(e){var t=typeof e;return t==`object`&&e!=null||t==`function`}function c(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return l=c,l.apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}var f=typeof AsyncContext<`u`&&typeof AsyncContext.Snapshot==`function`?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function p(e){let t=e.length;if(t>0){let n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function m(e,t){for(let t=1;t<arguments.length;t++){let r=arguments[t];var n=typeof r;if(n=n==`object`?r?Array.isArray(r)?`array`:n:`null`:n,n==`array`||n==`object`&&typeof r.length==`number`){n=e.length||0;let t=r.length||0;e.length=n+t;for(let i=0;i<t;i++)e[n+i]=r[i]}else e.push(r)}}class h{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function g(e){o.setTimeout(()=>{throw e},0)}function ee(){var e=oe;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class te{constructor(){this.h=this.g=null}add(e,t){let n=ne.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}var ne=new h(()=>new re,e=>e.reset());class re{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let ie,ae=!1,oe=new te,se=()=>{let e=Promise.resolve(void 0);ie=()=>{e.then(_)}};function _(){for(var e;e=ee();){try{e.h.call(e.g)}catch(e){g(e)}var t=ne;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}ae=!1}function ce(){this.u=this.u,this.C=this.C}ce.prototype.u=!1,ce.prototype.dispose=function(){this.u||(this.u=!0,this.N())},ce.prototype[Symbol.dispose]=function(){this.dispose()},ce.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function v(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}v.prototype.h=function(){this.defaultPrevented=!0};var le=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},`passive`,{get:function(){e=!0}});try{let e=()=>{};o.addEventListener(`test`,e,t),o.removeEventListener(`test`,e,t)}catch{}return e}();function ue(e){return/^[\s\xa0]*$/.test(e)}function de(e,t){v.call(this,e?e.type:``),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=``,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType=``,this.i=null,e&&this.init(e,t)}d(de,v),de.prototype.init=function(e,t){let n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget,t||(n==`mouseover`?t=e.fromElement:n==`mouseout`&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=r.clientX===void 0?r.pageX:r.clientX,this.clientY=r.clientY===void 0?r.pageY:r.clientY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX===void 0?e.pageX:e.clientX,this.clientY=e.clientY===void 0?e.pageY:e.clientY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||``,this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&de.Z.h.call(this)},de.prototype.h=function(){de.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var fe=`closure_listenable_`+(Math.random()*1e6|0),pe=0;function me(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++pe,this.da=this.fa=!1}function he(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function ge(e,t,n){for(let r in e)t.call(n,e[r],r,e)}function _e(e,t){for(let n in e)t.call(void 0,e[n],n,e)}function ve(e){let t={};for(let n in e)t[n]=e[n];return t}let ye=`constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf`.split(` `);function be(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<ye.length;t++)n=ye[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function xe(e){this.src=e,this.g={},this.h=0}xe.prototype.add=function(e,t,n,r,i){let a=e.toString();e=this.g[a],e||(e=this.g[a]=[],this.h++);let o=Ce(e,t,r,i);return o>-1?(t=e[o],n||(t.fa=!1)):(t=new me(t,this.src,a,!!r,i),t.fa=n,e.push(t)),t};function Se(e,t){let n=t.type;if(n in e.g){var r=e.g[n],i=Array.prototype.indexOf.call(r,t,void 0),a;(a=i>=0)&&Array.prototype.splice.call(r,i,1),a&&(he(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function Ce(e,t,n,r){for(let i=0;i<e.length;++i){let a=e[i];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}var we=`closure_lm_`+(Math.random()*1e6|0),Te={};function Ee(e,t,n,r,i){if(r&&r.once)return ke(e,t,n,r,i);if(Array.isArray(t)){for(let a=0;a<t.length;a++)Ee(e,t[a],n,r,i);return null}return n=Ie(n),e&&e[fe]?e.J(t,n,s(r)?!!r.capture:!!r,i):De(e,t,n,!1,r,i)}function De(e,t,n,r,i,a){if(!t)throw Error(`Invalid event type`);let o=s(i)?!!i.capture:!!i,c=Pe(e);if(c||(e[we]=c=new xe(e)),n=c.add(t,n,r,o,a),n.proxy)return n;if(r=Oe(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)le||(i=o),i===void 0&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Me(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error(`addEventListener and attachEvent are unavailable.`);return n}function Oe(){function e(n){return t.call(e.src,e.listener,n)}let t=Ne;return e}function ke(e,t,n,r,i){if(Array.isArray(t)){for(let a=0;a<t.length;a++)ke(e,t[a],n,r,i);return null}return n=Ie(n),e&&e[fe]?e.K(t,n,s(r)?!!r.capture:!!r,i):De(e,t,n,!0,r,i)}function Ae(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Ae(e,t[a],n,r,i);else r=s(r)?!!r.capture:!!r,n=Ie(n),e&&e[fe]?(e=e.i,a=String(t).toString(),a in e.g&&(t=e.g[a],n=Ce(t,n,r,i),n>-1&&(he(t[n]),Array.prototype.splice.call(t,n,1),t.length==0&&(delete e.g[a],e.h--)))):(e&&=Pe(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Ce(t,n,r,i)),(n=e>-1?t[e]:null)&&je(n))}function je(e){if(typeof e!=`number`&&e&&!e.da){var t=e.src;if(t&&t[fe])Se(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Me(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Pe(t))?(Se(n,e),n.h==0&&(n.src=null,t[we]=null)):he(e)}}}function Me(e){return e in Te?Te[e]:Te[e]=`on`+e}function Ne(e,t){if(e.da)e=!0;else{t=new de(t,this);let n=e.listener,r=e.ha||e.src;e.fa&&je(e),e=n.call(r,t)}return e}function Pe(e){return e=e[we],e instanceof xe?e:null}var Fe=`__closure_events_fn_`+(Math.random()*1e9>>>0);function Ie(e){return typeof e==`function`?e:(e[Fe]||(e[Fe]=function(t){return e.handleEvent(t)}),e[Fe])}function y(){ce.call(this),this.i=new xe(this),this.M=this,this.G=null}d(y,ce),y.prototype[fe]=!0,y.prototype.removeEventListener=function(e,t,n,r){Ae(this,e,t,n,r)};function b(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,typeof t==`string`)t=new v(t,e);else if(t instanceof v)t.target=t.target||e;else{var i=t;t=new v(r,e),be(t,i)}i=!0;let a,o;if(n)for(o=n.length-1;o>=0;o--)a=t.g=n[o],i=Le(a,r,!0,t)&&i;if(a=t.g=e,i=Le(a,r,!0,t)&&i,i=Le(a,r,!1,t)&&i,n)for(o=0;o<n.length;o++)a=t.g=n[o],i=Le(a,r,!1,t)&&i}y.prototype.N=function(){if(y.Z.N.call(this),this.i){var e=this.i;for(let t in e.g){let n=e.g[t];for(let e=0;e<n.length;e++)he(n[e]);delete e.g[t],e.h--}}this.G=null},y.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},y.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};function Le(e,t,n,r){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();let i=!0;for(let a=0;a<t.length;++a){let o=t[a];if(o&&!o.da&&o.capture==n){let t=o.listener,n=o.ha||o.src;o.fa&&Se(e.i,o),i=t.call(n,r)!==!1&&i}}return i&&!r.defaultPrevented}function Re(e,t){if(typeof e!=`function`)if(e&&typeof e.handleEvent==`function`)e=l(e.handleEvent,e);else throw Error(`Invalid listener argument`);return Number(t)>2147483647?-1:o.setTimeout(e,t||0)}function ze(e){e.g=Re(()=>{e.g=null,e.i&&(e.i=!1,ze(e))},e.l);let t=e.h;e.h=null,e.m.apply(null,t)}class Be extends ce{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ze(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ve(e){ce.call(this),this.h=e,this.g={}}d(Ve,ce);var He=[];function Ue(e){ge(e.g,function(e,t){this.g.hasOwnProperty(t)&&je(e)},e),e.g={}}Ve.prototype.N=function(){Ve.Z.N.call(this),Ue(this)},Ve.prototype.handleEvent=function(){throw Error(`EventHandler.handleEvent not implemented`)};var We=o.JSON.stringify,Ge=o.JSON.parse,Ke=class{stringify(e){return o.JSON.stringify(e,void 0)}parse(e){return o.JSON.parse(e,void 0)}};function qe(){}function Je(){}var Ye={OPEN:`a`,hb:`b`,ERROR:`c`,tb:`d`};function Xe(){v.call(this,`d`)}d(Xe,v);function Ze(){v.call(this,`c`)}d(Ze,v);var Qe={},$e=null;function et(){return $e||=new y}Qe.Ia=`serverreachability`;function tt(e){v.call(this,Qe.Ia,e)}d(tt,v);function nt(e){let t=et();b(t,new tt(t))}Qe.STAT_EVENT=`statevent`;function rt(e,t){v.call(this,Qe.STAT_EVENT,e),this.stat=t}d(rt,v);function x(e){let t=et();b(t,new rt(t,e))}Qe.Ja=`timingevent`;function it(e,t){v.call(this,Qe.Ja,e),this.size=t}d(it,v);function at(e,t){if(typeof e!=`function`)throw Error(`Fn must not be null and must be a function`);return o.setTimeout(function(){e()},t)}function ot(){this.g=!0}ot.prototype.ua=function(){this.g=!1};function st(e,t,n,r,i,a){e.info(function(){if(e.g)if(a){var o=``,s=a.split(`&`);for(let e=0;e<s.length;e++){var c=s[e].split(`=`);if(c.length>1){let e=c[0];c=c[1];let t=e.split(`_`);o=t.length>=2&&t[1]==`type`?o+(e+`=`+c+`&`):o+(e+`=redacted&`)}}}else o=null;else o=a;return`XMLHTTP REQ (`+r+`) [attempt `+i+`]: `+t+`
`+n+`
`+o})}function ct(e,t,n,r,i,a,o){e.info(function(){return`XMLHTTP RESP (`+r+`) [ attempt `+i+`]: `+t+`
`+n+`
`+a+` `+o})}function lt(e,t,n,r){e.info(function(){return`XMLHTTP TEXT (`+t+`): `+dt(e,n)+(r?` `+r:``)})}function ut(e,t){e.info(function(){return`TIMEOUT: `+t})}ot.prototype.info=function(){};function dt(e,t){if(!e.g)return t;if(!t)return null;try{let a=JSON.parse(t);if(a){for(e=0;e<a.length;e++)if(Array.isArray(a[e])){var n=a[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if(i!=`noop`&&i!=`stop`&&i!=`close`)for(let e=1;e<r.length;e++)r[e]=``}}}}return We(a)}catch{return t}}var ft={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pt={ib:`complete`,Fb:`success`,ERROR:`error`,Ga:`abort`,xb:`ready`,yb:`readystatechange`,TIMEOUT:`timeout`,sb:`incrementaldata`,wb:`progress`,lb:`downloadprogress`,Nb:`uploadprogress`},mt;function ht(){}d(ht,qe),ht.prototype.g=function(){return new XMLHttpRequest},mt=new ht;function gt(e){return encodeURIComponent(String(e))}function _t(e){var t=1;e=e.split(`:`);let n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(`:`)),n}function vt(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new Ve(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new yt}function yt(){this.i=null,this.g=``,this.h=!1}var bt={},xt={};function St(e,t,n){e.M=1,e.A=qt(S(t)),e.u=n,e.R=!0,Ct(e,null)}function Ct(e,t){e.F=Date.now(),Dt(e),e.B=S(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),on(n.i,`t`,r),e.C=0,n=e.j.L,e.h=new yt,e.g=Yn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new Be(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i=`readystatechange`;Array.isArray(i)||(i&&(He[0]=i.toString()),i=He);for(let e=0;e<i.length;e++){let a=Ee(n,i[e],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.J?ve(e.J):{},e.u?(e.v||=`POST`,t[`Content-Type`]=`application/x-www-form-urlencoded`,e.g.ea(e.B,e.v,e.u,t)):(e.v=`GET`,e.g.ea(e.B,e.v,null,t)),nt(),st(e.i,e.v,e.B,e.l,e.S,e.u)}vt.prototype.ba=function(e){e=e.target;let t=this.O;t&&Dn(e)==3?t.j():this.Y(e)},vt.prototype.Y=function(e){try{if(e==this.g)a:{let s=Dn(this.g),c=this.g.ya(),l=this.g.ca();if(!(s<3)&&(s!=3||this.g&&(this.h.h||this.g.la()||On(this.g)))){this.K||s!=4||c==7||nt(c==8||l<=0?3:2),kt(this);var t=this.g.ca();this.X=t;var n=wt(this);if(this.o=t==200,ct(this.i,this.v,this.B,this.l,this.S,s,t),this.o){if(this.U&&!this.L){b:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader(`X-HTTP-Initial-Response`):null)&&!ue(r)){var a=r;break b}}a=null}if(e=a)lt(this.i,this.l,e,`Initial handshake response via X-HTTP-Initial-Response`),this.L=!0,Mt(this,e);else{this.o=!1,this.m=3,x(12),jt(this),At(this);break a}}if(this.R){e=!0;let t;for(;!this.K&&this.C<n.length;)if(t=Et(this,n),t==xt){s==4&&(this.m=4,x(14),e=!1),lt(this.i,this.l,null,`[Incomplete Response]`);break}else if(t==bt){this.m=4,x(15),lt(this.i,this.l,n,`[Invalid Chunk]`),e=!1;break}else lt(this.i,this.l,t,null),Mt(this,t);if(Tt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),s!=4||n.length!=0||this.h.h||(this.m=1,x(16),e=!1),this.o=this.o&&e,!e)lt(this.i,this.l,n,`[Invalid Chunked Response]`),jt(this),At(this);else if(n.length>0&&!this.W){this.W=!0;var o=this.j;o.g==this&&o.aa&&!o.P&&(o.j.info(`Great, no buffering proxy detected. Bytes received: `+n.length),Vn(o),o.P=!0,x(11))}}else lt(this.i,this.l,n,null),Mt(this,n);s==4&&jt(this),this.o&&!this.K&&(s==4?Wn(this.j,this):(this.o=!1,Dt(this)))}else kn(this.g),t==400&&n.indexOf(`Unknown SID`)>0?(this.m=3,x(12)):(this.m=0,x(13)),jt(this),At(this)}}}catch{}};function wt(e){if(!Tt(e))return e.g.la();let t=On(e.g);if(t===``)return``;let n=``,r=t.length,i=Dn(e.g)==4;if(!e.h.i){if(typeof TextDecoder>`u`)return jt(e),At(e),``;e.h.i=new o.TextDecoder}for(let a=0;a<r;a++)e.h.h=!0,n+=e.h.i.decode(t[a],{stream:!(i&&a==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}function Tt(e){return e.g?e.v==`GET`&&e.M!=2&&e.j.Aa:!1}function Et(e,t){var n=e.C,r=t.indexOf(`
`,n);return r==-1?xt:(n=Number(t.substring(n,r)),isNaN(n)?bt:(r+=1,r+n>t.length?xt:(t=t.slice(r,r+n),e.C=r+n,t)))}vt.prototype.cancel=function(){this.K=!0,jt(this)};function Dt(e){e.T=Date.now()+e.H,Ot(e,e.H)}function Ot(e,t){if(e.D!=null)throw Error(`WatchDog timer not null`);e.D=at(l(e.aa,e),t)}function kt(e){e.D&&=(o.clearTimeout(e.D),null)}vt.prototype.aa=function(){this.D=null;let e=Date.now();e-this.T>=0?(ut(this.i,this.B),this.M!=2&&(nt(),x(17)),jt(this),this.m=2,At(this)):Ot(this,this.T-e)};function At(e){e.j.I==0||e.K||Wn(e.j,e)}function jt(e){kt(e);var t=e.O;t&&typeof t.dispose==`function`&&t.dispose(),e.O=null,Ue(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function Mt(e,t){try{var n=e.j;if(n.I!=0&&(n.g==e||Lt(n.h,e))){if(!e.L&&Lt(n.h,e)&&n.I==3){try{var r=n.Ba.g.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){a:if(!n.v){if(n.g)if(n.g.F+3e3<e.F)Un(n),D(n);else break a;Bn(n),x(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&n.A==0&&!n.C&&(n.C=at(l(n.Va,n),6e3));It(n.h)<=1&&n.ta&&(n.ta=void 0)}else Kn(n,11)}else if((e.L||n.g==e)&&Un(n),!ue(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let l=i[t],u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],n.I==2)if(l[0]==`c`){n.M=l[1],n.ba=l[2];let t=l[3];t!=null&&(n.ka=t,n.j.info(`VER=`+n.ka));let i=l[4];i!=null&&(n.za=i,n.j.info(`SVER=`+n.za));let u=l[5];u!=null&&typeof u==`number`&&u>0&&(r=1.5*u,n.O=r,n.j.info(`backChannelRequestTimeoutMs_=`+r)),r=n;let d=e.g;if(d){let e=d.g?d.g.getResponseHeader(`X-Client-Wire-Protocol`):null;if(e){var a=r.h;a.g||e.indexOf(`spdy`)==-1&&e.indexOf(`quic`)==-1&&e.indexOf(`h2`)==-1||(a.j=a.l,a.g=new Set,a.h&&=(Rt(a,a.h),null))}if(r.G){let e=d.g?d.g.getResponseHeader(`X-HTTP-Session-Id`):null;e&&(r.wa=e,C(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info(`Handshake RTT: `+n.T+`ms`)),r=n;var o=e;if(r.na=Jn(r,r.L?r.ba:null,r.W),o.L){zt(r.h,o);var s=o,c=r.O;c&&(s.H=c),s.D&&(kt(s),Dt(s)),r.g=o}else zn(r);n.i.length>0&&Pn(n)}else l[0]!=`stop`&&l[0]!=`close`||Kn(n,7);else n.I==3&&(l[0]==`stop`||l[0]==`close`?l[0]==`stop`?Kn(n,7):Mn(n):l[0]!=`noop`&&n.l&&n.l.qa(l),n.A=0)}}nt(4)}catch{}}var Nt=class{constructor(e,t){this.g=e,this.map=t}};function Pt(e){this.l=e||10,o.PerformanceNavigationTiming?(e=o.performance.getEntriesByType(`navigation`),e=e.length>0&&(e[0].nextHopProtocol==`hq`||e[0].nextHopProtocol==`h2`)):e=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ft(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function It(e){return e.h?1:e.g?e.g.size:0}function Lt(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Rt(e,t){e.g?e.g.add(t):e.h=t}function zt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}Pt.prototype.cancel=function(){if(this.i=Bt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let e of this.g.values())e.cancel();this.g.clear()}};function Bt(e){if(e.h!=null)return e.i.concat(e.h.G);if(e.g!=null&&e.g.size!==0){let t=e.i;for(let n of e.g.values())t=t.concat(n.G);return t}return p(e.i)}var Vt=RegExp(`^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$`);function Ht(e,t){if(e){e=e.split(`&`);for(let n=0;n<e.length;n++){let r=e[n].indexOf(`=`),i,a=null;r>=0?(i=e[n].substring(0,r),a=e[n].substring(r+1)):i=e[n],t(i,a?decodeURIComponent(a.replace(/\+/g,` `)):``)}}}function Ut(e){this.g=this.o=this.j=``,this.u=null,this.m=this.h=``,this.l=!1;let t;e instanceof Ut?(this.l=e.l,Wt(this,e.j),this.o=e.o,this.g=e.g,Gt(this,e.u),this.h=e.h,Kt(this,sn(e.i)),this.m=e.m):e&&(t=String(e).match(Vt))?(this.l=!1,Wt(this,t[1]||``,!0),this.o=w(t[2]||``),this.g=w(t[3]||``,!0),Gt(this,t[4]),this.h=w(t[5]||``,!0),Kt(this,t[6]||``,!0),this.m=w(t[7]||``)):(this.l=!1,this.i=new T(null,this.l))}Ut.prototype.toString=function(){let e=[];var t=this.j;t&&e.push(Jt(t,Xt,!0),`:`);var n=this.g;return(n||t==`file`)&&(e.push(`//`),(t=this.o)&&e.push(Jt(t,Xt,!0),`@`),e.push(gt(n).replace(/%25([0-9a-fA-F]{2})/g,`%$1`)),n=this.u,n!=null&&e.push(`:`,String(n))),(n=this.h)&&(this.g&&n.charAt(0)!=`/`&&e.push(`/`),e.push(Jt(n,n.charAt(0)==`/`?Qt:Zt,!0))),(n=this.i.toString())&&e.push(`?`,n),(n=this.m)&&e.push(`#`,Jt(n,en)),e.join(``)},Ut.prototype.resolve=function(e){let t=S(this),n=!!e.j;n?Wt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=e.u!=null;var r=e.h;if(n)Gt(t,e.u);else if(n=!!e.h){if(r.charAt(0)!=`/`)if(this.g&&!this.h)r=`/`+r;else{var i=t.h.lastIndexOf(`/`);i!=-1&&(r=t.h.slice(0,i+1)+r)}if(i=r,i==`..`||i==`.`)r=``;else if(i.indexOf(`./`)!=-1||i.indexOf(`/.`)!=-1){r=i.lastIndexOf(`/`,0)==0,i=i.split(`/`);let e=[];for(let t=0;t<i.length;){let n=i[t++];n==`.`?r&&t==i.length&&e.push(``):n==`..`?((e.length>1||e.length==1&&e[0]!=``)&&e.pop(),r&&t==i.length&&e.push(``)):(e.push(n),r=!0)}r=e.join(`/`)}else r=i}return n?t.h=r:n=e.i.toString()!==``,n?Kt(t,sn(e.i)):n=!!e.m,n&&(t.m=e.m),t};function S(e){return new Ut(e)}function Wt(e,t,n){e.j=n?w(t,!0):t,e.j&&=e.j.replace(/:$/,``)}function Gt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error(`Bad port number `+t);e.u=t}else e.u=null}function Kt(e,t,n){t instanceof T?(e.i=t,ln(e.i,e.l)):(n||(t=Jt(t,$t)),e.i=new T(t,e.l))}function C(e,t,n){e.i.set(t,n)}function qt(e){return C(e,`zx`,Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),e}function w(e,t){return e?t?decodeURI(e.replace(/%25/g,`%2525`)):decodeURIComponent(e):``}function Jt(e,t,n){return typeof e==`string`?(e=encodeURI(e).replace(t,Yt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,`%$1`)),e):null}function Yt(e){return e=e.charCodeAt(0),`%`+(e>>4&15).toString(16)+(e&15).toString(16)}var Xt=/[#\/\?@]/g,Zt=/[#\?:]/g,Qt=/[#\?]/g,$t=/[#\?@]/g,en=/#/g;function T(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function tn(e){e.g||(e.g=new Map,e.h=0,e.i&&Ht(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g,` `)),n)}))}e=T.prototype,e.add=function(e,t){tn(this),this.i=null,e=cn(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function nn(e,t){tn(e),t=cn(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function rn(e,t){return tn(e),t=cn(e,t),e.g.has(t)}e.forEach=function(e,t){tn(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)};function an(e,t){tn(e);let n=[];if(typeof t==`string`)rn(e,t)&&(n=n.concat(e.g.get(cn(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}e.set=function(e,t){return tn(this),this.i=null,e=cn(this,e),rn(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e?(e=an(this,e),e.length>0?String(e[0]):t):t};function on(e,t,n){nn(e,t),n.length>0&&(e.i=null,e.g.set(cn(e,t),p(n)),e.h+=n.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return``;let e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];let i=gt(n);n=an(this,n);for(let t=0;t<n.length;t++){let r=i;n[t]!==``&&(r+=`=`+gt(n[t])),e.push(r)}}return this.i=e.join(`&`)};function sn(e){let t=new T;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function cn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function ln(e,t){t&&!e.j&&(tn(e),e.i=null,e.g.forEach(function(e,t){let n=t.toLowerCase();t!=n&&(nn(this,t),on(this,n,e))},e)),e.j=t}function un(e,t){let n=new ot;if(o.Image){let r=new Image;r.onload=u(fn,n,`TestLoadImage: loaded`,!0,t,r),r.onerror=u(fn,n,`TestLoadImage: error`,!1,t,r),r.onabort=u(fn,n,`TestLoadImage: abort`,!1,t,r),r.ontimeout=u(fn,n,`TestLoadImage: timeout`,!1,t,r),o.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function dn(e,t){let n=new ot,r=new AbortController,i=setTimeout(()=>{r.abort(),fn(n,`TestPingServer: timeout`,!1,t)},1e4);fetch(e,{signal:r.signal}).then(e=>{clearTimeout(i),e.ok?fn(n,`TestPingServer: ok`,!0,t):fn(n,`TestPingServer: server error`,!1,t)}).catch(()=>{clearTimeout(i),fn(n,`TestPingServer: error`,!1,t)})}function fn(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch{}}function pn(){this.g=new Ke}function mn(e){this.i=e.Sb||null,this.h=e.ab||!1}d(mn,qe),mn.prototype.g=function(){return new hn(this.i,this.h)};function hn(e,t){y.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText=``,this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F=`GET`,this.D=``,this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(hn,y),e=hn.prototype,e.open=function(e,t){if(this.readyState!=0)throw this.abort(),Error(`Error reopening a connection`);this.F=e,this.D=t,this.readyState=1,vn(this)},e.send=function(e){if(this.readyState!=1)throw this.abort(),Error(`need to call open() first. `);if(this.v.signal.aborted)throw this.abort(),Error(`Request was aborted.`);this.g=!0;let t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||o).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText=``,this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel(`Request was aborted.`).catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,_n(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,vn(this)),this.g&&(this.readyState=3,vn(this),this.g)))if(this.responseType===`arraybuffer`)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(o.ReadableStream!==void 0&&`body`in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error(`responseType must be empty for "streamBinaryChunks" mode responses.`);this.response=[]}else this.response=this.responseText=``,this.B=new TextDecoder;gn(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))};function gn(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array;(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?_n(this):vn(this),this.readyState==3&&gn(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,_n(this))},e.Na=function(e){this.g&&(this.response=e,_n(this))},e.ga=function(){this.g&&_n(this)};function _n(e){e.readyState=4,e.l=null,e.j=null,e.B=null,vn(e)}e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||``},e.getAllResponseHeaders=function(){if(!this.h)return``;let e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+`: `+n[1]),n=t.next();return e.join(`\r
`)};function vn(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(hn.prototype,`withCredentials`,{get:function(){return this.m===`include`},set:function(e){this.m=e?`include`:`same-origin`}});function yn(e){let t=``;return ge(e,function(e,n){t+=n,t+=`:`,t+=e,t+=`\r
`}),t}function bn(e,t,n){a:{for(r in n){var r=!1;break a}r=!0}r||(n=yn(n),typeof e==`string`||C(e,t,n))}function E(e){y.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D=``,this.o=0,this.l=``,this.j=this.B=this.v=this.A=!1,this.m=null,this.F=``,this.H=!1}d(E,y);var xn=/^https?$/i,Sn=[`POST`,`PUT`];e=E.prototype,e.Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error(`[goog.net.XhrIo] Object is active with another request=`+this.D+`; newUri=`+e);t=t?t.toUpperCase():`GET`,this.D=e,this.l=``,this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():mt.g(),this.g.onreadystatechange=f(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){Cn(this,e);return}if(e=n||``,n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys==`function`&&typeof r.get==`function`)for(let e of r.keys())n.set(e,r.get(e));else throw Error(`Unknown input type for opt_headers: `+String(r));r=Array.from(n.keys()).find(e=>e.toLowerCase()==`content-type`),i=o.FormData&&e instanceof o.FormData,!(Array.prototype.indexOf.call(Sn,t,void 0)>=0)||r||i||n.set(`Content-Type`,`application/x-www-form-urlencoded;charset=utf-8`);for(let[e,t]of n)this.g.setRequestHeader(e,t);this.F&&(this.g.responseType=this.F),`withCredentials`in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&=(clearTimeout(this.m),null),this.v=!0,this.g.send(e),this.v=!1}catch(e){Cn(this,e)}};function Cn(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,wn(e),En(e)}function wn(e){e.A||(e.A=!0,b(e,`complete`),b(e,`error`))}e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,b(this,`complete`),b(this,`abort`),En(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),En(this,!0)),E.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Tn(this):this.Xa())},e.Xa=function(){Tn(this)};function Tn(e){if(e.h&&a!==void 0){if(e.v&&Dn(e)==4)setTimeout(e.Ca.bind(e),0);else if(b(e,`readystatechange`),Dn(e)==4){e.h=!1;try{let a=e.ca();a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break a;default:t=!1}var n;if(!(n=t)){var r;if(r=a===0){let t=String(e.D).match(Vt)[1]||null;!t&&o.self&&o.self.location&&(t=o.self.location.protocol.slice(0,-1)),r=!xn.test(t?t.toLowerCase():``)}n=r}if(n)b(e,`complete`),b(e,`success`);else{e.o=6;try{var i=Dn(e)>2?e.g.statusText:``}catch{i=``}e.l=i+` [`+e.ca()+`]`,wn(e)}}finally{En(e)}}}}function En(e,t){if(e.g){e.m&&=(clearTimeout(e.m),null);let n=e.g;e.g=null,t||b(e,`ready`);try{n.onreadystatechange=null}catch{}}}e.isActive=function(){return!!this.g};function Dn(e){return e.g?e.g.readyState:0}e.ca=function(){try{return Dn(this)>2?this.g.status:-1}catch{return-1}},e.la=function(){try{return this.g?this.g.responseText:``}catch{return``}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),Ge(t)}};function On(e){try{if(!e.g)return null;if(`response`in e.g)return e.g.response;switch(e.F){case``:case`text`:return e.g.responseText;case`arraybuffer`:if(`mozResponseArrayBuffer`in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function kn(e){let t={};e=(e.g&&Dn(e)>=2&&e.g.getAllResponseHeaders()||``).split(`\r
`);for(let r=0;r<e.length;r++){if(ue(e[r]))continue;var n=_t(e[r]);let i=n[0];if(n=n[1],typeof n!=`string`)continue;n=n.trim();let a=t[i]||[];t[i]=a,a.push(n)}_e(t,function(e){return e.join(`, `)})}e.ya=function(){return this.o},e.Ha=function(){return typeof this.l==`string`?this.l:String(this.l)};function An(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function jn(e){this.za=0,this.i=[],this.j=new ot,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=An(`failFast`,!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=An(`baseRetryDelayMs`,5e3,e),this.Za=An(`retryDelaySeedMs`,1e4,e),this.Ta=An(`forwardChannelMaxRetries`,2,e),this.va=An(`forwardChannelRequestTimeoutMs`,2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M=``,this.h=new Pt(e&&e.concurrentRequestLimit),this.Ba=new pn,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}e=jn.prototype,e.ka=8,e.I=1,e.connect=function(e,t,n,r){x(0),this.W=e,this.H=t||{},n&&r!==void 0&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=Jn(this,null,this.W),Pn(this)};function Mn(e){if(Nn(e),e.I==3){var t=e.V++,n=S(e.J);if(C(n,`SID`,e.M),C(n,`RID`,t),C(n,`TYPE`,`terminate`),Ln(e,n),t=new vt(e,e.j,t),t.M=2,t.A=qt(S(n)),n=!1,o.navigator&&o.navigator.sendBeacon)try{n=o.navigator.sendBeacon(t.A.toString(),``)}catch{}!n&&o.Image&&(new Image().src=t.A,n=!0),n||(t.g=Yn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),Dt(t)}qn(e)}function D(e){e.g&&=(Vn(e),e.g.cancel(),null)}function Nn(e){D(e),e.v&&=(o.clearTimeout(e.v),null),Un(e),e.h.cancel(),e.m&&=(typeof e.m==`number`&&o.clearTimeout(e.m),null)}function Pn(e){if(!Ft(e.h)&&!e.m){e.m=!0;var t=e.Ea;ie||se(),ae||=(ie(),!0),oe.add(t,e),e.D=0}}function Fn(e,t){return It(e.h)>=e.h.j-(e.m?1:0)?!1:e.m?(e.i=t.G.concat(e.i),!0):e.I==1||e.I==2||e.D>=(e.Sa?0:e.Ta)?!1:(e.m=at(l(e.Ea,e,t),Gn(e,e.D)),e.D++,!0)}e.Ea=function(e){if(this.m)if(this.m=null,this.I==1){if(!e){this.V=Math.floor(Math.random()*1e5),e=this.V++;let i=new vt(this,this.j,e),a=this.o;if(this.U&&(a?(a=ve(a),be(a,this.U)):a=this.U),this.u!==null||this.R||(i.J=a,a=null),this.S)a:{for(var t=0,n=0;n<this.i.length;n++){b:{var r=this.i[n];if(`__data__`in r.map&&(r=r.map.__data__,typeof r==`string`)){r=r.length;break b}r=void 0}if(r===void 0)break;if(t+=r,t>4096){t=n;break a}if(t===4096||n===this.i.length-1){t=n+1;break a}}t=1e3}else t=1e3;t=Rn(this,i,t),n=S(this.J),C(n,`RID`,e),C(n,`CVER`,22),this.G&&C(n,`X-HTTP-Session-Id`,this.G),Ln(this,n),a&&(this.R?t=`headers=`+gt(yn(a))+`&`+t:this.u&&bn(n,this.u,a)),Rt(this.h,i),this.Ra&&C(n,`TYPE`,`init`),this.S?(C(n,`$req`,t),C(n,`SID`,`null`),i.U=!0,St(i,n,null)):St(i,n,t),this.I=2}}else this.I==3&&(e?In(this,e):this.i.length==0||Ft(this.h)||In(this))};function In(e,t){var n=t?t.l:e.V++;let r=S(e.J);C(r,`SID`,e.M),C(r,`RID`,n),C(r,`AID`,e.K),Ln(e,r),e.u&&e.o&&bn(r,e.u,e.o),n=new vt(e,e.j,n,e.D+1),e.u===null&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=Rn(e,n,1e3),n.H=Math.round(e.va*.5)+Math.round(e.va*.5*Math.random()),Rt(e.h,n),St(n,r,t)}function Ln(e,t){e.H&&ge(e.H,function(e,n){C(t,n,e)}),e.l&&ge({},function(e,n){C(t,n,e)})}function Rn(e,t,n){n=Math.min(e.i.length,n);let r=e.l?l(e.l.Ka,e.l,e):null;a:{var i=e.i;let t=-1;for(;;){let e=[`count=`+n];t==-1?n>0?(t=i[0].g,e.push(`ofs=`+t)):t=0:e.push(`ofs=`+t);let c=!0;for(let l=0;l<n;l++){var a=i[l].g;let n=i[l].map;if(a-=t,a<0)t=Math.max(0,i[l].g-100),c=!1;else try{a=`req`+a+`_`||``;try{var o=n instanceof Map?n:Object.entries(n);for(let[t,n]of o){let r=n;s(n)&&(r=We(n)),e.push(a+t+`=`+encodeURIComponent(r))}}catch(t){throw e.push(a+`type=_badmap`),t}}catch{r&&r(n)}}if(c){o=e.join(`&`);break a}}o=void 0}return e=e.i.splice(0,n),t.G=e,o}function zn(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;ie||se(),ae||=(ie(),!0),oe.add(t,e),e.A=0}}function Bn(e){return e.g||e.v||e.A>=3?!1:(e.Y++,e.v=at(l(e.Da,e),Gn(e,e.A)),e.A++,!0)}e.Da=function(){if(this.v=null,Hn(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var e=4*this.T;this.j.info(`BP detection timer enabled: `+e),this.B=at(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info(`BP detection timeout reached.`),this.j.info(`Buffering proxy detected and switch to long-polling!`),this.F=!1,this.P=!0,x(10),D(this),Hn(this))};function Vn(e){e.B!=null&&(o.clearTimeout(e.B),e.B=null)}function Hn(e){e.g=new vt(e,e.j,`rpc`,e.Y),e.u===null&&(e.g.J=e.o),e.g.P=0;var t=S(e.na);C(t,`RID`,`rpc`),C(t,`SID`,e.M),C(t,`AID`,e.K),C(t,`CI`,e.F?`0`:`1`),!e.F&&e.ia&&C(t,`TO`,e.ia),C(t,`TYPE`,`xmlhttp`),Ln(e,t),e.u&&e.o&&bn(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=qt(S(t)),n.u=null,n.R=!0,Ct(n,e)}e.Va=function(){this.C!=null&&(this.C=null,D(this),Bn(this),x(19))};function Un(e){e.C!=null&&(o.clearTimeout(e.C),e.C=null)}function Wn(e,t){var n=null;if(e.g==t){Un(e),Vn(e),e.g=null;var r=2}else if(Lt(e.h,t))n=t.G,zt(e.h,t),r=1;else return;if(e.I!=0){if(t.o)if(r==1){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;r=et(),b(r,new it(r,n)),Pn(e)}else zn(e);else if(i=t.m,i==3||i==0&&t.X>0||!(r==1&&Fn(e,t)||r==2&&Bn(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:Kn(e,5);break;case 4:Kn(e,10);break;case 3:Kn(e,6);break;default:Kn(e,2)}}}function Gn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function Kn(e,t){if(e.j.info(`Error code `+t),t==2){var n=l(e.bb,e),r=e.Ua;let t=!r;r=new Ut(r||`//www.google.com/images/cleardot.gif`),o.location&&o.location.protocol==`http`||Wt(r,`https`),qt(r),t?un(r.toString(),n):dn(r.toString(),n)}else x(2);e.I=0,e.l&&e.l.pa(t),qn(e),Nn(e)}e.bb=function(e){e?(this.j.info(`Successfully pinged google.com`),x(2)):(this.j.info(`Failed to ping google.com`),x(1))};function qn(e){if(e.I=0,e.ja=[],e.l){let t=Bt(e.h);(t.length!=0||e.i.length!=0)&&(m(e.ja,t),m(e.ja,e.i),e.h.i.length=0,p(e.i),e.i.length=0),e.l.oa()}}function Jn(e,t,n){var r=n instanceof Ut?S(n):new Ut(n);if(r.g!=``)t&&(r.g=t+`.`+r.g),Gt(r,r.u);else{var i=o.location;r=i.protocol,t=t?t+`.`+i.hostname:i.hostname,i=+i.port;let e=new Ut(null);r&&Wt(e,r),t&&(e.g=t),i&&Gt(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&C(r,n,t),C(r,`VER`,e.ka),Ln(e,r),r}function Yn(e,t,n){if(t&&!e.L)throw Error(`Can't create secondary domain capable XhrIo object.`);return t=e.Aa&&!e.ma?new E(new mn({ab:n})):new E(e.ma),t.Fa(e.L),t}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xn(){}e=Xn.prototype,e.ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){};function Zn(){}Zn.prototype.g=function(e,t){return new O(e,t)};function O(e,t){y.call(this),this.g=new jn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e[`X-Client-Protocol`]=`webchannel`:e={"X-Client-Protocol":`webchannel`}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e[`X-WebChannel-Content-Type`]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e[`X-WebChannel-Client-Profile`]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!ue(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t&&=t.httpSessionIdParam)&&!ue(t)&&(this.g.G=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new er(this)}d(O,y),O.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},O.prototype.close=function(){Mn(this.g)},O.prototype.o=function(e){var t=this.g;if(typeof e==`string`){var n={};n.__data__=e,e=n}else this.v&&(n={},n.__data__=We(e),e=n);t.i.push(new Nt(t.Ya++,e)),t.I==3&&Pn(t)},O.prototype.N=function(){this.g.l=null,delete this.j,Mn(this.g),delete this.g,O.Z.N.call(this)};function Qn(e){Xe.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){a:{for(let n in t){e=n;break a}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}d(Qn,Xe);function $n(){Ze.call(this),this.status=1}d($n,Ze);function er(e){this.g=e}d(er,Xn),er.prototype.ra=function(){b(this.g,`a`)},er.prototype.qa=function(e){b(this.g,new Qn(e))},er.prototype.pa=function(e){b(this.g,new $n)},er.prototype.oa=function(){b(this.g,`b`)},Zn.prototype.createWebChannel=Zn.prototype.g,O.prototype.send=O.prototype.o,O.prototype.open=O.prototype.m,O.prototype.close=O.prototype.close,Xr=Hr.createWebChannelTransport=function(){return new Zn},Yr=Hr.getStatEventTarget=function(){return et()},Jr=Hr.Event=Qe,qr=Hr.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ft.NO_ERROR=0,ft.TIMEOUT=8,ft.HTTP_ERROR=6,Kr=Hr.ErrorCode=ft,pt.COMPLETE=`complete`,Gr=Hr.EventType=pt,Je.EventType=Ye,Ye.OPEN=`a`,Ye.CLOSE=`b`,Ye.ERROR=`c`,Ye.MESSAGE=`d`,y.prototype.listen=y.prototype.J,Wr=Hr.WebChannel=Je,Hr.FetchXmlHttpFactory=mn,E.prototype.listenOnce=E.prototype.K,E.prototype.getLastError=E.prototype.Ha,E.prototype.getLastErrorCode=E.prototype.ya,E.prototype.getStatus=E.prototype.ca,E.prototype.getResponseJson=E.prototype.La,E.prototype.getResponseText=E.prototype.la,E.prototype.send=E.prototype.ea,E.prototype.setWithCredentials=E.prototype.Fa,Ur=Hr.XhrIo=E}).apply(Vr===void 0?typeof self<`u`?self:typeof window<`u`?window:{}:Vr);var Zr=`@firebase/firestore`,Qr=`4.9.3`,k=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?`uid:`+this.uid:`anonymous-user`}isEqual(e){return e.uid===this.uid}};k.UNAUTHENTICATED=new k(null),k.GOOGLE_CREDENTIALS=new k(`google-credentials-uid`),k.FIRST_PARTY=new k(`first-party-uid`),k.MOCK_USER=new k(`mock-user`);var $r=`12.7.0`,ei=new on(`@firebase/firestore`);function ti(){return ei.logLevel}function A(e,...t){if(ei.logLevel<=T.DEBUG){let n=t.map(ii);ei.debug(`Firestore (${$r}): ${e}`,...n)}}function ni(e,...t){if(ei.logLevel<=T.ERROR){let n=t.map(ii);ei.error(`Firestore (${$r}): ${e}`,...n)}}function ri(e,...t){if(ei.logLevel<=T.WARN){let n=t.map(ii);ei.warn(`Firestore (${$r}): ${e}`,...n)}}function ii(e){if(typeof e==`string`)return e;try{return function(e){return JSON.stringify(e)}(e)}catch{return e}}function j(e,t,n){let r=`Unexpected state`;typeof t==`string`?r=t:n=t,ai(e,r,n)}function ai(e,t,n){let r=`FIRESTORE (${$r}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=` CONTEXT: `+JSON.stringify(n)}catch{r+=` CONTEXT: `+n}throw ni(r),Error(r)}function M(e,t,n,r){let i=`Unexpected state`;typeof n==`string`?i=n:r=n,e||ai(t,i,r)}function N(e,t){return e}var P={OK:`ok`,CANCELLED:`cancelled`,UNKNOWN:`unknown`,INVALID_ARGUMENT:`invalid-argument`,DEADLINE_EXCEEDED:`deadline-exceeded`,NOT_FOUND:`not-found`,ALREADY_EXISTS:`already-exists`,PERMISSION_DENIED:`permission-denied`,UNAUTHENTICATED:`unauthenticated`,RESOURCE_EXHAUSTED:`resource-exhausted`,FAILED_PRECONDITION:`failed-precondition`,ABORTED:`aborted`,OUT_OF_RANGE:`out-of-range`,UNIMPLEMENTED:`unimplemented`,INTERNAL:`internal`,UNAVAILABLE:`unavailable`,DATA_LOSS:`data-loss`},F=class extends S{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}},oi=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}},si=class{constructor(e,t){this.user=t,this.type=`OAuth`,this.headers=new Map,this.headers.set(`Authorization`,`Bearer ${e}`)}},ci=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(k.UNAUTHENTICATED)))}shutdown(){}},li=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}},ui=class{constructor(e){this.t=e,this.currentUser=k.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){M(this.o===void 0,42304);let n=this.i,r=e=>this.i===n?Promise.resolve():(n=this.i,t(e)),i=new oi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new oi,e.enqueueRetryable((()=>r(this.currentUser)))};let a=()=>{let t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{A(`FirebaseAuthCredentialsProvider`,`Auth detected`),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?o(e):(A(`FirebaseAuthCredentialsProvider`,`Auth not yet detected`),i.resolve(),i=new oi)}}),0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i===e?t?(M(typeof t.accessToken==`string`,31837,{l:t}),new si(t.accessToken,this.currentUser)):null:(A(`FirebaseAuthCredentialsProvider`,`getToken aborted due to token change.`),this.getToken()))):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return M(e===null||typeof e==`string`,2055,{h:e}),new k(e)}},di=class{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type=`FirstParty`,this.user=k.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set(`X-Goog-AuthUser`,this.P);let e=this.R();return e&&this.A.set(`Authorization`,e),this.T&&this.A.set(`X-Goog-Iam-Authorization-Token`,this.T),this.A}},fi=class{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new di(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(k.FIRST_PARTY)))}shutdown(){}invalidateToken(){}},pi=class{constructor(e){this.value=e,this.type=`AppCheck`,this.headers=new Map,e&&e.length>0&&this.headers.set(`x-firebase-appcheck`,this.value)}},mi=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,pr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){M(this.o===void 0,3512);let n=e=>{e.error!=null&&A(`FirebaseAppCheckTokenProvider`,`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let n=e.token!==this.m;return this.m=e.token,A(`FirebaseAppCheckTokenProvider`,`Received ${n?`new`:`existing`} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};let r=e=>{A(`FirebaseAppCheckTokenProvider`,`AppCheck detected`),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?r(e):A(`FirebaseAppCheckTokenProvider`,`AppCheck not yet detected`)}}),0)}getToken(){if(this.p)return Promise.resolve(new pi(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(M(typeof e.token==`string`,44558,{tokenResult:e}),this.m=e.token,new pi(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function hi(e){let t=typeof self<`u`&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues==`function`)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}var gi=class{static newId(){let e=``;for(;e.length<20;){let t=hi(40);for(let n=0;n<t.length;++n)e.length<20&&t[n]<248&&(e+=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789`.charAt(t[n]%62))}return e}};function I(e,t){return e<t?-1:e>t?1:0}function _i(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++){let n=e.charAt(r),i=t.charAt(r);if(n!==i)return bi(n)===bi(i)?I(n,i):bi(n)?1:-1}return I(e.length,t.length)}var vi=55296,yi=57343;function bi(e){let t=e.charCodeAt(0);return t>=vi&&t<=yi}function xi(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}var Si=`__name__`,Ci=class e{constructor(e,t,n){t===void 0?t=0:t>e.length&&j(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&j(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(t){return e.comparator(this,t)===0}child(t){let n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((e=>{n.push(e)})):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){let r=Math.min(t.length,n.length);for(let i=0;i<r;i++){let r=e.compareSegments(t.get(i),n.get(i));if(r!==0)return r}return I(t.length,n.length)}static compareSegments(t,n){let r=e.isNumericId(t),i=e.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?e.extractNumericId(t).compare(e.extractNumericId(n)):_i(t,n)}static isNumericId(e){return e.startsWith(`__id`)&&e.endsWith(`__`)}static extractNumericId(e){return zr.fromString(e.substring(4,e.length-2))}},L=class e extends Ci{construct(t,n,r){return new e(t,n,r)}canonicalString(){return this.toArray().join(`/`)}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join(`/`)}static fromString(...t){let n=[];for(let e of t){if(e.indexOf(`//`)>=0)throw new F(P.INVALID_ARGUMENT,`Invalid segment (${e}). Paths must not contain // in them.`);n.push(...e.split(`/`).filter((e=>e.length>0)))}return new e(n)}static emptyPath(){return new e([])}},wi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ti=class e extends Ci{construct(t,n,r){return new e(t,n,r)}static isValidIdentifier(e){return wi.test(e)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,`\\\\`).replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(`.`)}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Si}static keyField(){return new e([Si])}static fromServerFormat(t){let n=[],r=``,i=0,a=()=>{if(r.length===0)throw new F(P.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=``},o=!1;for(;i<t.length;){let e=t[i];if(e===`\\`){if(i+1===t.length)throw new F(P.INVALID_ARGUMENT,`Path has trailing escape character: `+t);let e=t[i+1];if(e!==`\\`&&e!==`.`&&e!=="`")throw new F(P.INVALID_ARGUMENT,`Path has invalid escape sequence: `+t);r+=e,i+=2}else e==="`"?(o=!o,i++):e!==`.`||o?(r+=e,i++):(a(),i++)}if(a(),o)throw new F(P.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)}static emptyPath(){return new e([])}},R=class e{constructor(e){this.path=e}static fromPath(t){return new e(L.fromString(t))}static fromName(t){return new e(L.fromString(t).popFirst(5))}static empty(){return new e(L.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&L.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return L.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(t){return new e(new L(t.slice()))}};function Ei(e,t,n){if(!n)throw new F(P.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Di(e,t,n,r){if(!0===t&&!0===r)throw new F(P.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Oi(e){if(!R.isDocumentKey(e))throw new F(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function ki(e){if(R.isDocumentKey(e))throw new F(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Ai(e){return typeof e==`object`&&!!e&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function ji(e){if(e===void 0)return`undefined`;if(e===null)return`null`;if(typeof e==`string`)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e==`number`||typeof e==`boolean`)return``+e;if(typeof e==`object`){if(e instanceof Array)return`an array`;{let t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:`an object`}}return typeof e==`function`?`a function`:j(12329,{type:typeof e})}function Mi(e,t){if(`_delegate`in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new F(P.INVALID_ARGUMENT,`Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?`);{let n=ji(e);throw new F(P.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function z(e,t){let n={typeString:e};return t&&(n.value=t),n}function Ni(e,t){if(!Ai(e))throw new F(P.INVALID_ARGUMENT,`JSON must be an object`);let n;for(let r in t)if(t[r]){let i=t[r].typeString,a=`value`in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}let o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){n=`Expected '${r}' field to equal '${a.value}'`;break}}if(n)throw new F(P.INVALID_ARGUMENT,n);return!0}var Pi=-62135596800,Fi=1e6,B=class e{static now(){return e.fromMillis(Date.now())}static fromDate(t){return e.fromMillis(t.getTime())}static fromMillis(t){let n=Math.floor(t/1e3);return new e(n,Math.floor((t-1e3*n)*Fi))}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new F(P.INVALID_ARGUMENT,`Timestamp nanoseconds out of range: `+t);if(e<Pi||e>=253402300800)throw new F(P.INVALID_ARGUMENT,`Timestamp seconds out of range: `+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Fi}_compareTo(e){return this.seconds===e.seconds?I(this.nanoseconds,e.nanoseconds):I(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return`Timestamp(seconds=`+this.seconds+`, nanoseconds=`+this.nanoseconds+`)`}toJSON(){return{type:e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Ni(t,e._jsonSchema))return new e(t.seconds,t.nanoseconds)}valueOf(){let e=this.seconds-Pi;return String(e).padStart(12,`0`)+`.`+String(this.nanoseconds).padStart(9,`0`)}};B._jsonSchemaVersion=`firestore/timestamp/1.0`,B._jsonSchema={type:z(`string`,B._jsonSchemaVersion),seconds:z(`number`),nanoseconds:z(`number`)};var V=class e{static fromTimestamp(t){return new e(t)}static min(){return new e(new B(0,0))}static max(){return new e(new B(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return`SnapshotVersion(`+this.timestamp.toString()+`)`}toTimestamp(){return this.timestamp}},Ii=-1,Li=class{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}};Li.UNKNOWN_ID=-1;function Ri(e,t){let n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1;return new Bi(V.fromTimestamp(r===1e9?new B(n+1,0):new B(n,r)),R.empty(),t)}function zi(e){return new Bi(e.readTime,e.key,Ii)}var Bi=class e{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new e(V.min(),R.empty(),Ii)}static max(){return new e(V.max(),R.empty(),Ii)}};function Vi(e,t){let n=e.readTime.compareTo(t.readTime);return n===0?(n=R.comparator(e.documentKey,t.documentKey),n===0?I(e.largestBatchId,t.largestBatchId):n):n}var Hi=`The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.`,Ui=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}};async function Wi(e){if(e.code!==P.FAILED_PRECONDITION||e.message!==Hi)throw e;A(`LocalStore`,`Unexpectedly lost primary lease`)}var H=class e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(t,n){return this.callbackAttached&&j(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(((e,r)=>{this.nextCallback=n=>{this.wrapSuccess(t,n).next(e,r)},this.catchCallback=t=>{this.wrapFailure(n,t).next(e,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(t){try{let n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}wrapSuccess(t,n){return t?this.wrapUserFunction((()=>t(n))):e.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction((()=>t(n))):e.reject(n)}static resolve(t){return new e(((e,n)=>{e(t)}))}static reject(t){return new e(((e,n)=>{n(t)}))}static waitFor(t){return new e(((e,n)=>{let r=0,i=0,a=!1;t.forEach((t=>{++r,t.next((()=>{++i,a&&i===r&&e()}),(e=>n(e)))})),a=!0,i===r&&e()}))}static or(t){let n=e.resolve(!1);for(let r of t)n=n.next((t=>t?e.resolve(t):r()));return n}static forEach(e,t){let n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(t,n){return new e(((e,r)=>{let i=t.length,a=Array(i),o=0;for(let s=0;s<i;s++){let c=s;n(t[c]).next((t=>{a[c]=t,++o,o===i&&e(a)}),(e=>r(e)))}}))}static doWhile(t,n){return new e(((e,r)=>{let i=()=>{!0===t()?n().next((()=>{i()}),r):e()};i()}))}};function Gi(e){let t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(`.`).slice(0,2).join(`.`):`-1`;return Number(n)}function Ki(e){return e.name===`IndexedDbTransactionError`}var qi=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}};qi.ce=-1;var Ji=-1;function Yi(e){return e==null}function Xi(e){return e===0&&1/e==-1/0}function Zi(e){return typeof e==`number`&&Number.isInteger(e)&&!Xi(e)&&e<=2**53-1&&e>=-(2**53-1)}var Qi=``;function $i(e){let t=``;for(let n=0;n<e.length;n++)t.length>0&&(t=ta(t)),t=ea(e.get(n),t);return ta(t)}function ea(e,t){let n=t,r=e.length;for(let t=0;t<r;t++){let r=e.charAt(t);switch(r){case`\0`:n+=``;break;case Qi:n+=``;break;default:n+=r}}return n}function ta(e){return e+Qi+``}function na(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ra(e,t){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ia(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var U=class e{constructor(e,t){this.comparator=e,this.root=t||oa.EMPTY}insert(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,oa.BLACK,null,null))}remove(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,oa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){let e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(`, `)}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new aa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new aa(this.root,e,this.comparator,!1)}getReverseIterator(){return new aa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new aa(this.root,e,this.comparator,!0)}},aa=class{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},oa=class e{constructor(t,n,r,i,a){this.key=t,this.value=n,this.color=r??e.RED,this.left=i??e.EMPTY,this.right=a??e.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,a){return new e(t??this.key,n??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this,i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return e.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return 2**this.check()<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw j(43730,{key:this.key,value:this.value});if(this.right.isRed())throw j(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw j(27949);return e+(this.isRed()?0:1)}};oa.EMPTY=null,oa.RED=!0,oa.BLACK=!1,oa.EMPTY=new class{constructor(){this.size=0}get key(){throw j(57766)}get value(){throw j(16141)}get color(){throw j(16727)}get left(){throw j(29726)}get right(){throw j(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new oa(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var W=class e{constructor(e){this.comparator=e,this.data=new U(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t===void 0?this.data.getIterator():this.data.getIteratorFrom(t);n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new sa(this.data.getIterator())}getIteratorFrom(e){return new sa(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){let e=n.getNext().key,t=r.getNext().key;if(this.comparator(e,t)!==0)return!1}return!0}toArray(){let e=[];return this.forEach((t=>{e.push(t)})),e}toString(){let e=[];return this.forEach((t=>e.push(t))),`SortedSet(`+e.toString()+`)`}copy(t){let n=new e(this.comparator);return n.data=t,n}},sa=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}},ca=class e{constructor(e){this.fields=e,e.sort(Ti.comparator)}static empty(){return new e([])}unionWith(t){let n=new W(Ti.comparator);for(let e of this.fields)n=n.add(e);for(let e of t)n=n.add(e);return new e(n.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return xi(this.fields,e.fields,((e,t)=>e.isEqual(t)))}},la=class extends Error{constructor(){super(...arguments),this.name=`Base64DecodeError`}},G=class e{constructor(e){this.binaryString=e}static fromBase64String(t){return new e(function(e){try{return atob(e)}catch(e){throw typeof DOMException<`u`&&e instanceof DOMException?new la(`Invalid base64 string: `+e):e}}(t))}static fromUint8Array(t){return new e(function(e){let t=``;for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return I(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};G.EMPTY_BYTE_STRING=new G(``);var ua=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function da(e){if(M(!!e,39018),typeof e==`string`){let t=0,n=ua.exec(e);if(M(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+`000000000`).substr(0,9),t=Number(e)}let r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:K(e.seconds),nanos:K(e.nanos)}}function K(e){return typeof e==`number`?e:typeof e==`string`?Number(e):0}function fa(e){return typeof e==`string`?G.fromBase64String(e):G.fromUint8Array(e)}var pa=`server_timestamp`,ma=`__type__`,ha=`__previous_value__`,ga=`__local_write_time__`;function _a(e){return(e?.mapValue?.fields||{})[ma]?.stringValue===pa}function va(e){let t=e.mapValue.fields[ha];return _a(t)?va(t):t}function ya(e){let t=da(e.mapValue.fields[ga].timestampValue);return new B(t.seconds,t.nanos)}var ba=class{constructor(e,t,n,r,i,a,o,s,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=s,this.useFetchStreams=c,this.isUsingEmulator=l}},xa=`(default)`,Sa=class e{constructor(e,t){this.projectId=e,this.database=t||xa}static empty(){return new e(``,``)}get isDefaultDatabase(){return this.database===xa}isEqual(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}},Ca=`__type__`,wa=`__max__`,Ta={mapValue:{fields:{__type__:{stringValue:wa}}}},Ea=`__vector__`,Da=`value`;function Oa(e){return`nullValue`in e?0:`booleanValue`in e?1:`integerValue`in e||`doubleValue`in e?2:`timestampValue`in e?3:`stringValue`in e?5:`bytesValue`in e?6:`referenceValue`in e?7:`geoPointValue`in e?8:`arrayValue`in e?9:`mapValue`in e?_a(e)?4:Ga(e)?9007199254740991:Ua(e)?10:11:j(28295,{value:e})}function ka(e,t){if(e===t)return!0;let n=Oa(e);if(n!==Oa(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ya(e).isEqual(ya(t));case 3:return function(e,t){if(typeof e.timestampValue==`string`&&typeof t.timestampValue==`string`&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=da(e.timestampValue),r=da(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return fa(e.bytesValue).isEqual(fa(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return K(e.geoPointValue.latitude)===K(t.geoPointValue.latitude)&&K(e.geoPointValue.longitude)===K(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if(`integerValue`in e&&`integerValue`in t)return K(e.integerValue)===K(t.integerValue);if(`doubleValue`in e&&`doubleValue`in t){let n=K(e.doubleValue),r=K(t.doubleValue);return n===r?Xi(n)===Xi(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return xi(e.arrayValue.values||[],t.arrayValue.values||[],ka);case 10:case 11:return function(e,t){let n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(na(n)!==na(r))return!1;for(let e in n)if(n.hasOwnProperty(e)&&(r[e]===void 0||!ka(n[e],r[e])))return!1;return!0}(e,t);default:return j(52216,{left:e})}}function Aa(e,t){return(e.values||[]).find((e=>ka(e,t)))!==void 0}function ja(e,t){if(e===t)return 0;let n=Oa(e),r=Oa(t);if(n!==r)return I(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return I(e.booleanValue,t.booleanValue);case 2:return function(e,t){let n=K(e.integerValue||e.doubleValue),r=K(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Ma(e.timestampValue,t.timestampValue);case 4:return Ma(ya(e),ya(t));case 5:return _i(e.stringValue,t.stringValue);case 6:return function(e,t){let n=fa(e),r=fa(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){let n=e.split(`/`),r=t.split(`/`);for(let e=0;e<n.length&&e<r.length;e++){let t=I(n[e],r[e]);if(t!==0)return t}return I(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){let n=I(K(e.latitude),K(t.latitude));return n===0?I(K(e.longitude),K(t.longitude)):n}(e.geoPointValue,t.geoPointValue);case 9:return Na(e.arrayValue,t.arrayValue);case 10:return function(e,t){let n=e.fields||{},r=t.fields||{},i=n[Da]?.arrayValue,a=r[Da]?.arrayValue,o=I(i?.values?.length||0,a?.values?.length||0);return o===0?Na(i,a):o}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Ta.mapValue&&t===Ta.mapValue)return 0;if(e===Ta.mapValue)return 1;if(t===Ta.mapValue)return-1;let n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(let e=0;e<r.length&&e<a.length;++e){let t=_i(r[e],a[e]);if(t!==0)return t;let o=ja(n[r[e]],i[a[e]]);if(o!==0)return o}return I(r.length,a.length)}(e.mapValue,t.mapValue);default:throw j(23264,{he:n})}}function Ma(e,t){if(typeof e==`string`&&typeof t==`string`&&e.length===t.length)return I(e,t);let n=da(e),r=da(t),i=I(n.seconds,r.seconds);return i===0?I(n.nanos,r.nanos):i}function Na(e,t){let n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){let t=ja(n[e],r[e]);if(t)return t}return I(n.length,r.length)}function Pa(e){return Fa(e)}function Fa(e){return`nullValue`in e?`null`:`booleanValue`in e?``+e.booleanValue:`integerValue`in e?``+e.integerValue:`doubleValue`in e?``+e.doubleValue:`timestampValue`in e?function(e){let t=da(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):`stringValue`in e?e.stringValue:`bytesValue`in e?function(e){return fa(e).toBase64()}(e.bytesValue):`referenceValue`in e?function(e){return R.fromName(e).toString()}(e.referenceValue):`geoPointValue`in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):`arrayValue`in e?function(e){let t=`[`,n=!0;for(let r of e.values||[])n?n=!1:t+=`,`,t+=Fa(r);return t+`]`}(e.arrayValue):`mapValue`in e?function(e){let t=Object.keys(e.fields||{}).sort(),n=`{`,r=!0;for(let i of t)r?r=!1:n+=`,`,n+=`${i}:${Fa(e.fields[i])}`;return n+`}`}(e.mapValue):j(61005,{value:e})}function Ia(e){switch(Oa(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let t=va(e);return t?16+Ia(t):16;case 5:return 2*e.stringValue.length;case 6:return fa(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+Ia(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return ra(e.fields,((e,n)=>{t+=e.length+Ia(n)})),t}(e.mapValue);default:throw j(13486,{value:e})}}function La(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Ra(e){return!!e&&`integerValue`in e}function za(e){return!!e&&`arrayValue`in e}function Ba(e){return!!e&&`nullValue`in e}function Va(e){return!!e&&`doubleValue`in e&&isNaN(Number(e.doubleValue))}function Ha(e){return!!e&&`mapValue`in e}function Ua(e){return(e?.mapValue?.fields||{})[Ca]?.stringValue===Ea}function Wa(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&typeof e.timestampValue==`object`)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return ra(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Wa(n))),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Wa(e.arrayValue.values[n]);return t}return{...e}}function Ga(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===wa}var Ka=class e{constructor(e){this.value=e}static empty(){return new e({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Ha(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wa(t)}setAll(e){let t=Ti.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Wa(e):r.push(i.lastSegment())}));let i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){let t=this.field(e.popLast());Ha(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ka(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Ha(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ra(t,((t,n)=>e[t]=n));for(let t of n)delete e[t]}clone(){return new e(Wa(this.value))}};function qa(e){let t=[];return ra(e.fields,((e,n)=>{let r=new Ti([e]);if(Ha(n)){let e=qa(n.mapValue).fields;if(e.length===0)t.push(r);else for(let n of e)t.push(r.child(n))}else t.push(r)})),new ca(t)}var Ja=class e{constructor(e,t,n,r,i,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(t){return new e(t,0,V.min(),V.min(),V.min(),Ka.empty(),0)}static newFoundDocument(t,n,r,i){return new e(t,1,n,V.min(),r,i,0)}static newNoDocument(t,n){return new e(t,2,n,V.min(),V.min(),Ka.empty(),0)}static newUnknownDocument(t,n){return new e(t,3,n,V.min(),V.min(),Ka.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(V.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ka.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ka.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=V.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}},Ya=class{constructor(e,t){this.position=e,this.inclusive=t}};function Xa(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){let a=t[i],o=e.position[i];if(r=a.field.isKeyField()?R.comparator(R.fromName(o.referenceValue),n.key):ja(o,n.data.field(a.field)),a.dir===`desc`&&(r*=-1),r!==0)break}return r}function Za(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!ka(e.position[n],t.position[n]))return!1;return!0}var Qa=class{constructor(e,t=`asc`){this.field=e,this.dir=t}};function $a(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var eo=class{},q=class e extends eo{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(t,n,r){return t.isKeyField()?n===`in`||n===`not-in`?this.createKeyFieldInFilter(t,n,r):new co(t,n,r):n===`array-contains`?new po(t,r):n===`in`?new mo(t,r):n===`not-in`?new ho(t,r):n===`array-contains-any`?new go(t,r):new e(t,n,r)}static createKeyFieldInFilter(e,t,n){return t===`in`?new lo(e,n):new uo(e,n)}matches(e){let t=e.data.field(this.field);return this.op===`!=`?t!==null&&t.nullValue===void 0&&this.matchesComparison(ja(t,this.value)):t!==null&&Oa(this.value)===Oa(t)&&this.matchesComparison(ja(t,this.value))}matchesComparison(e){switch(this.op){case`<`:return e<0;case`<=`:return e<=0;case`==`:return e===0;case`!=`:return e!==0;case`>`:return e>0;case`>=`:return e>=0;default:return j(47266,{operator:this.op})}}isInequality(){return[`<`,`<=`,`>`,`>=`,`!=`,`not-in`].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},to=class e extends eo{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(t,n){return new e(t,n)}matches(e){return no(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function no(e){return e.op===`and`}function ro(e){return io(e)&&no(e)}function io(e){for(let t of e.filters)if(t instanceof to)return!1;return!0}function ao(e){if(e instanceof q)return e.field.canonicalString()+e.op.toString()+Pa(e.value);if(ro(e))return e.filters.map((e=>ao(e))).join(`,`);{let t=e.filters.map((e=>ao(e))).join(`,`);return`${e.op}(${t})`}}function oo(e,t){return e instanceof q?function(e,t){return t instanceof q&&e.op===t.op&&e.field.isEqual(t.field)&&ka(e.value,t.value)}(e,t):e instanceof to?function(e,t){return t instanceof to&&e.op===t.op&&e.filters.length===t.filters.length?e.filters.reduce(((e,n,r)=>e&&oo(n,t.filters[r])),!0):!1}(e,t):void j(19439)}function so(e){return e instanceof q?function(e){return`${e.field.canonicalString()} ${e.op} ${Pa(e.value)}`}(e):e instanceof to?function(e){return e.op.toString()+` {`+e.getFilters().map(so).join(` ,`)+`}`}(e):`Filter`}var co=class extends q{constructor(e,t,n){super(e,t,n),this.key=R.fromName(n.referenceValue)}matches(e){let t=R.comparator(e.key,this.key);return this.matchesComparison(t)}},lo=class extends q{constructor(e,t){super(e,`in`,t),this.keys=fo(`in`,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}},uo=class extends q{constructor(e,t){super(e,`not-in`,t),this.keys=fo(`not-in`,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}};function fo(e,t){return(t.arrayValue?.values||[]).map((e=>R.fromName(e.referenceValue)))}var po=class extends q{constructor(e,t){super(e,`array-contains`,t)}matches(e){let t=e.data.field(this.field);return za(t)&&Aa(t.arrayValue,this.value)}},mo=class extends q{constructor(e,t){super(e,`in`,t)}matches(e){let t=e.data.field(this.field);return t!==null&&Aa(this.value.arrayValue,t)}},ho=class extends q{constructor(e,t){super(e,`not-in`,t)}matches(e){if(Aa(this.value.arrayValue,{nullValue:`NULL_VALUE`}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Aa(this.value.arrayValue,t)}},go=class extends q{constructor(e,t){super(e,`array-contains-any`,t)}matches(e){let t=e.data.field(this.field);return!(!za(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Aa(this.value.arrayValue,e)))}},_o=class{constructor(e,t=null,n=[],r=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}};function vo(e,t=null,n=[],r=[],i=null,a=null,o=null){return new _o(e,t,n,r,i,a,o)}function yo(e){let t=N(e);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+=`|cg:`+t.collectionGroup),e+=`|f:`,e+=t.filters.map((e=>ao(e))).join(`,`),e+=`|ob:`,e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(`,`),Yi(t.limit)||(e+=`|l:`,e+=t.limit),t.startAt&&(e+=`|lb:`,e+=t.startAt.inclusive?`b:`:`a:`,e+=t.startAt.position.map((e=>Pa(e))).join(`,`)),t.endAt&&(e+=`|ub:`,e+=t.endAt.inclusive?`a:`:`b:`,e+=t.endAt.position.map((e=>Pa(e))).join(`,`)),t.Te=e}return t.Te}function bo(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!$a(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!oo(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Za(e.startAt,t.startAt)&&Za(e.endAt,t.endAt)}function xo(e){return R.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}var So=class{constructor(e,t=null,n=[],r=[],i=null,a=`F`,o=null,s=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=s,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function Co(e,t,n,r,i,a,o,s){return new So(e,t,n,r,i,a,o,s)}function wo(e){return new So(e)}function To(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function Eo(e){return e.collectionGroup!==null}function Do(e){let t=N(e);if(t.Ie===null){t.Ie=[];let e=new Set;for(let n of t.explicitOrderBy)t.Ie.push(n),e.add(n.field.canonicalString());let n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:`asc`;(function(e){let t=new W(Ti.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t})(t).forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Qa(r,n))})),e.has(Ti.keyField().canonicalString())||t.Ie.push(new Qa(Ti.keyField(),n))}return t.Ie}function Oo(e){let t=N(e);return t.Ee||=ko(t,Do(e)),t.Ee}function ko(e,t){if(e.limitType===`F`)return vo(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{let t=e.dir===`desc`?`asc`:`desc`;return new Qa(e.field,t)}));let n=e.endAt?new Ya(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Ya(e.startAt.position,e.startAt.inclusive):null;return vo(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Ao(e,t){let n=e.filters.concat([t]);return new So(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function jo(e,t,n){return new So(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Mo(e,t){return bo(Oo(e),Oo(t))&&e.limitType===t.limitType}function No(e){return`${yo(Oo(e))}|lt:${e.limitType}`}function Po(e){return`Query(target=${function(e){let t=e.path.canonicalString();return e.collectionGroup!==null&&(t+=` collectionGroup=`+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>so(e))).join(`, `)}]`),Yi(e.limit)||(t+=`, limit: `+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(`, `)}]`),e.startAt&&(t+=`, startAt: `,t+=e.startAt.inclusive?`b:`:`a:`,t+=e.startAt.position.map((e=>Pa(e))).join(`,`)),e.endAt&&(t+=`, endAt: `,t+=e.endAt.inclusive?`a:`:`b:`,t+=e.endAt.position.map((e=>Pa(e))).join(`,`)),`Target(${t})`}(Oo(e))}; limitType=${e.limitType})`}function Fo(e,t){return t.isFoundDocument()&&function(e,t){let n=t.key.path;return e.collectionGroup===null?R.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n):t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n)}(e,t)&&function(e,t){for(let n of Do(e))if(!n.field.isKeyField()&&t.data.field(n.field)===null)return!1;return!0}(e,t)&&function(e,t){for(let n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){let r=Xa(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Do(e),t)||e.endAt&&!function(e,t,n){let r=Xa(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Do(e),t))}(e,t)}function Io(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Lo(e){return(t,n)=>{let r=!1;for(let i of Do(e)){let e=Ro(i,t,n);if(e!==0)return e;r||=i.field.isKeyField()}return 0}}function Ro(e,t,n){let r=e.field.isKeyField()?R.comparator(t.key,n.key):function(e,t,n){let r=t.data.field(e),i=n.data.field(e);return r!==null&&i!==null?ja(r,i):j(42886)}(e.field,t,n);switch(e.dir){case`asc`:return r;case`desc`:return-1*r;default:return j(19790,{direction:e.dir})}}var zo=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[t,r]of n)if(this.equalsFn(t,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ra(this.inner,((t,n)=>{for(let[t,r]of n)e(t,r)}))}isEmpty(){return ia(this.inner)}size(){return this.innerSize}},Bo=new U(R.comparator);function Vo(){return Bo}var Ho=new U(R.comparator);function Uo(...e){let t=Ho;for(let n of e)t=t.insert(n.key,n);return t}function Wo(e){let t=Ho;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Go(){return qo()}function Ko(){return qo()}function qo(){return new zo((e=>e.toString()),((e,t)=>e.isEqual(t)))}var Jo=new U(R.comparator),Yo=new W(R.comparator);function J(...e){let t=Yo;for(let n of e)t=t.add(n);return t}var Xo=new W(I);function Zo(){return Xo}function Qo(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:`NaN`};if(t===1/0)return{doubleValue:`Infinity`};if(t===-1/0)return{doubleValue:`-Infinity`}}return{doubleValue:Xi(t)?`-0`:t}}function $o(e){return{integerValue:``+e}}function es(e,t){return Zi(t)?$o(t):Qo(e,t)}var ts=class{constructor(){this._=void 0}};function ns(e,t,n){return e instanceof as?function(e,t){let n={fields:{[ma]:{stringValue:pa},[ga]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&_a(t)&&(t=va(t)),t&&(n.fields[ha]=t),{mapValue:n}}(n,t):e instanceof os?ss(e,t):e instanceof cs?ls(e,t):function(e,t){let n=is(e,t),r=ds(n)+ds(e.Ae);return Ra(n)&&Ra(e.Ae)?$o(r):Qo(e.serializer,r)}(e,t)}function rs(e,t,n){return e instanceof os?ss(e,t):e instanceof cs?ls(e,t):n}function is(e,t){return e instanceof us?function(e){return Ra(e)||function(e){return!!e&&`doubleValue`in e}(e)}(t)?t:{integerValue:0}:null}var as=class extends ts{},os=class extends ts{constructor(e){super(),this.elements=e}};function ss(e,t){let n=fs(t);for(let t of e.elements)n.some((e=>ka(e,t)))||n.push(t);return{arrayValue:{values:n}}}var cs=class extends ts{constructor(e){super(),this.elements=e}};function ls(e,t){let n=fs(t);for(let t of e.elements)n=n.filter((e=>!ka(e,t)));return{arrayValue:{values:n}}}var us=class extends ts{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function ds(e){return K(e.integerValue||e.doubleValue)}function fs(e){return za(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function ps(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof os&&t instanceof os||e instanceof cs&&t instanceof cs?xi(e.elements,t.elements,ka):e instanceof us&&t instanceof us?ka(e.Ae,t.Ae):e instanceof as&&t instanceof as}(e.transform,t.transform)}var ms=class{constructor(e,t){this.version=e,this.transformResults=t}},hs=class e{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new e}static exists(t){return new e(void 0,t)}static updateTime(t){return new e(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function gs(e,t){return e.updateTime===void 0?e.exists===void 0||e.exists===t.isFoundDocument():t.isFoundDocument()&&t.version.isEqual(e.updateTime)}var _s=class{};function vs(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Os(e.key,hs.none()):new Cs(e.key,e.data,hs.none());{let n=e.data,r=Ka.empty(),i=new W(Ti.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);t===null&&e.length>1&&(e=e.popLast(),t=n.field(e)),t===null?r.delete(e):r.set(e,t),i=i.add(e)}return new ws(e.key,r,new ca(i.toArray()),hs.none())}}function ys(e,t,n){e instanceof Cs?function(e,t,n){let r=e.value.clone(),i=Es(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof ws?function(e,t,n){if(!gs(e.precondition,t))return void t.convertToUnknownDocument(n.version);let r=Es(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Ts(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function bs(e,t,n,r){return e instanceof Cs?function(e,t,n,r){if(!gs(e.precondition,t))return n;let i=e.value.clone(),a=Ds(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof ws?function(e,t,n,r){if(!gs(e.precondition,t))return n;let i=Ds(e.fieldTransforms,r,t),a=t.data;return a.setAll(Ts(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),n===null?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return gs(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function xs(e,t){let n=null;for(let r of e.fieldTransforms){let e=t.data.field(r.field),i=is(r.transform,e||null);i!=null&&(n===null&&(n=Ka.empty()),n.set(r.field,i))}return n||null}function Ss(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return e===void 0&&t===void 0||!(!e||!t)&&xi(e,t,((e,t)=>ps(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var Cs=class extends _s{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},ws=class extends _s{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}};function Ts(e){let t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){let r=e.data.field(n);t.set(n,r)}})),t}function Es(e,t,n){let r=new Map;M(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){let a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,rs(o,s,n[i]))}return r}function Ds(e,t,n){let r=new Map;for(let i of e){let e=i.transform,a=n.data.field(i.field);r.set(i.field,ns(e,a,t))}return r}var Os=class extends _s{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ks=class extends _s{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}},As=class{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let r=this.mutations[t];r.key.isEqual(e.key)&&ys(r,e,n[t])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=bs(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=bs(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=Ko();return this.mutations.forEach((r=>{let i=e.get(r.key),a=i.overlayedDocument,o=this.applyToLocalView(a,i.mutatedFields);o=t.has(r.key)?null:o;let s=vs(a,o);s!==null&&n.set(r.key,s),a.isValidDocument()||a.convertToNoDocument(V.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),J())}isEqual(e){return this.batchId===e.batchId&&xi(this.mutations,e.mutations,((e,t)=>Ss(e,t)))&&xi(this.baseMutations,e.baseMutations,((e,t)=>Ss(e,t)))}},js=class e{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(t,n,r){M(t.mutations.length===r.length,58842,{me:t.mutations.length,fe:r.length});let i=function(){return Jo}(),a=t.mutations;for(let e=0;e<a.length;e++)i=i.insert(a[e].key,r[e].version);return new e(t,n,r,i)}},Ms=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}},Ns=class{constructor(e,t){this.count=e,this.unchangedNames=t}},Y,X;function Ps(e){switch(e){case P.OK:return j(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return j(15467,{code:e})}}function Fs(e){if(e===void 0)return ni(`GRPC error has no .code`),P.UNKNOWN;switch(e){case Y.OK:return P.OK;case Y.CANCELLED:return P.CANCELLED;case Y.UNKNOWN:return P.UNKNOWN;case Y.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case Y.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case Y.INTERNAL:return P.INTERNAL;case Y.UNAVAILABLE:return P.UNAVAILABLE;case Y.UNAUTHENTICATED:return P.UNAUTHENTICATED;case Y.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case Y.NOT_FOUND:return P.NOT_FOUND;case Y.ALREADY_EXISTS:return P.ALREADY_EXISTS;case Y.PERMISSION_DENIED:return P.PERMISSION_DENIED;case Y.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case Y.ABORTED:return P.ABORTED;case Y.OUT_OF_RANGE:return P.OUT_OF_RANGE;case Y.UNIMPLEMENTED:return P.UNIMPLEMENTED;case Y.DATA_LOSS:return P.DATA_LOSS;default:return j(39323,{code:e})}}(X=Y||={})[X.OK=0]=`OK`,X[X.CANCELLED=1]=`CANCELLED`,X[X.UNKNOWN=2]=`UNKNOWN`,X[X.INVALID_ARGUMENT=3]=`INVALID_ARGUMENT`,X[X.DEADLINE_EXCEEDED=4]=`DEADLINE_EXCEEDED`,X[X.NOT_FOUND=5]=`NOT_FOUND`,X[X.ALREADY_EXISTS=6]=`ALREADY_EXISTS`,X[X.PERMISSION_DENIED=7]=`PERMISSION_DENIED`,X[X.UNAUTHENTICATED=16]=`UNAUTHENTICATED`,X[X.RESOURCE_EXHAUSTED=8]=`RESOURCE_EXHAUSTED`,X[X.FAILED_PRECONDITION=9]=`FAILED_PRECONDITION`,X[X.ABORTED=10]=`ABORTED`,X[X.OUT_OF_RANGE=11]=`OUT_OF_RANGE`,X[X.UNIMPLEMENTED=12]=`UNIMPLEMENTED`,X[X.INTERNAL=13]=`INTERNAL`,X[X.UNAVAILABLE=14]=`UNAVAILABLE`,X[X.DATA_LOSS=15]=`DATA_LOSS`;var Is=null;function Ls(){return new TextEncoder}var Rs=new zr([4294967295,4294967295],0);function zs(e){let t=Ls().encode(e),n=new Br;return n.update(t),new Uint8Array(n.digest())}function Bs(e){let t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new zr([n,r],0),new zr([i,a],0)]}var Vs=class e{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Hs(`Invalid padding: ${t}`);if(n<0||e.length>0&&this.hashCount===0)throw new Hs(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Hs(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=zr.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(zr.fromNumber(n)));return r.compare(Rs)===1&&(r=new zr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let[t,n]=Bs(zs(e));for(let e=0;e<this.hashCount;e++){let r=this.ye(t,n,e);if(!this.we(r))return!1}return!0}static create(t,n,r){let i=t%8==0?0:8-t%8,a=new e(new Uint8Array(Math.ceil(t/8)),i,n);return r.forEach((e=>a.insert(e))),a}insert(e){if(this.ge===0)return;let[t,n]=Bs(zs(e));for(let e=0;e<this.hashCount;e++){let r=this.ye(t,n,e);this.Se(r)}}Se(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}},Hs=class extends Error{constructor(){super(...arguments),this.name=`BloomFilterError`}},Us=class e{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,n,r){let i=new Map;return i.set(t,Ws.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(V.min(),i,new U(I),Vo(),J())}},Ws=class e{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new e(r,n,J(),J(),J())}},Gs=class{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}},Ks=class{constructor(e,t){this.targetId=e,this.Ce=t}},qs=class{constructor(e,t,n=G.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}},Js=class{constructor(){this.ve=0,this.Fe=Zs(),this.Me=G.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=J(),t=J(),n=J();return this.Fe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:j(38017,{changeType:i})}})),new Ws(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Zs()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){--this.ve,M(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}},Ys=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=Vo(),this.Je=Xs(),this.He=Xs(),this.Ye=new U(I)}Ze(e){for(let t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{let n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:j(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((e,n)=>{this.rt(n)&&t(n)}))}st(e){let t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){let i=r.target;if(xo(i))if(n===0){let e=new R(i.path);this.et(t,e,Ja.newNoDocument(e,V.min()))}else M(n===1,20013,{expectedCount:n});else{let r=this._t(t);if(r!==n){let n=this.ut(e),i=n?this.ct(n,e,r):1;if(i!==0){this.it(t);let e=i===2?`TargetPurposeExistenceFilterMismatchBloom`:`TargetPurposeExistenceFilterMismatch`;this.Ye=this.Ye.insert(t,e)}Is?.lt(function(e,t,n,r,i){let a={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},o=t.unchangedNames;return o&&(a.bloomFilter={applied:i===0,hashCount:o?.hashCount??0,bitmapLength:o?.bits?.bitmap?.length??0,padding:o?.bits?.padding??0,mightContain:e=>r?.mightContain(e)??!1}),a}(r,e.Ce,this.Ge.ht(),n,i))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:n=``,padding:r=0},hashCount:i=0}=t,a,o;try{a=fa(n).toUint8Array()}catch(e){if(e instanceof la)return ri(`Decoding the base64 bloom filter in existence filter failed (`+e.message+`); ignoring the bloom filter and falling back to full re-query.`),null;throw e}try{o=new Vs(a,r,i)}catch(e){return ri(e instanceof Hs?`BloomFilter error: `:`Applying bloom filter failed: `,e),null}return o.ge===0?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){let n=this.Ge.getRemoteKeysForTarget(t),r=0;return n.forEach((n=>{let i=this.Ge.ht(),a=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(a)||(this.et(t,n,null),r++)})),r}Tt(e){let t=new Map;this.ze.forEach(((n,r)=>{let i=this.ot(r);if(i){if(n.current&&xo(i.target)){let t=new R(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Ja.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}}));let n=J();this.He.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{let t=this.ot(e);return!t||t.purpose===`TargetPurposeLimboResolution`||(r=!1,!1)})),r&&(n=n.add(e))})),this.je.forEach(((t,n)=>n.setReadTime(e)));let r=new Us(e,t,this.Ye,this.je,n);return this.je=Vo(),this.Je=Xs(),this.He=Xs(),this.Ye=new U(I),r}Xe(e,t){if(!this.rt(e))return;let n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;let r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Js,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new W(I),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new W(I),this.Je=this.Je.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||A(`WatchChangeAggregator`,`Detected inactive target`,e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Js),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Xs(){return new U(R.comparator)}function Zs(){return new U(R.comparator)}var Qs=(()=>({asc:`ASCENDING`,desc:`DESCENDING`}))(),$s=(()=>({"<":`LESS_THAN`,"<=":`LESS_THAN_OR_EQUAL`,">":`GREATER_THAN`,">=":`GREATER_THAN_OR_EQUAL`,"==":`EQUAL`,"!=":`NOT_EQUAL`,"array-contains":`ARRAY_CONTAINS`,in:`IN`,"not-in":`NOT_IN`,"array-contains-any":`ARRAY_CONTAINS_ANY`}))(),ec=(()=>({and:`AND`,or:`OR`}))(),tc=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function nc(e,t){return e.useProto3Json||Yi(t)?t:{value:t}}function rc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,``).replace(`Z`,``)}.${(`000000000`+t.nanoseconds).slice(-9)}Z`:{seconds:``+t.seconds,nanos:t.nanoseconds}}function ic(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function ac(e,t){return rc(e,t.toTimestamp())}function oc(e){return M(!!e,49232),V.fromTimestamp(function(e){let t=da(e);return new B(t.seconds,t.nanos)}(e))}function sc(e,t){return cc(e,t).canonicalString()}function cc(e,t){let n=function(e){return new L([`projects`,e.projectId,`databases`,e.database])}(e).child(`documents`);return t===void 0?n:n.child(t)}function lc(e){let t=L.fromString(e);return M(Mc(t),10190,{key:t.toString()}),t}function uc(e,t){return sc(e.databaseId,t.path)}function dc(e,t){let n=lc(t);if(n.get(1)!==e.databaseId.projectId)throw new F(P.INVALID_ARGUMENT,`Tried to deserialize key from different project: `+n.get(1)+` vs `+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new F(P.INVALID_ARGUMENT,`Tried to deserialize key from different database: `+n.get(3)+` vs `+e.databaseId.database);return new R(hc(n))}function fc(e,t){return sc(e.databaseId,t)}function pc(e){let t=lc(e);return t.length===4?L.emptyPath():hc(t)}function mc(e){return new L([`projects`,e.databaseId.projectId,`databases`,e.databaseId.database]).canonicalString()}function hc(e){return M(e.length>4&&e.get(4)===`documents`,29091,{key:e.toString()}),e.popFirst(5)}function gc(e,t,n){return{name:uc(e,t),fields:n.value.mapValue.fields}}function _c(e,t){let n;if(`targetChange`in t){t.targetChange;let r=function(e){return e===`NO_CHANGE`?0:e===`ADD`?1:e===`REMOVE`?2:e===`CURRENT`?3:e===`RESET`?4:j(39313,{state:e})}(t.targetChange.targetChangeType||`NO_CHANGE`),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(M(t===void 0||typeof t==`string`,58123),G.fromBase64String(t||``)):(M(t===void 0||t instanceof Buffer||t instanceof Uint8Array,16193),G.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause;n=new qs(r,i,a,o&&function(e){return new F(e.code===void 0?P.UNKNOWN:Fs(e.code),e.message||``)}(o)||null)}else if(`documentChange`in t){t.documentChange;let r=t.documentChange;r.document,r.document.name,r.document.updateTime;let i=dc(e,r.document.name),a=oc(r.document.updateTime),o=r.document.createTime?oc(r.document.createTime):V.min(),s=new Ka({mapValue:{fields:r.document.fields}}),c=Ja.newFoundDocument(i,a,o,s);n=new Gs(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if(`documentDelete`in t){t.documentDelete;let r=t.documentDelete;r.document;let i=dc(e,r.document),a=r.readTime?oc(r.readTime):V.min(),o=Ja.newNoDocument(i,a);n=new Gs([],r.removedTargetIds||[],o.key,o)}else if(`documentRemove`in t){t.documentRemove;let r=t.documentRemove;r.document;let i=dc(e,r.document);n=new Gs([],r.removedTargetIds||[],i,null)}else{if(!(`filter`in t))return j(11601,{Rt:t});{t.filter;let e=t.filter;e.targetId;let{count:r=0,unchangedNames:i}=e,a=new Ns(r,i),o=e.targetId;n=new Ks(o,a)}}return n}function vc(e,t){let n;if(t instanceof Cs)n={update:gc(e,t.key,t.value)};else if(t instanceof Os)n={delete:uc(e,t.key)};else if(t instanceof ws)n={update:gc(e,t.key,t.data),updateMask:jc(t.fieldMask)};else{if(!(t instanceof ks))return j(16599,{Vt:t.type});n={verify:uc(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){let n=t.transform;if(n instanceof as)return{fieldPath:t.field.canonicalString(),setToServerValue:`REQUEST_TIME`};if(n instanceof os)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof cs)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof us)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw j(20930,{transform:t.transform})}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return t.updateTime===void 0?t.exists===void 0?j(27497):{exists:t.exists}:{updateTime:ac(e,t.updateTime)}}(e,t.precondition)),n}function yc(e,t){return e&&e.length>0?(M(t!==void 0,14353),e.map((e=>function(e,t){let n=e.updateTime?oc(e.updateTime):oc(t);return n.isEqual(V.min())&&(n=oc(t)),new ms(n,e.transformResults||[])}(e,t)))):[]}function bc(e,t){return{documents:[fc(e,t.path)]}}function xc(e,t){let n={structuredQuery:{}},r=t.path,i;t.collectionGroup===null?(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]):(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]),n.parent=fc(e,i);let a=function(e){if(e.length!==0)return Ac(to.create(e,`and`))}(t.filters);a&&(n.structuredQuery.where=a);let o=function(e){if(e.length!==0)return e.map((e=>function(e){return{field:Oc(e.field),direction:Tc(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);let s=nc(e,t.limit);return s!==null&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function Sc(e){let t=pc(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){M(r===1,65062);let e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){let t=wc(e);return t instanceof to&&ro(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new Qa(kc(e.field),function(e){switch(e){case`ASCENDING`:return`asc`;case`DESCENDING`:return`desc`;default:return}}(e.direction))}(e)))}(n.orderBy));let s=null;n.limit&&(s=function(e){let t;return t=typeof e==`object`?e.value:e,Yi(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){let t=!!e.before;return new Ya(e.values||[],t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){let t=!e.before;return new Ya(e.values||[],t)}(n.endAt)),Co(t,i,o,a,s,`F`,c,l)}function Cc(e,t){let n=function(e){switch(e){case`TargetPurposeListen`:return null;case`TargetPurposeExistenceFilterMismatch`:return`existence-filter-mismatch`;case`TargetPurposeExistenceFilterMismatchBloom`:return`existence-filter-mismatch-bloom`;case`TargetPurposeLimboResolution`:return`limbo-document`;default:return j(28987,{purpose:e})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function wc(e){return e.unaryFilter===void 0?e.fieldFilter===void 0?e.compositeFilter===void 0?j(30097,{filter:e}):function(e){return to.create(e.compositeFilter.filters.map((e=>wc(e))),function(e){switch(e){case`AND`:return`and`;case`OR`:return`or`;default:return j(1026)}}(e.compositeFilter.op))}(e):function(e){return q.create(kc(e.fieldFilter.field),function(e){switch(e){case`EQUAL`:return`==`;case`NOT_EQUAL`:return`!=`;case`GREATER_THAN`:return`>`;case`GREATER_THAN_OR_EQUAL`:return`>=`;case`LESS_THAN`:return`<`;case`LESS_THAN_OR_EQUAL`:return`<=`;case`ARRAY_CONTAINS`:return`array-contains`;case`IN`:return`in`;case`NOT_IN`:return`not-in`;case`ARRAY_CONTAINS_ANY`:return`array-contains-any`;case`OPERATOR_UNSPECIFIED`:return j(58110);default:return j(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):function(e){switch(e.unaryFilter.op){case`IS_NAN`:let t=kc(e.unaryFilter.field);return q.create(t,`==`,{doubleValue:NaN});case`IS_NULL`:let n=kc(e.unaryFilter.field);return q.create(n,`==`,{nullValue:`NULL_VALUE`});case`IS_NOT_NAN`:let r=kc(e.unaryFilter.field);return q.create(r,`!=`,{doubleValue:NaN});case`IS_NOT_NULL`:let i=kc(e.unaryFilter.field);return q.create(i,`!=`,{nullValue:`NULL_VALUE`});case`OPERATOR_UNSPECIFIED`:return j(61313);default:return j(60726)}}(e)}function Tc(e){return Qs[e]}function Ec(e){return $s[e]}function Dc(e){return ec[e]}function Oc(e){return{fieldPath:e.canonicalString()}}function kc(e){return Ti.fromServerFormat(e.fieldPath)}function Ac(e){return e instanceof q?function(e){if(e.op===`==`){if(Va(e.value))return{unaryFilter:{field:Oc(e.field),op:`IS_NAN`}};if(Ba(e.value))return{unaryFilter:{field:Oc(e.field),op:`IS_NULL`}}}else if(e.op===`!=`){if(Va(e.value))return{unaryFilter:{field:Oc(e.field),op:`IS_NOT_NAN`}};if(Ba(e.value))return{unaryFilter:{field:Oc(e.field),op:`IS_NOT_NULL`}}}return{fieldFilter:{field:Oc(e.field),op:Ec(e.op),value:e.value}}}(e):e instanceof to?function(e){let t=e.getFilters().map((e=>Ac(e)));return t.length===1?t[0]:{compositeFilter:{op:Dc(e.op),filters:t}}}(e):j(54877,{filter:e})}function jc(e){let t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Mc(e){return e.length>=4&&e.get(0)===`projects`&&e.get(2)===`databases`}var Nc=class e{constructor(e,t,n,r,i=V.min(),a=V.min(),o=G.EMPTY_BYTE_STRING,s=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=s}withSequenceNumber(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}},Pc=class{constructor(e){this.yt=e}};function Fc(e){let t=Sc({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType===`LAST`?jo(t,t.limit,`L`):t}var Ic=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if(`nullValue`in e)this.Ft(t,5);else if(`booleanValue`in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if(`integerValue`in e)this.Ft(t,15),t.Mt(K(e.integerValue));else if(`doubleValue`in e){let n=K(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Xi(n)?t.Mt(0):t.Mt(n))}else if(`timestampValue`in e){let n=e.timestampValue;this.Ft(t,20),typeof n==`string`&&(n=da(n)),t.xt(`${n.seconds||``}`),t.Mt(n.nanos||0)}else if(`stringValue`in e)this.Ot(e.stringValue,t),this.Nt(t);else if(`bytesValue`in e)this.Ft(t,30),t.Bt(fa(e.bytesValue)),this.Nt(t);else if(`referenceValue`in e)this.Lt(e.referenceValue,t);else if(`geoPointValue`in e){let n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else `mapValue`in e?Ga(e)?this.Ft(t,2**53-1):Ua(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):`arrayValue`in e?(this.Qt(e.arrayValue,t),this.Nt(t)):j(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let n=e.fields||{};this.Ft(t,55);for(let e of Object.keys(n))this.Ot(e,t),this.Ct(n[e],t)}kt(e,t){let n=e.fields||{};this.Ft(t,53);let r=Da,i=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(K(i)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){let n=e.values||[];this.Ft(t,50);for(let e of n)this.Ct(e,t)}Lt(e,t){this.Ft(t,37),R.fromName(e).path.forEach((e=>{this.Ft(t,60),this.Ut(e,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};Ic.Kt=new Ic;var Lc=class{constructor(){this.Cn=new Rc}addToCollectionParentIndex(e,t){return this.Cn.add(t),H.resolve()}getCollectionParents(e,t){return H.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return H.resolve()}deleteFieldIndex(e,t){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,t){return H.resolve()}getDocumentsMatchingTarget(e,t){return H.resolve(null)}getIndexType(e,t){return H.resolve(0)}getFieldIndexes(e,t){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,t){return H.resolve(Bi.min())}getMinOffsetFromCollectionGroup(e,t){return H.resolve(Bi.min())}updateCollectionGroup(e,t,n){return H.resolve()}updateIndexEntries(e,t){return H.resolve()}},Rc=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new W(L.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new W(L.comparator)).toArray()}};new Uint8Array;var zc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Bc=41943040,Vc=class e{static withCacheSize(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}};Vc.DEFAULT_COLLECTION_PERCENTILE=10,Vc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vc.DEFAULT=new Vc(Bc,Vc.DEFAULT_COLLECTION_PERCENTILE,Vc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vc.DISABLED=new Vc(-1,0,0);var Hc=class e{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new e(0)}static cr(){return new e(-1)}},Uc=`LruGarbageCollector`,Wc=1048576;function Gc([e,t],[n,r]){let i=I(e,n);return i===0?I(t,r):i}var Kc=class{constructor(e){this.Ir=e,this.buffer=new W(Gc),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();Gc(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}},qc=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&=(this.Rr.cancel(),null)}get started(){return this.Rr!==null}Vr(e){A(Uc,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay(`lru_garbage_collection`,e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Ki(e)?A(Uc,`Ignoring IndexedDB error during garbage collection: `,e):await Wi(e)}await this.Vr(3e5)}))}},Jc=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(t===0)return H.resolve(qi.ce);let n=new Kc(t);return this.mr.forEachTarget(e,(e=>n.Ar(e.sequenceNumber))).next((()=>this.mr.pr(e,(e=>n.Ar(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(A(`LruGarbageCollector`,`Garbage collection skipped; disabled`),H.resolve(zc)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(A(`LruGarbageCollector`,`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zc):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,a,o,s,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(A(`LruGarbageCollector`,`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,s=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),ti()<=T.DEBUG&&A(`LruGarbageCollector`,`LRU Garbage Collection\n\tCounted targets in ${a-l}ms\n\tDetermined least recently used ${r} in `+(o-a)+`ms
\tRemoved ${i} targets in `+(s-o)+`ms
\tRemoved ${e} documents in `+(c-s)+`ms
Total Duration: ${c-l}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}};function Yc(e,t){return new Jc(e,t)}var Xc=class{constructor(){this.changes=new zo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ja.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n===void 0?this.getFromCache(e,t):H.resolve(n)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}},Zc=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}},Qc=class{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(n!==null&&bs(n.mutation,e,ca.empty(),B.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,J()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=J()){let r=Go();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Uo();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){let n=Go();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,J())))}populateOverlays(e,t,n){let r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Vo(),a=qo(),o=function(){return qo()}();return t.forEach(((e,t)=>{let o=n.get(t.key);r.has(t.key)&&(o===void 0||o.mutation instanceof ws)?i=i.insert(t.key,t):o===void 0?a.set(t.key,ca.empty()):(a.set(t.key,o.mutation.getFieldMask()),bs(o.mutation,t,o.mutation.getFieldMask(),B.now()))})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>a.set(e,t))),t.forEach(((e,t)=>o.set(e,new Zc(t,a.get(e)??null)))),o)))}recalculateAndSaveOverlays(e,t){let n=qo(),r=new U(((e,t)=>e-t)),i=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(let i of e)i.keys().forEach((e=>{let a=t.get(e);if(a===null)return;let o=n.get(e)||ca.empty();o=i.applyToLocalView(a,o),n.set(e,o);let s=(r.get(i.batchId)||J()).add(e);r=r.insert(i.batchId,s)}))})).next((()=>{let a=[],o=r.getReverseIterator();for(;o.hasNext();){let r=o.getNext(),s=r.key,c=r.value,l=Ko();c.forEach((e=>{if(!i.has(e)){let r=vs(t.get(e),n.get(e));r!==null&&l.set(e,r),i=i.add(e)}})),a.push(this.documentOverlayCache.saveOverlays(e,s,l))}return H.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return R.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Eo(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{let a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):H.resolve(Go()),o=Ii,s=i;return a.next((t=>H.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?H.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{s=s.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,s,t,J()))).next((e=>({batchId:o,changes:Wo(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new R(t)).next((e=>{let t=Uo();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){let i=t.collectionGroup,a=Uo();return this.indexManager.getCollectionParents(e,i).next((o=>H.forEach(o,(o=>{let s=function(e,t){return new So(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,s,n,r).next((e=>{e.forEach(((e,t)=>{a=a.insert(e,t)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{let r=n.getKey();e.get(r)===null&&(e=e.insert(r,Ja.newInvalidDocument(r)))}));let n=Uo();return e.forEach(((e,r)=>{let a=i.get(e);a!==void 0&&bs(a.mutation,r,ca.empty(),B.now()),Fo(t,r)&&(n=n.insert(e,r))})),n}))}},$c=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return H.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:oc(e.createTime)}}(t)),H.resolve()}getNamedQuery(e,t){return H.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Fc(e.bundledQuery),readTime:oc(e.readTime)}}(t)),H.resolve()}},el=class{constructor(){this.overlays=new U(R.comparator),this.qr=new Map}getOverlay(e,t){return H.resolve(this.overlays.get(t))}getOverlays(e,t){let n=Go();return H.forEach(t,(t=>this.getOverlay(e,t).next((e=>{e!==null&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.St(e,t,r)})),H.resolve()}removeOverlaysForBatchId(e,t,n){let r=this.qr.get(n);return r!==void 0&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.qr.delete(n)),H.resolve()}getOverlaysForCollection(e,t,n){let r=Go(),i=t.length+1,a=new R(t.child(``)),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){let e=o.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return H.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new U(((e,t)=>e-t)),a=this.overlays.getIterator();for(;a.hasNext();){let e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);t===null&&(t=Go(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let o=Go(),s=i.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return H.resolve(o)}St(e,t,n){let r=this.overlays.get(n.key);if(r!==null){let e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Ms(t,n));let i=this.qr.get(t);i===void 0&&(i=J(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}},tl=class{constructor(){this.sessionToken=G.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,H.resolve()}},nl=class{constructor(){this.Qr=new W(Z.$r),this.Ur=new W(Z.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let n=new Z(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Gr(new Z(e,t))}zr(e,t){e.forEach((e=>this.removeReference(e,t)))}jr(e){let t=new R(new L([])),n=new Z(t,e),r=new Z(t,e+1),i=[];return this.Ur.forEachInRange([n,r],(e=>{this.Gr(e),i.push(e.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new R(new L([])),n=new Z(t,e),r=new Z(t,e+1),i=J();return this.Ur.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){let t=new Z(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},Z=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return R.comparator(e.key,t.key)||I(e.Yr,t.Yr)}static Kr(e,t){return I(e.Yr,t.Yr)||R.comparator(e.key,t.key)}},rl=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new W(Z.$r)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){let i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new As(i,t,n,r);this.mutationQueue.push(a);for(let t of r)this.Zr=this.Zr.add(new Z(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return H.resolve(a)}lookupMutationBatch(e,t){return H.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=this.ei(n),i=r<0?0:r;return H.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?Ji:this.tr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new Z(t,0),r=new Z(t,1/0),i=[];return this.Zr.forEachInRange([n,r],(e=>{let t=this.Xr(e.Yr);i.push(t)})),H.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new W(I);return t.forEach((e=>{let t=new Z(e,0),r=new Z(e,1/0);this.Zr.forEachInRange([t,r],(e=>{n=n.add(e.Yr)}))})),H.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,i=n;R.isDocumentKey(i)||(i=i.child(``));let a=new Z(new R(i),0),o=new W(I);return this.Zr.forEachWhile((e=>{let t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)}),a),H.resolve(this.ti(o))}ti(e){let t=[];return e.forEach((e=>{let n=this.Xr(e);n!==null&&t.push(n)})),t}removeMutationBatch(e,t){M(this.ni(t.batchId,`removed`)===0,55003),this.mutationQueue.shift();let n=this.Zr;return H.forEach(t.mutations,(r=>{let i=new Z(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){let n=new Z(t,0),r=this.Zr.firstAfterOrEqual(n);return H.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}},il=class{constructor(e){this.ri=e,this.docs=function(){return new U(R.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return H.resolve(n?n.document.mutableCopy():Ja.newInvalidDocument(t))}getEntries(e,t){let n=Vo();return t.forEach((e=>{let t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ja.newInvalidDocument(e))})),H.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Vo(),a=t.path,o=new R(a.child(`__id-9223372036854775808__`)),s=this.docs.getIteratorFrom(o);for(;s.hasNext();){let{key:e,value:{document:o}}=s.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||Vi(zi(o),n)<=0||(r.has(o.key)||Fo(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return H.resolve(i)}getAllFromCollectionGroup(e,t,n,r){j(9500)}ii(e,t){return H.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new al(this)}getSize(e){return H.resolve(this.size)}},al=class extends Xc{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)})),H.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}},ol=class{constructor(e){this.persistence=e,this.si=new zo((e=>yo(e)),bo),this.lastRemoteSnapshotVersion=V.min(),this.highestTargetId=0,this.oi=0,this._i=new nl,this.targetCount=0,this.ai=Hc.ur()}forEachTarget(e,t){return this.si.forEach(((e,n)=>t(n))),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),H.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new Hc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,H.resolve()}updateTargetData(e,t){return this.Pr(t),H.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),--this.targetCount,H.resolve()}removeTargets(e,t,n){let r=0,i=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),H.waitFor(i).next((()=>r))}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,t){let n=this.si.get(t)||null;return H.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),H.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);let r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),H.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),H.resolve()}getMatchingKeysForTargetId(e,t){let n=this._i.Hr(t);return H.resolve(n)}containsKey(e,t){return H.resolve(this._i.containsKey(t))}},sl=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new qi(0),this.li=!1,this.li=!0,this.hi=new tl,this.referenceDelegate=e(this),this.Pi=new ol(this),this.indexManager=new Lc,this.remoteDocumentCache=function(e){return new il(e)}((e=>this.referenceDelegate.Ti(e))),this.serializer=new Pc(t),this.Ii=new $c(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new el,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new rl(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){A(`MemoryPersistence`,`Starting transaction:`,e);let r=new cl(this.ci.next());return this.referenceDelegate.Ei(),n(r).next((e=>this.referenceDelegate.di(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ai(e,t){return H.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}},cl=class extends Ui{constructor(e){super(),this.currentSequenceNumber=e}},ll=class e{constructor(e){this.persistence=e,this.Ri=new nl,this.Vi=null}static mi(t){return new e(t)}get fi(){if(this.Vi)return this.Vi;throw j(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),H.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),H.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),H.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((e=>this.fi.add(e.toString())));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.fi.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.fi,(n=>{let r=R.fromPath(n);return this.gi(e,r).next((e=>{e||t.removeEntry(r,V.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return H.or([()=>H.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},ul=class e{constructor(e,t){this.persistence=e,this.pi=new zo((e=>$i(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=Yc(this,t)}static mi(t,n){return new e(t,n)}Ei(){}di(e){return H.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}wr(e){let t=0;return this.pr(e,(e=>{t++})).next((()=>t))}pr(e,t){return H.forEach(this.pi,((n,r)=>this.br(e,n,r).next((e=>e?H.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0,r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,(r=>this.br(e,r,t).next((e=>{e||(n++,i.removeEntry(r,V.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),H.resolve()}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),H.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),H.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),H.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ia(e.data.value)),t}br(e,t,n){return H.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.pi.get(t);return H.resolve(e!==void 0&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}},dl=class e{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(t,n){let r=J(),i=J();for(let e of n.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new e(t,n.fromCache,r,i)}},fl=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}},pl=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Bt()?8:Gi(Rt())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){let i={result:null};return this.ys(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ws(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;let n=new fl;return this.Ss(e,t,n).next((r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)}))})).next((()=>i.result))}bs(e,t,n,r){return n.documentReadCount<this.fs?(ti()<=T.DEBUG&&A(`QueryEngine`,`SDK will not create cache indexes for query:`,Po(t),`since it only creates cache indexes for collection contains`,`more than or equal to`,this.fs,`documents`),H.resolve()):(ti()<=T.DEBUG&&A(`QueryEngine`,`Query:`,Po(t),`scans`,n.documentReadCount,`local documents and returns`,r,`documents as results.`),n.documentReadCount>this.gs*r?(ti()<=T.DEBUG&&A(`QueryEngine`,`The SDK decides to create cache indexes for query:`,Po(t),`as using cache indexes may help improve performance.`),this.indexManager.createTargetIndexes(e,Oo(t))):H.resolve())}ys(e,t){if(To(t))return H.resolve(null);let n=Oo(t);return this.indexManager.getIndexType(e,n).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=jo(t,null,`F`),n=Oo(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{let i=J(...r);return this.ps.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{let a=this.Ds(t,r);return this.Cs(t,a,i,n.readTime)?this.ys(e,jo(t,null,`F`)):this.vs(e,a,t,n)}))))})))))}ws(e,t,n,r){return To(t)||r.isEqual(V.min())?H.resolve(null):this.ps.getDocuments(e,n).next((i=>{let a=this.Ds(t,i);return this.Cs(t,a,n,r)?H.resolve(null):(ti()<=T.DEBUG&&A(`QueryEngine`,`Re-using previous result from %s to execute query: %s`,r.toString(),Po(t)),this.vs(e,a,t,Ri(r,Ii)).next((e=>e)))}))}Ds(e,t){let n=new W(Lo(e));return t.forEach(((t,r)=>{Fo(e,r)&&(n=n.add(r))})),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let i=e.limitType===`F`?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return ti()<=T.DEBUG&&A(`QueryEngine`,`Using full collection scan to execute query:`,Po(t)),this.ps.getDocumentsMatchingQuery(e,t,Bi.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}},ml=`LocalStore`,hl=3e8,gl=class{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new U(I),this.xs=new zo((e=>yo(e)),bo),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Qc(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction(`Collect garbage`,`readwrite-primary`,(t=>e.collect(t,this.Ms)))}};function _l(e,t,n,r){return new gl(e,t,n,r)}async function vl(e,t){let n=N(e);return await n.persistence.runTransaction(`Handle user change`,`readonly`,(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{let i=[],a=[],o=J();for(let e of r){i.push(e.batchId);for(let t of e.mutations)o=o.add(t.key)}for(let e of t){a.push(e.batchId);for(let t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({Ls:e,removedBatchIds:i,addedBatchIds:a})))}))}))}function yl(e,t){let n=N(e);return n.persistence.runTransaction(`Acknowledge batch`,`readwrite-primary`,(e=>{let r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){let i=n.batch,a=i.keys(),o=H.resolve();return a.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{let a=n.docVersions.get(e);M(a!==null,48541),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=J();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}function bl(e){let t=N(e);return t.persistence.runTransaction(`Get last remote snapshot version`,`readonly`,(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function xl(e,t){let n=N(e),r=t.snapshotVersion,i=n.Ms;return n.persistence.runTransaction(`Apply remote event`,`readwrite-primary`,(e=>{let a=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;let o=[];t.targetChanges.forEach(((a,s)=>{let c=i.get(s);if(!c)return;o.push(n.Pi.removeMatchingKeys(e,a.removedDocuments,s).next((()=>n.Pi.addMatchingKeys(e,a.addedDocuments,s))));let l=c.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.get(s)===null?a.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(a.resumeToken,r)):l=l.withResumeToken(G.EMPTY_BYTE_STRING,V.min()).withLastLimboFreeSnapshotVersion(V.min()),i=i.insert(s,l),function(e,t,n){return e.resumeToken.approximateByteSize()===0||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=hl?!0:n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,a)&&o.push(n.Pi.updateTargetData(e,l))}));let s=Vo(),c=J();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Sl(e,a,t.documentUpdates).next((e=>{s=e.ks,c=e.qs}))),!r.isEqual(V.min())){let t=n.Pi.getLastRemoteSnapshotVersion(e).next((t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return H.waitFor(o).next((()=>a.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,s,c))).next((()=>s))})).then((e=>(n.Ms=i,e)))}function Sl(e,t,n){let r=J(),i=J();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Vo();return n.forEach(((n,a)=>{let o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(V.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||a.version.compareTo(o.version)===0&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):A(ml,`Ignoring outdated watch update for `,n,`. Current version:`,o.version,` Watch version:`,a.version)})),{ks:r,qs:i}}))}function Cl(e,t){let n=N(e);return n.persistence.runTransaction(`Get next mutation batch`,`readonly`,(e=>(t===void 0&&(t=Ji),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function wl(e,t){let n=N(e);return n.persistence.runTransaction(`Allocate target`,`readwrite`,(e=>{let r;return n.Pi.getTargetData(e,t).next((i=>i?(r=i,H.resolve(r)):n.Pi.allocateTargetId(e).next((i=>(r=new Nc(t,i,`TargetPurposeListen`,e.currentSequenceNumber),n.Pi.addTargetData(e,r).next((()=>r)))))))})).then((e=>{let r=n.Ms.get(e.targetId);return(r===null||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e}))}async function Tl(e,t,n){let r=N(e),i=r.Ms.get(t),a=n?`readwrite`:`readwrite-primary`;try{n||await r.persistence.runTransaction(`Release target`,a,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Ki(e))throw e;A(ml,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function El(e,t,n){let r=N(e),i=V.min(),a=J();return r.persistence.runTransaction(`Execute query`,`readwrite`,(e=>function(e,t,n){let r=N(e),i=r.xs.get(n);return i===void 0?r.Pi.getTargetData(t,n):H.resolve(r.Ms.get(i))}(r,e,Oo(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next((e=>{a=e}))})).next((()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:V.min(),n?a:J()))).next((e=>(Dl(r,Io(t),e),{documents:e,Qs:a})))))}function Dl(e,t,n){let r=e.Os.get(t)||V.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Os.set(t,r)}var Ol=class{constructor(){this.activeTargetIds=Zo()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},kl=class{constructor(){this.Mo=new Ol,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||`not-current`}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ol,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}},Al=class{Oo(e){}shutdown(){}},jl=`ConnectivityMonitor`,Ml=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener(`online`,this.No),window.removeEventListener(`offline`,this.Lo)}Qo(){window.addEventListener(`online`,this.No),window.addEventListener(`offline`,this.Lo)}Bo(){A(jl,`Network connectivity changed: AVAILABLE`);for(let e of this.qo)e(0)}ko(){A(jl,`Network connectivity changed: UNAVAILABLE`);for(let e of this.qo)e(1)}static v(){return typeof window<`u`&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}},Nl=null;function Pl(){return Nl===null?Nl=function(){return 268435456+Math.round(2147483648*Math.random())}():Nl++,`0x`+Nl.toString(16)}var Fl=`RestConnection`,Il={BatchGetDocuments:`batchGet`,Commit:`commit`,RunQuery:`runQuery`,RunAggregationQuery:`runAggregationQuery`},Ll=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?`https`:`http`,n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+`://`+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===xa?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){let a=Pl(),o=this.zo(e,t.toUriEncodedString());A(Fl,`Sending RPC '${e}' ${a}:`,o,n);let s={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(s,r,i);let{host:c}=new URL(o),l=At(c);return this.Jo(e,o,s,n,l).then((t=>(A(Fl,`Received RPC '${e}' ${a}: `,t),t)),(t=>{throw ri(Fl,`RPC '${e}' ${a} failed with error: `,t,`url: `,o,`request:`,n),t}))}Ho(e,t,n,r,i,a){return this.Go(e,t,n,r,i)}jo(e,t,n){e[`X-Goog-Api-Client`]=function(){return`gl-js/ fire/`+$r}(),e[`Content-Type`]=`text/plain`,this.databaseInfo.appId&&(e[`X-Firebase-GMPID`]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}zo(e,t){let n=Il[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}},Rl=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}},Q=`WebChannelConnection`,zl=class extends Ll{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){let a=Pl();return new Promise(((i,o)=>{let s=new Ur;s.setWithCredentials(!0),s.listenOnce(Gr.COMPLETE,(()=>{try{switch(s.getLastErrorCode()){case Kr.NO_ERROR:let t=s.getResponseJson();A(Q,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(t)),i(t);break;case Kr.TIMEOUT:A(Q,`RPC '${e}' ${a} timed out`),o(new F(P.DEADLINE_EXCEEDED,`Request time out`));break;case Kr.HTTP_ERROR:let n=s.getStatus();if(A(Q,`RPC '${e}' ${a} failed with status:`,n,`response text:`,s.getResponseText()),n>0){let e=s.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=e?.error;t&&t.status&&t.message?o(new F(function(e){let t=e.toLowerCase().replace(/_/g,`-`);return Object.values(P).indexOf(t)>=0?t:P.UNKNOWN}(t.status),t.message)):o(new F(P.UNKNOWN,`Server responded with status `+s.getStatus()))}else o(new F(P.UNAVAILABLE,`Connection failed.`));break;default:j(9055,{l_:e,streamId:a,h_:s.getLastErrorCode(),P_:s.getLastError()})}}finally{A(Q,`RPC '${e}' ${a} completed.`)}}));let c=JSON.stringify(r);A(Q,`RPC '${e}' ${a} sending request:`,r),s.send(t,`POST`,c,n,15)}))}T_(e,t,n){let r=Pl(),i=[this.Uo,`/`,`google.firestore.v1.Firestore`,`/`,e,`/channel`],a=Xr(),o=Yr(),s={httpSessionIdParam:`gsessionid`,initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(s.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(s.useFetchStreams=!0),this.jo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;let l=i.join(``);A(Q,`Creating RPC '${e}' stream ${r}: ${l}`,s);let u=a.createWebChannel(l,s);this.I_(u);let d=!1,f=!1,p=new Rl({Yo:t=>{f?A(Q,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||=(A(Q,`Opening RPC '${e}' stream ${r} transport.`),u.open(),!0),A(Q,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Zo:()=>u.close()}),m=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return m(u,Wr.EventType.OPEN,(()=>{f||(A(Q,`RPC '${e}' stream ${r} transport opened.`),p.o_())})),m(u,Wr.EventType.CLOSE,(()=>{f||(f=!0,A(Q,`RPC '${e}' stream ${r} transport closed`),p.a_(),this.E_(u))})),m(u,Wr.EventType.ERROR,(t=>{f||(f=!0,ri(Q,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,`Message:`,t.message),p.a_(new F(P.UNAVAILABLE,`The operation could not be completed`)))})),m(u,Wr.EventType.MESSAGE,(t=>{if(!f){let n=t.data[0];M(!!n,16349);let i=n,a=i?.error||i[0]?.error;if(a){A(Q,`RPC '${e}' stream ${r} received error:`,a);let t=a.status,n=function(e){let t=Y[e];if(t!==void 0)return Fs(t)}(t),i=a.message;n===void 0&&(n=P.INTERNAL,i=`Unknown error status: `+t+` with message `+a.message),f=!0,p.a_(new F(n,i)),u.close()}else A(Q,`RPC '${e}' stream ${r} received:`,n),p.u_(n)}})),m(o,Jr.STAT_EVENT,(t=>{t.stat===qr.PROXY?A(Q,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===qr.NOPROXY&&A(Q,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.__()}),0),p}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}};function Bl(){return typeof document<`u`?document:null}function Vl(e){return new tc(e,!0)}var Hl=class{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&A(`ExponentialBackoff`,`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}},Ul=`PersistentStream`,Wl=class{constructor(e,t,n,r,i,a,o,s){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=s,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Hl(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state===4?this.N_():this.auth()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&=(this.C_.cancel(),null)}U_(){this.v_&&=(this.v_.cancel(),null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e===4?t&&t.code===P.RESOURCE_EXHAUSTED?(ni(t.toString()),ni(`Using maximum backoff delay to prevent overloading the backend.`),this.M_.g_()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()):this.M_.reset(),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.D_===t&&this.G_(e,n)}),(t=>{e((()=>{let e=new F(P.UNKNOWN,`Fetching auth token failed: `+t.message);return this.z_(e)}))}))}G_(e,t){let n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((e=>{n((()=>this.z_(e)))})),this.stream.onMessage((e=>{n((()=>++this.F_==1?this.J_(e):this.onNext(e)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return A(Ul,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(A(Ul,`stream callback skipped by getCloseGuardedDispatcher.`),Promise.resolve())))}}},Gl=class extends Wl{constructor(e,t,n,r,i,a){super(e,`listen_stream_connection_backoff`,`listen_stream_idle`,`health_check_timeout`,t,n,r,a),this.serializer=i}j_(e,t){return this.connection.T_(`Listen`,e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=_c(this.serializer,e),n=function(e){if(!(`targetChange`in e))return V.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length?V.min():t.readTime?oc(t.readTime):V.min()}(e);return this.listener.H_(t,n)}Y_(e){let t={};t.database=mc(this.serializer),t.addTarget=function(e,t){let n,r=t.target;if(n=xo(r)?{documents:bc(e,r)}:{query:xc(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=ic(e,t.resumeToken);let r=nc(e,t.expectedCount);r!==null&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(V.min())>0){n.readTime=rc(e,t.snapshotVersion.toTimestamp());let r=nc(e,t.expectedCount);r!==null&&(n.expectedCount=r)}return n}(this.serializer,e);let n=Cc(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){let t={};t.database=mc(this.serializer),t.removeTarget=e,this.q_(t)}},Kl=class extends Wl{constructor(e,t,n,r,i,a){super(e,`write_stream_connection_backoff`,`write_stream_idle`,`health_check_timeout`,t,n,r,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_(`Write`,e,t)}J_(e){return M(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,M(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){M(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=yc(e.writeResults,e.commitTime),n=oc(e.commitTime);return this.listener.na(n,t)}ra(){let e={};e.database=mc(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map((e=>vc(this.serializer,e)))};this.q_(t)}},ql=class{},Jl=class extends ql{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new F(P.FAILED_PRECONDITION,`The client has already been terminated.`)}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,cc(t,n),r,i,a))).catch((e=>{throw e.name===`FirebaseError`?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new F(P.UNKNOWN,e.toString())}))}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,cc(t,n),r,a,o,i))).catch((e=>{throw e.name===`FirebaseError`?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new F(P.UNKNOWN,e.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}},Yl=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=`Unknown`,this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca(`Unknown`),this._a=this.asyncQueue.enqueueAfterDelay(`online_state_timeout`,1e4,(()=>(this._a=null,this.la(`Backend didn't respond within 10 seconds.`),this.ca(`Offline`),Promise.resolve()))))}ha(e){this.state===`Online`?this.ca(`Unknown`):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca(`Offline`)))}set(e){this.Pa(),this.oa=0,e===`Online`&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ni(t),this.aa=!1):A(`OnlineStateTracker`,t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}},Xl=`RemoteStore`,Zl=class{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((e=>{n.enqueueAndForget((async()=>{ou(this)&&(A(Xl,`Restarting streams for network reachability change.`),await async function(e){let t=N(e);t.Ea.add(4),await $l(t),t.Ra.set(`Unknown`),t.Ea.delete(4),await Ql(t)}(this))}))})),this.Ra=new Yl(n,r)}};async function Ql(e){if(ou(e))for(let t of e.da)await t(!0)}async function $l(e){for(let t of e.da)await t(!1)}function eu(e,t){let n=N(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),au(n)?iu(n):Tu(n).O_()&&nu(n,t))}function tu(e,t){let n=N(e),r=Tu(n);n.Ia.delete(t),r.O_()&&ru(n,t),n.Ia.size===0&&(r.O_()?r.L_():ou(n)&&n.Ra.set(`Unknown`))}function nu(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(V.min())>0){let n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Tu(e).Y_(t)}function ru(e,t){e.Va.Ue(t),Tu(e).Z_(t)}function iu(e){e.Va=new Ys({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Tu(e).start(),e.Ra.ua()}function au(e){return ou(e)&&!Tu(e).x_()&&e.Ia.size>0}function ou(e){return N(e).Ea.size===0}function su(e){e.Va=void 0}async function cu(e){e.Ra.set(`Online`)}async function lu(e){e.Ia.forEach(((t,n)=>{nu(e,t)}))}async function uu(e,t){su(e),au(e)?(e.Ra.ha(t),iu(e)):e.Ra.set(`Unknown`)}async function du(e,t,n){if(e.Ra.set(`Online`),t instanceof qs&&t.state===2&&t.cause)try{await async function(e,t){let n=t.cause;for(let r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){A(Xl,`Failed to remove targets %s: %s `,t.targetIds.join(`,`),n),await fu(e,n)}else if(t instanceof Gs?e.Va.Ze(t):t instanceof Ks?e.Va.st(t):e.Va.tt(t),!n.isEqual(V.min()))try{let t=await bl(e.localStore);n.compareTo(t)>=0&&await function(e,t){let n=e.Va.Tt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){let i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{let r=e.Ia.get(t);r&&(e.Ia.set(t,r.withResumeToken(G.EMPTY_BYTE_STRING,r.snapshotVersion)),ru(e,t),nu(e,new Nc(r.target,t,n,r.sequenceNumber)))})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){A(Xl,`Failed to raise snapshot:`,t),await fu(e,t)}}async function fu(e,t,n){if(!Ki(t))throw t;e.Ea.add(1),await $l(e),e.Ra.set(`Offline`),n||=()=>bl(e.localStore),e.asyncQueue.enqueueRetryable((async()=>{A(Xl,`Retrying IndexedDB access`),await n(),e.Ea.delete(1),await Ql(e)}))}function pu(e,t){return t().catch((n=>fu(e,n,t)))}async function mu(e){let t=N(e),n=Eu(t),r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Ji;for(;hu(t);)try{let e=await Cl(t.localStore,r);if(e===null){t.Ta.length===0&&n.L_();break}r=e.batchId,gu(t,e)}catch(e){await fu(t,e)}_u(t)&&vu(t)}function hu(e){return ou(e)&&e.Ta.length<10}function gu(e,t){e.Ta.push(t);let n=Eu(e);n.O_()&&n.X_&&n.ea(t.mutations)}function _u(e){return ou(e)&&!Eu(e).x_()&&e.Ta.length>0}function vu(e){Eu(e).start()}async function yu(e){Eu(e).ra()}async function bu(e){let t=Eu(e);for(let n of e.Ta)t.ea(n.mutations)}async function xu(e,t,n){let r=e.Ta.shift(),i=js.from(r,t,n);await pu(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await mu(e)}async function Su(e,t){t&&Eu(e).X_&&await async function(e,t){if(function(e){return Ps(e)&&e!==P.ABORTED}(t.code)){let n=e.Ta.shift();Eu(e).B_(),await pu(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await mu(e)}}(e,t),_u(e)&&vu(e)}async function Cu(e,t){let n=N(e);n.asyncQueue.verifyOperationInProgress(),A(Xl,`RemoteStore received new credentials`);let r=ou(n);n.Ea.add(3),await $l(n),r&&n.Ra.set(`Unknown`),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await Ql(n)}async function wu(e,t){let n=N(e);t?(n.Ea.delete(2),await Ql(n)):t||(n.Ea.add(2),await $l(n),n.Ra.set(`Unknown`))}function Tu(e){return e.ma||(e.ma=function(e,t,n){let r=N(e);return r.sa(),new Gl(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:cu.bind(null,e),t_:lu.bind(null,e),r_:uu.bind(null,e),H_:du.bind(null,e)}),e.da.push((async t=>{t?(e.ma.B_(),au(e)?iu(e):e.Ra.set(`Unknown`)):(await e.ma.stop(),su(e))}))),e.ma}function Eu(e){return e.fa||(e.fa=function(e,t,n){let r=N(e);return r.sa(),new Kl(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:yu.bind(null,e),r_:Su.bind(null,e),ta:bu.bind(null,e),na:xu.bind(null,e)}),e.da.push((async t=>{t?(e.fa.B_(),await mu(e)):(await e.fa.stop(),e.Ta.length>0&&(A(Xl,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))}))),e.fa}var Du=class e{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new oi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,a){let o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(P.CANCELLED,`Operation cancelled`+(e?`: `+e:``))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle===null?Promise.resolve():(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e))))))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ou(e,t){if(ni(`AsyncQueue`,`${t}: ${e}`),Ki(e))return new F(P.UNAVAILABLE,`${t}: ${e}`);throw e}var ku=class e{static emptySet(t){return new e(t.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||R.comparator(t.key,n.key):(e,t)=>R.comparator(e.key,t.key),this.keyedMap=Uo(),this.sortedSet=new U(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){let e=n.getNext().key,t=r.getNext().key;if(!e.isEqual(t))return!1}return!0}toString(){let e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?`DocumentSet ()`:`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(t,n){let r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}},Au=class{constructor(){this.ga=new U(R.comparator)}track(e){let t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):j(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}},ju=class e{constructor(e,t,n,r,i,a,o,s,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=s,this.hasCachedResults=c}static fromInitialDocuments(t,n,r,i,a){let o=[];return n.forEach((e=>{o.push({type:0,doc:e})})),new e(t,n,ku.emptySet(n),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}},Mu=class{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}},Nu=class{constructor(){this.queries=Pu(),this.onlineState=`Unknown`,this.Ca=new Set}terminate(){(function(e,t){let n=N(e),r=n.queries;n.queries=Pu(),r.forEach(((e,n)=>{for(let e of n.Sa)e.onError(t)}))})(this,new F(P.ABORTED,`Firestore shutting down`))}};function Pu(){return new zo((e=>No(e)),Mo)}async function Fu(e,t){let n=N(e),r=3,i=t.query,a=n.queries.get(i);a?!a.ba()&&t.Da()&&(r=2):(a=new Mu,r=t.Da()?0:1);try{switch(r){case 0:a.wa=await n.onListen(i,!0);break;case 1:a.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){let n=Ou(e,`Initialization of query '${Po(t.query)}' failed`);t.onError(n);return}n.queries.set(i,a),a.Sa.push(t),t.va(n.onlineState),a.wa&&t.Fa(a.wa)&&zu(n)}async function Iu(e,t){let n=N(e),r=t.query,i=3,a=n.queries.get(r);if(a){let e=a.Sa.indexOf(t);e>=0&&(a.Sa.splice(e,1),a.Sa.length===0?i=t.Da()?0:1:!a.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Lu(e,t){let n=N(e),r=!1;for(let e of t){let t=e.query,i=n.queries.get(t);if(i){for(let t of i.Sa)t.Fa(e)&&(r=!0);i.wa=e}}r&&zu(n)}function Ru(e,t,n){let r=N(e),i=r.queries.get(t);if(i)for(let e of i.Sa)e.onError(n);r.queries.delete(t)}function zu(e){e.Ca.forEach((e=>{e.next()}))}var Bu,Vu;(Vu=Bu||={}).Ma=`default`,Vu.Cache=`cache`;var Hu=class{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState=`Unknown`,this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){let t=[];for(let n of e.docChanges)n.type!==3&&t.push(n);e=new ju(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let n=t!==`Offline`;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t===`Offline`)}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=ju.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Bu.Cache}},Uu=class{constructor(e){this.key=e}},Wu=class{constructor(e){this.key=e}},Gu=class{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=J(),this.mutatedKeys=J(),this.eu=Lo(e),this.tu=new ku(this.eu)}get nu(){return this.Ya}ru(e,t){let n=t?t.iu:new Au,r=t?t.tu:this.tu,i=t?t.mutatedKeys:this.mutatedKeys,a=r,o=!1,s=this.query.limitType===`F`&&r.size===this.query.limit?r.last():null,c=this.query.limitType===`L`&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{let l=r.get(e),u=Fo(this.query,t)?t:null,d=!!l&&this.mutatedKeys.has(l.key),f=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations),p=!1;l&&u?l.data.isEqual(u.data)?d!==f&&(n.track({type:3,doc:u}),p=!0):this.su(l,u)||(n.track({type:2,doc:u}),p=!0,(s&&this.eu(u,s)>0||c&&this.eu(u,c)<0)&&(o=!0)):!l&&u?(n.track({type:0,doc:u}),p=!0):l&&!u&&(n.track({type:1,doc:l}),p=!0,(s||c)&&(o=!0)),p&&(u?(a=a.add(u),i=f?i.add(e):i.delete(e)):(a=a.delete(e),i=i.delete(e)))})),this.query.limit!==null)for(;a.size>this.query.limit;){let e=this.query.limitType===`F`?a.last():a.first();a=a.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:a,iu:n,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){let i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let a=e.iu.ya();a.sort(((e,t)=>function(e,t){let n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return j(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc))),this.ou(n),r??=!1;let o=t&&!r?this._u():[],s=this.Xa.size===0&&this.current&&!r?1:0,c=s!==this.Za;return this.Za=s,a.length!==0||c?{snapshot:new ju(this.query,e.tu,i,a,e.mutatedKeys,s===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e===`Offline`?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Au,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=J(),this.tu.forEach((e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))}));let t=[];return e.forEach((e=>{this.Xa.has(e)||t.push(new Wu(e))})),this.Xa.forEach((n=>{e.has(n)||t.push(new Uu(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=J();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ju.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}},Ku=`SyncEngine`,qu=class{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}},Ju=class{constructor(e){this.key=e,this.hu=!1}},Yu=class{constructor(e,t,n,r,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new zo((e=>No(e)),Mo),this.Iu=new Map,this.Eu=new Set,this.du=new U(R.comparator),this.Au=new Map,this.Ru=new nl,this.Vu={},this.mu=new Map,this.fu=Hc.cr(),this.onlineState=`Unknown`,this.gu=void 0}get isPrimaryClient(){return!0===this.gu}};async function Xu(e,t,n=!0){let r=vd(e),i,a=r.Tu.get(t);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await Qu(r,t,n,!0),i}async function Zu(e,t){await Qu(vd(e),t,!0,!1)}async function Qu(e,t,n,r){let i=await wl(e.localStore,Oo(t)),a=i.targetId,o=e.sharedClientState.addLocalQueryTarget(a,n),s;return r&&(s=await $u(e,t,a,o===`current`,i.resumeToken)),e.isPrimaryClient&&n&&eu(e.remoteStore,i),s}async function $u(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await El(e.localStore,t.query,!1).then((({documents:e})=>t.view.ru(e,i))));let a=r&&r.targetChanges.get(t.targetId),o=r&&r.targetMismatches.get(t.targetId)!=null,s=t.view.applyChanges(i,e.isPrimaryClient,a,o);return fd(e,t.targetId,s.au),s.snapshot}(e,t,n,r);let a=await El(e.localStore,t,!0),o=new Gu(t,a.Qs),s=o.ru(a.documents),c=Ws.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!==`Offline`,i),l=o.applyChanges(s,e.isPrimaryClient,c);fd(e,n,l.au);let u=new qu(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),l.snapshot}async function ed(e,t,n){let r=N(e),i=r.Tu.get(t),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((e=>!Mo(e,t)))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Tl(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&tu(r.remoteStore,i.targetId),ud(r,i.targetId)})).catch(Wi)):(ud(r,i.targetId),await Tl(r.localStore,i.targetId,!0))}async function td(e,t){let n=N(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),tu(n.remoteStore,r.targetId))}async function nd(e,t,n){let r=yd(e);try{let e=await function(e,t){let n=N(e),r=B.now(),i=t.reduce(((e,t)=>e.add(t.key)),J()),a,o;return n.persistence.runTransaction(`Locally write mutations`,`readwrite`,(e=>{let s=Vo(),c=J();return n.Ns.getEntries(e,i).next((e=>{s=e,s.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,s))).next((i=>{a=i;let o=[];for(let e of t){let t=xs(e,a.get(e.key).overlayedDocument);t!=null&&o.push(new ws(e.key,t,qa(t.value.mapValue),hs.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;let r=t.applyToLocalDocumentSet(a,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:Wo(a)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||=new U(I),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await hd(r,e.changes),await mu(r.remoteStore)}catch(e){let t=Ou(e,`Failed to persist write`);n.reject(t)}}async function rd(e,t){let n=N(e);try{let e=await xl(n.localStore,t);t.targetChanges.forEach(((e,t)=>{let r=n.Au.get(t);r&&(M(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?M(r.hu,14607):e.removedDocuments.size>0&&(M(r.hu,42227),r.hu=!1))})),await hd(n,e,t)}catch(e){await Wi(e)}}function id(e,t,n){let r=N(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let e=[];r.Tu.forEach(((n,r)=>{let i=r.view.va(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){let n=N(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(let e of n.Sa)e.va(t)&&(r=!0)})),r&&zu(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function ad(e,t,n){let r=N(e);r.sharedClientState.updateQueryState(t,`rejected`,n);let i=r.Au.get(t),a=i&&i.key;if(a){let e=new U(R.comparator);e=e.insert(a,Ja.newNoDocument(a,V.min()));let n=J().add(a);await rd(r,new Us(V.min(),new Map,new U(I),e,n)),r.du=r.du.remove(a),r.Au.delete(t),md(r)}else await Tl(r.localStore,t,!1).then((()=>ud(r,t,n))).catch(Wi)}async function od(e,t){let n=N(e),r=t.batch.batchId;try{let e=await yl(n.localStore,t);ld(n,r,null),cd(n,r),n.sharedClientState.updateMutationState(r,`acknowledged`),await hd(n,e)}catch(e){await Wi(e)}}async function sd(e,t,n){let r=N(e);try{let e=await function(e,t){let n=N(e);return n.persistence.runTransaction(`Reject batch`,`readwrite-primary`,(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(M(t!==null,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);ld(r,t,n),cd(r,t),r.sharedClientState.updateMutationState(t,`rejected`,n),await hd(r,e)}catch(e){await Wi(e)}}function cd(e,t){(e.mu.get(t)||[]).forEach((e=>{e.resolve()})),e.mu.delete(t)}function ld(e,t,n){let r=N(e),i=r.Vu[r.currentUser.toKey()];if(i){let e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function ud(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(let r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach((t=>{e.Ru.containsKey(t)||dd(e,t)}))}function dd(e,t){e.Eu.delete(t.path.canonicalString());let n=e.du.get(t);n!==null&&(tu(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),md(e))}function fd(e,t,n){for(let r of n)r instanceof Uu?(e.Ru.addReference(r.key,t),pd(e,r)):r instanceof Wu?(A(Ku,`Document no longer in limbo: `+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||dd(e,r.key)):j(19791,{wu:r})}function pd(e,t){let n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(A(Ku,`New document in limbo: `+n),e.Eu.add(r),md(e))}function md(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){let t=e.Eu.values().next().value;e.Eu.delete(t);let n=new R(L.fromString(t)),r=e.fu.next();e.Au.set(r,new Ju(n)),e.du=e.du.insert(n,r),eu(e.remoteStore,new Nc(Oo(wo(n.path)),r,`TargetPurposeLimboResolution`,qi.ce))}}async function hd(e,t,n){let r=N(e),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((e,s)=>{o.push(r.pu(s,t,n).then((e=>{if((e||n)&&r.isPrimaryClient){let t=e?!e.fromCache:n?.targetChanges.get(s.targetId)?.current;r.sharedClientState.updateQueryState(s.targetId,t?`current`:`not-current`)}if(e){i.push(e);let t=dl.As(s.targetId,e);a.push(t)}})))})),await Promise.all(o),r.Pu.H_(i),await async function(e,t){let n=N(e);try{await n.persistence.runTransaction(`notifyLocalViewChanges`,`readwrite`,(e=>H.forEach(t,(t=>H.forEach(t.Es,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>H.forEach(t.ds,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Ki(e))throw e;A(ml,`Failed to update sequence numbers: `+e)}for(let e of t){let t=e.targetId;if(!e.fromCache){let e=n.Ms.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(t,i)}}}(r.localStore,a))}async function gd(e,t){let n=N(e);if(!n.currentUser.isEqual(t)){A(Ku,`User change. New user:`,t.toKey());let e=await vl(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach((e=>{e.forEach((e=>{e.reject(new F(P.CANCELLED,t))}))})),e.mu.clear()}(n,`'waitForPendingWrites' promise is rejected due to a user change.`),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await hd(n,e.Ls)}}function _d(e,t){let n=N(e),r=n.Au.get(t);if(r&&r.hu)return J().add(r.key);{let e=J(),r=n.Iu.get(t);if(!r)return e;for(let t of r){let r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function vd(e){let t=N(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=rd.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=_d.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=ad.bind(null,t),t.Pu.H_=Lu.bind(null,t.eventManager),t.Pu.yu=Ru.bind(null,t.eventManager),t}function yd(e){let t=N(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=od.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=sd.bind(null,t),t}var bd=class{constructor(){this.kind=`memory`,this.synchronizeTabs=!1}async initialize(e){this.serializer=Vl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return _l(this.persistence,new pl,e.initialUser,this.serializer)}Cu(e){return new sl(ll.mi,this.serializer)}Du(e){return new kl}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};bd.provider={build:()=>new bd};var xd=class extends bd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){M(this.persistence.referenceDelegate instanceof ul,46915);let n=this.persistence.referenceDelegate.garbageCollector;return new qc(n,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes===void 0?Vc.DEFAULT:Vc.withCacheSize(this.cacheSizeBytes);return new sl((e=>ul.mi(e,t)),this.serializer)}},Sd=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>id(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=gd.bind(null,this.syncEngine),await wu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Nu}()}createDatastore(e){let t=Vl(e.databaseInfo.databaseId),n=function(e){return new zl(e)}(e.databaseInfo);return function(e,t,n,r){return new Jl(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Zl(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>id(this.syncEngine,e,0)),function(){return Ml.v()?new Ml:new Al}())}createSyncEngine(e,t){return function(e,t,n,r,i,a,o){let s=new Yu(e,t,n,r,i,a);return o&&(s.gu=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){let t=N(e);A(Xl,`RemoteStore shutting down.`),t.Ea.add(5),await $l(t),t.Aa.shutdown(),t.Ra.set(`Unknown`)}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}};Sd.provider={build:()=>new Sd};var Cd=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ni(`Uncaught Error in snapshot listener:`,e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}},wd=`FirestoreClient`,Td=class{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=k.UNAUTHENTICATED,this.clientId=gi.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{A(wd,`Received user=`,e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(A(wd,`Received new app check token=`,e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new oi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=Ou(t,`Failed to shutdown persistence`);e.reject(n)}})),e.promise}};async function Ed(e,t){e.asyncQueue.verifyOperationInProgress(),A(wd,`Initializing OfflineComponentProvider`);let n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await vl(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Dd(e,t){e.asyncQueue.verifyOperationInProgress();let n=await Od(e);A(wd,`Initializing OnlineComponentProvider`),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Cu(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Cu(t.remoteStore,n))),e._onlineComponents=t}async function Od(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){A(wd,`Using user provided OfflineComponentProvider`);try{await Ed(e,e._uninitializedComponentsProvider._offline)}catch(t){let n=t;if(!function(e){return e.name===`FirebaseError`?e.code===P.FAILED_PRECONDITION||e.code===P.UNIMPLEMENTED:!(typeof DOMException<`u`&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}(n))throw n;ri(`Error using user provided cache. Falling back to memory cache: `+n),await Ed(e,new bd)}}else A(wd,`Using default OfflineComponentProvider`),await Ed(e,new xd(void 0));return e._offlineComponents}async function kd(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(A(wd,`Using user provided OnlineComponentProvider`),await Dd(e,e._uninitializedComponentsProvider._online)):(A(wd,`Using default OnlineComponentProvider`),await Dd(e,new Sd))),e._onlineComponents}function Ad(e){return kd(e).then((e=>e.syncEngine))}async function jd(e){let t=await kd(e),n=t.eventManager;return n.onListen=Xu.bind(null,t.syncEngine),n.onUnlisten=ed.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Zu.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=td.bind(null,t.syncEngine),n}function Md(e,t,n={}){let r=new oi;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){let a=new Cd({next:s=>{a.Nu(),t.enqueueAndForget((()=>Iu(e,o)));let c=s.docs.has(n);!c&&s.fromCache?i.reject(new F(P.UNAVAILABLE,`Failed to get document because the client is offline.`)):c&&s.fromCache&&r&&r.source===`server`?i.reject(new F(P.UNAVAILABLE,`Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)`)):i.resolve(s)},error:e=>i.reject(e)}),o=new Hu(wo(n.path),a,{includeMetadataChanges:!0,qa:!0});return Fu(e,o)}(await jd(e),e.asyncQueue,t,n,r))),r.promise}function Nd(e,t,n={}){let r=new oi;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){let a=new Cd({next:n=>{a.Nu(),t.enqueueAndForget((()=>Iu(e,o))),n.fromCache&&r.source===`server`?i.reject(new F(P.UNAVAILABLE,`Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)`)):i.resolve(n)},error:e=>i.reject(e)}),o=new Hu(n,a,{includeMetadataChanges:!0,qa:!0});return Fu(e,o)}(await jd(e),e.asyncQueue,t,n,r))),r.promise}function Pd(e){let t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}var Fd=new Map,Id=`firestore.googleapis.com`,Ld=!0,Rd=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new F(P.INVALID_ARGUMENT,`Can't provide ssl option if host option is not set`);this.host=Id,this.ssl=Ld}else this.host=e.host,this.ssl=e.ssl??Ld;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Bc;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Wc)throw new F(P.INVALID_ARGUMENT,`cacheSizeBytes must be at least 1048576`);this.cacheSizeBytes=e.cacheSizeBytes}Di(`experimentalForceLongPolling`,e.experimentalForceLongPolling,`experimentalAutoDetectLongPolling`,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Pd(e.experimentalLongPollingOptions??{}),function(e){if(e.timeoutSeconds!==void 0){if(isNaN(e.timeoutSeconds))throw new F(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new F(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new F(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},zd=class{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type=`firestore-lite`,this._persistenceKey=`(lite)`,this._settings=new Rd({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask=`notTerminated`}get app(){if(!this._app)throw new F(P.FAILED_PRECONDITION,`Firestore was not initialized using the Firebase SDK. 'app' is not available`);return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==`notTerminated`}_setSettings(e){if(this._settingsFrozen)throw new F(P.FAILED_PRECONDITION,`Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.`);this._settings=new Rd(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(e){if(!e)return new ci;switch(e.type){case`firstParty`:return new fi(e.sessionIndex||`0`,e.iamToken||null,e.authTokenFactory||null);case`provider`:return e.client;default:throw new F(P.INVALID_ARGUMENT,`makeAuthCredentialsProvider failed due to invalid credential type`)}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask===`notTerminated`&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask===`notTerminated`?await this._terminate():this._terminateTask=`notTerminated`}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let t=Fd.get(e);t&&(A(`ComponentProvider`,`Removing Datastore`),Fd.delete(e),t.terminate())}(this),Promise.resolve()}};function Bd(e,t,n,r={}){e=Mi(e,zd);let i=At(t),a=e._getSettings(),o={...a,emulatorOptions:e._getEmulatorOptions()},s=`${t}:${n}`;i&&(jt(`https://${s}`),Lt(`Firestore`,!0)),a.host!==Id&&a.host!==s&&ri(`Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.`);let c={...a,host:s,ssl:i,emulatorOptions:r};if(!C(c,o)&&(e._setSettings(c),r.mockUserToken)){let t,n;if(typeof r.mockUserToken==`string`)t=r.mockUserToken,n=k.MOCK_USER;else{t=Mt(r.mockUserToken,e._app?.options.projectId);let i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new F(P.INVALID_ARGUMENT,`mockUserToken must contain 'sub' or 'user_id' field!`);n=new k(i)}e._authCredentials=new li(new si(t,n))}}var Vd=class e{constructor(e,t,n){this.converter=t,this._query=n,this.type=`query`,this.firestore=e}withConverter(t){return new e(this.firestore,t,this._query)}},$=class e{constructor(e,t,n){this.converter=t,this._key=n,this.type=`document`,this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hd(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new e(this.firestore,t,this._key)}toJSON(){return{type:e._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(Ni(n,e._jsonSchema))return new e(t,r||null,new R(L.fromString(n.referencePath)))}};$._jsonSchemaVersion=`firestore/documentReference/1.0`,$._jsonSchema={type:z(`string`,$._jsonSchemaVersion),referencePath:z(`string`)};var Hd=class e extends Vd{constructor(e,t,n){super(e,t,wo(n)),this._path=n,this.type=`collection`}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new $(this.firestore,null,new R(e))}withConverter(t){return new e(this.firestore,t,this._path)}};function Ud(e,t,...n){if(e=w(e),Ei(`collection`,`path`,t),e instanceof zd){let r=L.fromString(t,...n);return ki(r),new Hd(e,null,r)}{if(!(e instanceof $||e instanceof Hd))throw new F(P.INVALID_ARGUMENT,`Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore`);let r=e._path.child(L.fromString(t,...n));return ki(r),new Hd(e.firestore,null,r)}}function Wd(e,t,...n){if(e=w(e),arguments.length===1&&(t=gi.newId()),Ei(`doc`,`path`,t),e instanceof zd){let r=L.fromString(t,...n);return Oi(r),new $(e,null,new R(r))}{if(!(e instanceof $||e instanceof Hd))throw new F(P.INVALID_ARGUMENT,`Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore`);let r=e._path.child(L.fromString(t,...n));return Oi(r),new $(e.firestore,e instanceof Hd?e.converter:null,new R(r))}}var Gd=`AsyncQueue`,Kd=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Hl(this,`async_queue_retry`),this._c=()=>{let e=Bl();e&&A(Gd,`Visibility state changed to `+e.visibilityState),this.M_.w_()},this.ac=e;let t=Bl();t&&typeof t.addEventListener==`function`&&t.addEventListener(`visibilitychange`,this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Bl();t&&typeof t.removeEventListener==`function`&&t.removeEventListener(`visibilitychange`,this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));let t=new oi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ki(e))throw e;A(Gd,`Operation failed with retryable error: `+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){let t=this.ac.then((()=>(this.rc=!0,e().catch((e=>{throw this.nc=e,this.rc=!1,ni(`INTERNAL UNHANDLED ERROR: `,qd(e)),e})).then((e=>(this.rc=!1,e))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=Du.createAndSchedule(this,e,t,n,(e=>this.hc(e)));return this.tc.push(r),r}uc(){this.nc&&j(47125,{Pc:qd(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(let t of this.tc)if(t.skipDelay(),e!==`all`&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function qd(e){let t=e.message||``;return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}var Jd=class extends zd{constructor(e,t,n,r){super(e,t,n,r),this.type=`firestore`,this._queue=new Kd,this._persistenceKey=r?.name||`[DEFAULT]`}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Kd(e),this._firestoreClient=void 0,await e}}};function Yd(e,t){let n=typeof e==`object`?e:vr(),r=typeof e==`string`?e:t||xa,i=fr(n,`firestore`).getImmediate({identifier:r});if(!i._initialized){let e=Dt(`firestore`);e&&Bd(i,...e)}return i}function Xd(e){if(e._terminated)throw new F(P.FAILED_PRECONDITION,`The client has already been terminated.`);return e._firestoreClient||Zd(e),e._firestoreClient}function Zd(e){let t=e._freezeSettings(),n=function(e,t,n,r){return new ba(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Pd(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,e._app?.options.appId||``,e._persistenceKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new Td(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(e){let t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}(e._componentsProvider))}var Qd=class e{constructor(e){this._byteString=e}static fromBase64String(t){try{return new e(G.fromBase64String(t))}catch(e){throw new F(P.INVALID_ARGUMENT,`Failed to construct data from Base64 string: `+e)}}static fromUint8Array(t){return new e(G.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return`Bytes(base64: `+this.toBase64()+`)`}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:e._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Ni(t,e._jsonSchema))return e.fromBase64String(t.bytes)}};Qd._jsonSchemaVersion=`firestore/bytes/1.0`,Qd._jsonSchema={type:z(`string`,Qd._jsonSchemaVersion),bytes:z(`string`)};var $d=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(P.INVALID_ARGUMENT,`Invalid field name at argument $(i + 1). Field names must not be empty.`);this._internalPath=new Ti(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}},ef=class{constructor(e){this._methodName=e}},tf=class e{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(P.INVALID_ARGUMENT,`Latitude must be a number between -90 and 90, but was: `+e);if(!isFinite(t)||t<-180||t>180)throw new F(P.INVALID_ARGUMENT,`Longitude must be a number between -180 and 180, but was: `+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return I(this._lat,e._lat)||I(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:e._jsonSchemaVersion}}static fromJSON(t){if(Ni(t,e._jsonSchema))return new e(t.latitude,t.longitude)}};tf._jsonSchemaVersion=`firestore/geoPoint/1.0`,tf._jsonSchema={type:z(`string`,tf._jsonSchemaVersion),latitude:z(`number`),longitude:z(`number`)};var nf=class e{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:e._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Ni(t,e._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e==`number`)))return new e(t.vectorValues);throw new F(P.INVALID_ARGUMENT,`Expected 'vectorValues' field to be a number array`)}}};nf._jsonSchemaVersion=`firestore/vectorValue/1.0`,nf._jsonSchema={type:z(`string`,nf._jsonSchemaVersion),vectorValues:z(`object`)};var rf=/^__.*__$/,af=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask===null?new Cs(e,this.data,t,this.fieldTransforms):new ws(e,this.data,this.fieldMask,t,this.fieldTransforms)}},of=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ws(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function sf(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j(40011,{Ac:e})}}var cf=class e{constructor(e,t,n,r,i,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new e({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){let t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Cf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc(`Document fields must not be empty`);if(sf(this.Ac)&&rf.test(e))throw this.Sc(`Document fields cannot begin and end with "__"`)}},lf=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Vl(e)}Cc(e,t,n,r=!1){return new cf({Ac:e,methodName:t,Dc:n,path:Ti.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function uf(e){let t=e._freezeSettings(),n=Vl(e._databaseId);return new lf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function df(e,t,n,r,i,a={}){let o=e.Cc(a.merge||a.mergeFields?2:0,t,n,i);yf(`Data must be an object, but it was:`,o,r);let s=_f(r,o),c,l;if(a.merge)c=new ca(o.fieldMask),l=o.fieldTransforms;else if(a.mergeFields){let e=[];for(let r of a.mergeFields){let i=bf(t,r,n);if(!o.contains(i))throw new F(P.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);wf(e,i)||e.push(i)}c=new ca(e),l=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=o.fieldTransforms;return new af(new Ka(s),c,l)}var ff=class e extends ef{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(t){return t instanceof e}};function pf(e,t,n,r){let i=e.Cc(1,t,n);yf(`Data must be an object, but it was:`,i,r);let a=[],o=Ka.empty();return ra(r,((e,r)=>{let s=Sf(t,e,n);r=w(r);let c=i.yc(s);if(r instanceof ff)a.push(s);else{let e=gf(r,c);e!=null&&(a.push(s),o.set(s,e))}})),new of(o,new ca(a),i.fieldTransforms)}function mf(e,t,n,r,i,a){let o=e.Cc(1,t,n),s=[bf(t,r,n)],c=[i];if(a.length%2!=0)throw new F(P.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<a.length;e+=2)s.push(bf(t,a[e])),c.push(a[e+1]);let l=[],u=Ka.empty();for(let e=s.length-1;e>=0;--e)if(!wf(l,s[e])){let t=s[e],n=c[e];n=w(n);let r=o.yc(t);if(n instanceof ff)l.push(t);else{let e=gf(n,r);e!=null&&(l.push(t),u.set(t,e))}}return new of(u,new ca(l),o.fieldTransforms)}function hf(e,t,n,r=!1){return gf(n,e.Cc(r?4:3,t))}function gf(e,t){if(vf(e=w(e)))return yf(`Unsupported field value:`,t,e),_f(e,t);if(e instanceof ef)return function(e,t){if(!sf(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);let n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc(`Nested arrays are not supported`);return function(e,t){let n=[],r=0;for(let i of e){let e=gf(i,t.wc(r));e??={nullValue:`NULL_VALUE`},n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if((e=w(e))===null)return{nullValue:`NULL_VALUE`};if(typeof e==`number`)return es(t.serializer,e);if(typeof e==`boolean`)return{booleanValue:e};if(typeof e==`string`)return{stringValue:e};if(e instanceof Date){let n=B.fromDate(e);return{timestampValue:rc(t.serializer,n)}}if(e instanceof B){let n=new B(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:rc(t.serializer,n)}}if(e instanceof tf)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Qd)return{bytesValue:ic(t.serializer,e._byteString)};if(e instanceof $){let n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:sc(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof nf)return function(e,t){return{mapValue:{fields:{[Ca]:{stringValue:Ea},[Da]:{arrayValue:{values:e.toArray().map((e=>{if(typeof e!=`number`)throw t.Sc(`VectorValues must only contain numeric values.`);return Qo(t.serializer,e)}))}}}}}}(e,t);throw t.Sc(`Unsupported field value: ${ji(e)}`)}(e,t)}function _f(e,t){let n={};return ia(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ra(e,((e,r)=>{let i=gf(r,t.mc(e));i!=null&&(n[e]=i)})),{mapValue:{fields:n}}}function vf(e){return!(typeof e!=`object`||!e||e instanceof Array||e instanceof Date||e instanceof B||e instanceof tf||e instanceof Qd||e instanceof $||e instanceof ef||e instanceof nf)}function yf(e,t,n){if(!vf(n)||!Ai(n)){let r=ji(n);throw r===`an object`?t.Sc(e+` a custom object`):t.Sc(e+` `+r)}}function bf(e,t,n){if((t=w(t))instanceof $d)return t._internalPath;if(typeof t==`string`)return Sf(e,t);throw Cf(`Field path arguments must be of type string or `,e,!1,void 0,n)}var xf=RegExp(`[~\\*/\\[\\]]`);function Sf(e,t,n){if(t.search(xf)>=0)throw Cf(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new $d(...t.split(`.`))._internalPath}catch{throw Cf(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Cf(e,t,n,r,i){let a=r&&!r.isEmpty(),o=i!==void 0,s=`Function ${t}() called with invalid data`;n&&(s+=" (via `toFirestore()`)"),s+=`. `;let c=``;return(a||o)&&(c+=` (found`,a&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=`)`),new F(P.INVALID_ARGUMENT,s+e+c)}function wf(e,t){return e.some((e=>e.isEqual(t)))}var Tf=class{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new $(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Ef(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Df(`DocumentSnapshot.get`,e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Ef=class extends Tf{data(){return super.data()}};function Df(e,t){return typeof t==`string`?Sf(e,t):t instanceof $d?t._internalPath:t._delegate._internalPath}function Of(e){if(e.limitType===`L`&&e.explicitOrderBy.length===0)throw new F(P.UNIMPLEMENTED,`limitToLast() queries require specifying at least one orderBy() clause`)}var kf=class{},Af=class extends kf{};function jf(e,t,...n){let r=[];t instanceof kf&&r.push(t),r=r.concat(n),function(e){let t=e.filter((e=>e instanceof Pf)).length,n=e.filter((e=>e instanceof Mf)).length;if(t>1||t>0&&n>0)throw new F(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let t of r)e=t._apply(e);return e}var Mf=class e extends Af{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type=`where`}static _create(t,n,r){return new e(t,n,r)}_apply(e){let t=this._parse(e);return Lf(e._query,t),new Vd(e.firestore,e.converter,Ao(e._query,t))}_parse(e){let t=uf(e.firestore);return function(e,t,n,r,i,a,o){let s;if(i.isKeyField()){if(a===`array-contains`||a===`array-contains-any`)throw new F(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${a}' queries on documentId().`);if(a===`in`||a===`not-in`){If(o,a);let t=[];for(let n of o)t.push(Ff(r,e,n));s={arrayValue:{values:t}}}else s=Ff(r,e,o)}else a!==`in`&&a!==`not-in`&&a!==`array-contains-any`||If(o,a),s=hf(n,t,o,a===`in`||a===`not-in`);return q.create(i,a,s)}(e._query,`where`,t,e.firestore._databaseId,this._field,this._op,this._value)}};function Nf(e,t,n){let r=t,i=Df(`where`,e);return Mf._create(i,r,n)}var Pf=class e extends kf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(t,n){return new e(t,n)}_parse(e){let t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return t.length===1?t[0]:to.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(e,t){let n=e,r=t.getFlattenedFilters();for(let e of r)Lf(n,e),n=Ao(n,e)}(e._query,t),new Vd(e.firestore,e.converter,Ao(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type===`and`?`and`:`or`}};function Ff(e,t,n){if(typeof(n=w(n))==`string`){if(n===``)throw new F(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.`);if(!Eo(t)&&n.indexOf(`/`)!==-1)throw new F(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=t.path.child(L.fromString(n));if(!R.isDocumentKey(r))throw new F(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return La(e,new R(r))}if(n instanceof $)return La(e,n._key);throw new F(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ji(n)}.`)}function If(e,t){if(!Array.isArray(e)||e.length===0)throw new F(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Lf(e,t){let n=function(e,t){for(let n of e)for(let e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case`!=`:return[`!=`,`not-in`];case`array-contains-any`:case`in`:return[`not-in`];case`not-in`:return[`array-contains-any`,`in`,`not-in`,`!=`];default:return[]}}(t.op));if(n!==null)throw n===t.op?new F(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new F(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}var Rf=class{convertValue(e,t=`none`){switch(Oa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return K(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(fa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw j(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t=`none`){let n={};return ra(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){let t=e.fields?.[Da].arrayValue?.values?.map((e=>K(e.doubleValue)));return new nf(t)}convertGeoPoint(e){return new tf(K(e.latitude),K(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case`previous`:let n=va(e);return n==null?null:this.convertValue(n,t);case`estimate`:return this.convertTimestamp(ya(e));default:return null}}convertTimestamp(e){let t=da(e);return new B(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=L.fromString(e);M(Mc(n),9688,{name:e});let r=new Sa(n.get(1),n.get(3)),i=new R(n.popFirst(5));return r.isEqual(t)||ni(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}};function zf(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}var Bf=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Vf=class e extends Tf{constructor(e,t,n,r,i,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Hf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(Df(`DocumentSnapshot.get`,e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new F(P.FAILED_PRECONDITION,`DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().`);let t=this._document,n={};return n.type=e._jsonSchemaVersion,n.bundle=``,n.bundleSource=`DocumentSnapshot`,n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,`previous`),n.bundle=(this._firestore,this.ref.path,`NOT SUPPORTED`),n)}};Vf._jsonSchemaVersion=`firestore/documentSnapshot/1.0`,Vf._jsonSchema={type:z(`string`,Vf._jsonSchemaVersion),bundleSource:z(`string`,`DocumentSnapshot`),bundleName:z(`string`),bundle:z(`string`)};var Hf=class extends Vf{data(e={}){return super.data(e)}},Uf=class e{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Bf(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){let e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Hf(this._firestore,this._userDataWriter,n.key,n,new Bf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(P.INVALID_ARGUMENT,`To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().`);return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{let r=new Hf(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Bf(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:`added`,doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||e.type!==3)).map((t=>{let r=new Hf(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Bf(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return t.type!==0&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),t.type!==1&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:Wf(t.type),doc:r,oldIndex:i,newIndex:a}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new F(P.FAILED_PRECONDITION,`QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().`);let t={};t.type=e._jsonSchemaVersion,t.bundleSource=`QuerySnapshot`,t.bundleName=gi.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let n=[],r=[],i=[];return this.docs.forEach((e=>{e._document!==null&&(n.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,`previous`)),i.push(e.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,`NOT SUPPORTED`),t}};function Wf(e){switch(e){case 0:return`added`;case 2:case 3:return`modified`;case 1:return`removed`;default:return j(61501,{type:e})}}function Gf(e){e=Mi(e,$);let t=Mi(e.firestore,Jd);return Md(Xd(t),e._key).then((n=>Qf(t,e,n)))}Uf._jsonSchemaVersion=`firestore/querySnapshot/1.0`,Uf._jsonSchema={type:z(`string`,Uf._jsonSchemaVersion),bundleSource:z(`string`,`QuerySnapshot`),bundleName:z(`string`),bundle:z(`string`)};var Kf=class extends Rf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qd(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new $(this.firestore,null,t)}};function qf(e){e=Mi(e,Vd);let t=Mi(e.firestore,Jd),n=Xd(t),r=new Kf(t);return Of(e._query),Nd(n,e._query).then((n=>new Uf(t,r,e,n)))}function Jf(e,t,n,...r){e=Mi(e,$);let i=Mi(e.firestore,Jd),a=uf(i),o;return o=typeof(t=w(t))==`string`||t instanceof $d?mf(a,`updateDoc`,e._key,t,n,r):pf(a,`updateDoc`,e._key,t),Zf(i,[o.toMutation(e._key,hs.exists(!0))])}function Yf(e){return Zf(Mi(e.firestore,Jd),[new Os(e._key,hs.none())])}function Xf(e,t){let n=Mi(e.firestore,Jd),r=Wd(e),i=zf(e.converter,t);return Zf(n,[df(uf(e.firestore),`addDoc`,r._key,i,e.converter!==null,{}).toMutation(r._key,hs.exists(!1))]).then((()=>r))}function Zf(e,t){return function(e,t){let n=new oi;return e.asyncQueue.enqueueAndForget((async()=>nd(await Ad(e),t,n))),n.promise}(Xd(e),t)}function Qf(e,t,n){let r=n.docs.get(t._key);return new Vf(e,new Kf(e),t._key,r,new Bf(n.hasPendingWrites,n.fromCache),t.converter)}(function(e,t=!0){(function(e){$r=e})(gr),dr(new Jt(`firestore`,((e,{instanceIdentifier:n,options:r})=>{let i=e.getProvider(`app`).getImmediate(),a=new Jd(new ui(e.getProvider(`auth-internal`)),new mi(i,e.getProvider(`app-check-internal`)),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,[`projectId`]))throw new F(P.INVALID_ARGUMENT,`"projectId" not provided in firebase.initializeApp.`);return new Sa(e.options.projectId,t)}(i,n),i);return r={useFetchStreams:t,...r},a._setSettings(r),a}),`PUBLIC`).setMultipleInstances(!0)),yr(Zr,Qr,e),yr(Zr,Qr,`esm2020`)})(),yr(`firebase`,`12.7.0`,`app`);var $f=Yd(_r({apiKey:`AIzaSyA5Gb_w1TvTKMAuVX3o8vc-FrtjdJfDLGo`,authDomain:`pandamagic.firebaseapp.com`,projectId:`pandamagic`,storageBucket:`pandamagic.firebasestorage.app`,messagingSenderId:`288585939317`,appId:`1:288585939317:web:feba9791589325df19fb3c`})),ep=new class{constructor(){this.collectionName=`books`,this.initialized=!0}initialize(){return{success:!0}}_getBooksCollection(){return Ud($f,this.collectionName)}async addBook(e){try{if(!e||typeof e!=`object`)return{success:!1,error:``};if(!e.isbn||typeof e.isbn!=`string`)return{success:!1,error:`ISBN`};if(!e.title||typeof e.title!=`string`)return{success:!1,error:``};let t=await this.bookExists(e.isbn);if(!t.success)return t;if(t.data)return{success:!1,error:``};let{id:n,...r}=e,i=new Date().toISOString(),a={...r,addedDate:i,updatedDate:i};return{success:!0,data:{id:(await Xf(this._getBooksCollection(),a)).id,...a}}}catch(e){return console.error(`:`,e),{success:!1,error:e.message||``}}}async getAllBooks(){try{let e=await qf(this._getBooksCollection()),t=[];return e.forEach(e=>{t.push({id:e.id,...e.data()})}),{success:!0,data:t}}catch(e){return console.error(`:`,e),{success:!1,error:e.message||``}}}async updateBook(e,t){try{if(!e||typeof e!=`string`)return{success:!1,error:`ID`};if(!t||typeof t!=`object`)return{success:!1,error:``};let n=Wd($f,this.collectionName,e);if(!(await Gf(n)).exists())return{success:!1,error:``};let{id:r,addedDate:i,...a}=t;await Jf(n,{...a,updatedDate:new Date().toISOString()});let o=await Gf(n);return{success:!0,data:{id:o.id,...o.data()}}}catch(e){return console.error(`:`,e),{success:!1,error:e.message||``}}}async deleteBook(e){try{if(!e||typeof e!=`string`)return{success:!1,error:`ID`};let t=Wd($f,this.collectionName,e);return(await Gf(t)).exists()?(await Yf(t),{success:!0}):{success:!1,error:``}}catch(e){return console.error(`:`,e),{success:!1,error:e.message||``}}}async bookExists(e){try{return!e||typeof e!=`string`?{success:!1,error:`ISBN`}:{success:!0,data:!(await qf(jf(this._getBooksCollection(),Nf(`isbn`,`==`,e)))).empty}}catch(e){return console.error(`:`,e),{success:!1,error:e.message||``}}}};const tp=ne(`library`,{state:()=>({books:[],loading:!1,error:null}),getters:{bookCount:e=>e.books.length,filteredBooks:e=>(t={})=>{let n=[...e.books];if(t.bookType&&(n=n.filter(e=>e.bookType===t.bookType)),t.readingStatus&&(n=n.filter(e=>e.readingStatus===t.readingStatus)),t.collectionStatus&&(n=n.filter(e=>e.collectionStatus===t.collectionStatus)),t.searchQuery){let e=t.searchQuery.toLowerCase();n=n.filter(t=>t.title.toLowerCase().includes(e)||t.authors.some(t=>t.toLowerCase().includes(e))||t.isbn.includes(e))}return n},getBookById:e=>t=>e.books.find(e=>e.id===t),allBookTypes:e=>{let t=e.books.map(e=>e.bookType).filter(Boolean);return[...new Set(t)]}},actions:{async loadBooks(){this.loading=!0,this.error=null;try{let e=await ep.getAllBooks();e.success?this.books=e.data||[]:(this.error=e.error||``,console.error(`:`,e.error))}catch(e){this.error=e.message||``,console.error(`:`,e)}finally{this.loading=!1}},async addBook(e){this.loading=!0,this.error=null;try{let t=await ep.addBook(e);return t.success?(this.books.push(t.data),{success:!0,data:t.data}):(this.error=t.error||``,{success:!1,error:t.error})}catch(e){return this.error=e.message||``,{success:!1,error:this.error}}finally{this.loading=!1}},async updateBook(e,t){this.loading=!0,this.error=null;try{let n=await ep.updateBook(e,t);if(n.success){let t=this.books.findIndex(t=>t.id===e);return t!==-1&&(this.books[t]=n.data),{success:!0,data:n.data}}else return this.error=n.error||``,{success:!1,error:n.error}}catch(e){return this.error=e.message||``,{success:!1,error:this.error}}finally{this.loading=!1}},async deleteBook(e){this.loading=!0,this.error=null;try{let t=await ep.deleteBook(e);if(t.success){let t=this.books.findIndex(t=>t.id===e);return t!==-1&&this.books.splice(t,1),{success:!0}}else return this.error=t.error||``,{success:!1,error:t.error}}catch(e){return this.error=e.message||``,{success:!1,error:this.error}}finally{this.loading=!1}},clearError(){this.error=null}}});var np=(e,t)=>{let n=e.__vccOpts||e;for(let[e,r]of t)n[e]=r;return n};export{dt as a,et as c,Fe as d,Pe as f,ft as i,qe as l,Oe as m,tp as n,lt as o,Ne as p,ep as r,tt as s,np as t,y as u};